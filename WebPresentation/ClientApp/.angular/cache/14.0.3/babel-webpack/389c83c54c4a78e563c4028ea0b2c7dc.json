{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport { isSome as r } from \"../core/maybe.js\";\nimport { eachAlwaysValues as s } from \"../core/promiseUtils.js\";\nimport \"../core/Logger.js\";\nimport \"../core/accessorSupport/ensureType.js\";\nimport \"../core/arrayUtils.js\";\nimport \"../core/Error.js\";\nimport \"../core/has.js\";\nimport { subclass as i } from \"../core/accessorSupport/decorators/subclass.js\";\n\nconst a = a => {\n  let p = class extends a {\n    fetchPopupFeatures(e, r) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        yield _this.when();\n\n        const {\n          location: i,\n          queryArea: a,\n          layerViewsAndGraphics: p,\n          clientOnlyGraphics: t\n        } = yield _this._prepareFetchPopupFeatures(e, r),\n              o = Promise.resolve(t),\n              c = _this._queryLayerPopupFeatures(a, p, r),\n              n = c.map(e => e.promise);\n\n        return {\n          location: i,\n          clientOnlyGraphics: t,\n          allGraphicsPromise: s([o, ...n]).then(e => Array.from(new Set(e.flat()))),\n          promisesPerLayerView: c\n        };\n      })();\n    }\n\n    _queryLayerPopupFeatures(e, s, i) {\n      return s.map(({\n        layerView: s,\n        graphics: a\n      }) => {\n        const p = {\n          clientGraphics: a,\n          event: r(i) ? i.event : void 0,\n          signal: r(i) ? i.signal : void 0,\n          defaultPopupTemplateEnabled: !!r(i) && !!i.defaultPopupTemplateEnabled\n        },\n              t = s.fetchPopupFeatures(e, p);\n        return {\n          layerView: s,\n          promise: t\n        };\n      });\n    }\n\n    _isValidPopupGraphic(e, s) {\n      return e && !!e.getEffectivePopupTemplate(r(s) && s.defaultPopupTemplateEnabled);\n    }\n\n    _prepareFetchPopupFeatures(e, r) {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        const {\n          clientGraphics: s,\n          queryArea: i,\n          location: a\n        } = yield _this2._popupHitTestGraphics(e, r),\n              p = _this2._getFetchPopupLayerViews(),\n              {\n          layerViewsAndGraphics: t,\n          clientOnlyGraphics: o\n        } = _this2._graphicsPerFetchPopupLayerView(s, p);\n\n        return {\n          clientOnlyGraphics: o,\n          layerViewsAndGraphics: t,\n          queryArea: i,\n          location: a\n        };\n      })();\n    }\n\n    _popupHitTestGraphics(e, r) {\n      var _this3 = this;\n\n      return _asyncToGenerator(function* () {\n        const s = yield _this3.popupHitTest(e),\n              i = s.results,\n              a = s.mapPoint,\n              p = i.filter(e => \"graphic\" === e.type && _this3._isValidPopupGraphic(e.graphic, r)),\n              t = p.length ? p[0].mapPoint : null;\n        return {\n          clientGraphics: p.map(e => e.graphic),\n          queryArea: a,\n          location: a || t\n        };\n      })();\n    }\n\n    _getFetchPopupLayerViews() {\n      const e = [];\n      return this.allLayerViews.forEach(r => {\n        this._isValidPopupLayerView(r) && e.push(r);\n      }), r(this.graphicsView) && this._isValidPopupLayerView(this.graphicsView) && e.push(this.graphicsView), e.reverse();\n    }\n\n    _isValidPopupLayerView(e) {\n      return r(e) && (!(\"layer\" in e) || !e.suspended) && \"fetchPopupFeatures\" in e;\n    }\n\n    _graphicsPerFetchPopupLayerView(e, r) {\n      const s = [],\n            i = new Map(),\n            a = r.map(e => {\n        const r = [];\n        return \"layer\" in e ? i.set(e.layer, r) : i.set(e.graphics, r), {\n          layerView: e,\n          graphics: r\n        };\n      });\n\n      for (const p of e) {\n        const e = i.get(p.layer) || i.get(p.sourceLayer) || null;\n        e ? e.push(p) : s.push(p);\n      }\n\n      return {\n        layerViewsAndGraphics: a,\n        clientOnlyGraphics: s\n      };\n    }\n\n  };\n  return p = e([i(\"esri.views.PopupView\")], p), p;\n};\n\nexport { a as PopupView };","map":{"version":3,"names":["_","e","isSome","r","eachAlwaysValues","s","subclass","i","a","p","fetchPopupFeatures","when","location","queryArea","layerViewsAndGraphics","clientOnlyGraphics","t","_prepareFetchPopupFeatures","o","Promise","resolve","c","_queryLayerPopupFeatures","n","map","promise","allGraphicsPromise","then","Array","from","Set","flat","promisesPerLayerView","layerView","graphics","clientGraphics","event","signal","defaultPopupTemplateEnabled","_isValidPopupGraphic","getEffectivePopupTemplate","_popupHitTestGraphics","_getFetchPopupLayerViews","_graphicsPerFetchPopupLayerView","popupHitTest","results","mapPoint","filter","type","graphic","length","allLayerViews","forEach","_isValidPopupLayerView","push","graphicsView","reverse","suspended","Map","set","layer","get","sourceLayer","PopupView"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/views/PopupView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import{isSome as r}from\"../core/maybe.js\";import{eachAlwaysValues as s}from\"../core/promiseUtils.js\";import\"../core/Logger.js\";import\"../core/accessorSupport/ensureType.js\";import\"../core/arrayUtils.js\";import\"../core/Error.js\";import\"../core/has.js\";import{subclass as i}from\"../core/accessorSupport/decorators/subclass.js\";const a=a=>{let p=class extends a{async fetchPopupFeatures(e,r){await this.when();const{location:i,queryArea:a,layerViewsAndGraphics:p,clientOnlyGraphics:t}=await this._prepareFetchPopupFeatures(e,r),o=Promise.resolve(t),c=this._queryLayerPopupFeatures(a,p,r),n=c.map((e=>e.promise));return{location:i,clientOnlyGraphics:t,allGraphicsPromise:s([o,...n]).then((e=>Array.from(new Set(e.flat())))),promisesPerLayerView:c}}_queryLayerPopupFeatures(e,s,i){return s.map((({layerView:s,graphics:a})=>{const p={clientGraphics:a,event:r(i)?i.event:void 0,signal:r(i)?i.signal:void 0,defaultPopupTemplateEnabled:!!r(i)&&!!i.defaultPopupTemplateEnabled},t=s.fetchPopupFeatures(e,p);return{layerView:s,promise:t}}))}_isValidPopupGraphic(e,s){return e&&!!e.getEffectivePopupTemplate(r(s)&&s.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(e,r){const{clientGraphics:s,queryArea:i,location:a}=await this._popupHitTestGraphics(e,r),p=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:t,clientOnlyGraphics:o}=this._graphicsPerFetchPopupLayerView(s,p);return{clientOnlyGraphics:o,layerViewsAndGraphics:t,queryArea:i,location:a}}async _popupHitTestGraphics(e,r){const s=await this.popupHitTest(e),i=s.results,a=s.mapPoint,p=i.filter((e=>\"graphic\"===e.type&&this._isValidPopupGraphic(e.graphic,r))),t=p.length?p[0].mapPoint:null;return{clientGraphics:p.map((e=>e.graphic)),queryArea:a,location:a||t}}_getFetchPopupLayerViews(){const e=[];return this.allLayerViews.forEach((r=>{this._isValidPopupLayerView(r)&&e.push(r)})),r(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&e.push(this.graphicsView),e.reverse()}_isValidPopupLayerView(e){return r(e)&&(!(\"layer\"in e)||!e.suspended)&&\"fetchPopupFeatures\"in e}_graphicsPerFetchPopupLayerView(e,r){const s=[],i=new Map,a=r.map((e=>{const r=[];return\"layer\"in e?i.set(e.layer,r):i.set(e.graphics,r),{layerView:e,graphics:r}}));for(const p of e){const e=i.get(p.layer)||i.get(p.sourceLayer)||null;e?e.push(p):s.push(p)}return{layerViewsAndGraphics:a,clientOnlyGraphics:s}}};return p=e([i(\"esri.views.PopupView\")],p),p};export{a as PopupView};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}