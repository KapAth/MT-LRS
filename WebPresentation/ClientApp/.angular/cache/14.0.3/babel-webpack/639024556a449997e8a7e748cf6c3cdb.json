{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../chunks/tslib.es6.js\";\nimport t from \"../config.js\";\nimport r from \"../Graphic.js\";\nimport o from \"../PopupTemplate.js\";\nimport s from \"../request.js\";\nimport i from \"../core/Collection.js\";\nimport a from \"../core/CollectionFlattener.js\";\nimport { JSONMap as n } from \"../core/jsonMap.js\";\nimport { clone as l } from \"../core/lang.js\";\nimport { isSome as p, isNone as m } from \"../core/maybe.js\";\nimport { MultiOriginJSONMixin as u } from \"../core/MultiOriginJSONSupport.js\";\nimport { throwIfAbortError as c } from \"../core/promiseUtils.js\";\nimport { on as f, watch as y, sync as d } from \"../core/reactiveUtils.js\";\nimport { addQueryParameters as h, addProxy as g, Url as b } from \"../core/urlUtils.js\";\nimport { property as v } from \"../core/accessorSupport/decorators/property.js\";\nimport { Integer as w } from \"../core/accessorSupport/ensureType.js\";\nimport { reader as x } from \"../core/accessorSupport/decorators/reader.js\";\nimport { subclass as j } from \"../core/accessorSupport/decorators/subclass.js\";\nimport { writer as I } from \"../core/accessorSupport/decorators/writer.js\";\nimport { willPropertyWrite as S } from \"../core/accessorSupport/write.js\";\nimport F from \"../geometry/Extent.js\";\nimport E from \"../geometry/SpatialReference.js\";\nimport { getScale as R } from \"../geometry/support/scaleUtils.js\";\nimport { equals as P } from \"../geometry/support/spatialReferenceUtils.js\";\nimport O from \"./Layer.js\";\nimport { BlendLayer as L } from \"./mixins/BlendLayer.js\";\nimport { OperationalLayer as U } from \"./mixins/OperationalLayer.js\";\nimport { PortalLayer as M } from \"./mixins/PortalLayer.js\";\nimport { RefreshableLayer as T } from \"./mixins/RefreshableLayer.js\";\nimport { ScaleRangeLayer as _ } from \"./mixins/ScaleRangeLayer.js\";\nimport { TemporalLayer as C } from \"./mixins/TemporalLayer.js\";\nimport { isAxesOrderReversedForWkid as W } from \"./ogc/crsUtils.js\";\nimport { isWmsServer as $ } from \"./support/arcgisLayerUrl.js\";\nimport { legendEnabled as q, url as N } from \"./support/commonProperties.js\";\nimport { ExportWMSImageParameters as B } from \"./support/ExportWMSImageParameters.js\";\nimport { createBitmap as H } from \"./support/imageBitmapUtils.js\";\nimport k from \"./support/WMSSublayer.js\";\nimport { normalizeWKID as G, toISOString as A, getPopupLayers as D, parseCapabilities as J } from \"./support/wmsUtils.js\";\nconst V = new n({\n  bmp: \"image/bmp\",\n  gif: \"image/gif\",\n  jpg: \"image/jpeg\",\n  png: \"image/png\",\n  svg: \"image/svg+xml\"\n}, {\n  ignoreUnknown: !1\n});\n\nfunction Q(e) {\n  return \"text/html\" === e;\n}\n\nfunction z(e) {\n  return \"text/plain\" === e;\n}\n\nlet K = class extends L(C(T(_(U(M(u(O))))))) {\n  constructor(...e) {\n    super(...e), this.allSublayers = new a({\n      getCollections: () => [this.sublayers],\n      getChildrenFunction: e => e.sublayers\n    }), this.customParameters = null, this.customLayerParameters = null, this.copyright = null, this.description = null, this.dimensions = null, this.fullExtent = null, this.fullExtents = null, this.featureInfoFormats = null, this.featureInfoUrl = null, this.fetchFeatureInfoFunction = null, this.imageFormat = null, this.imageMaxHeight = 2048, this.imageMaxWidth = 2048, this.imageTransparency = !0, this.legendEnabled = !0, this.mapUrl = null, this.isReference = null, this.operationalLayerType = \"WMS\", this.spatialReference = null, this.spatialReferences = null, this.sublayers = null, this.type = \"wms\", this.url = null, this.version = null, this.addHandles([f(() => this.sublayers, \"after-add\", ({\n      item: e\n    }) => {\n      e.parent = e.layer = this;\n    }, d), f(() => this.sublayers, \"after-remove\", ({\n      item: e\n    }) => {\n      e.layer = e.parent = null;\n    }, d), y(() => this.sublayers, (e, t) => {\n      if (t) for (const r of t) r.layer = r.parent = null;\n      if (e) for (const r of e) r.parent = r.layer = this;\n    }, d)]);\n  }\n\n  normalizeCtorArgs(e, t) {\n    return \"string\" == typeof e ? {\n      url: e,\n      ...t\n    } : e;\n  }\n\n  load(e) {\n    const t = p(e) ? e.signal : null;\n    return this.addResolvingPromise(this.loadFromPortal({\n      supportedTypes: [\"WMS\"]\n    }, e).catch(c).then(() => this._fetchService(t))), Promise.resolve(this);\n  }\n\n  readFullExtentFromItemOrMap(e, t) {\n    const r = t.extent;\n    return r ? new F({\n      xmin: r[0][0],\n      ymin: r[0][1],\n      xmax: r[1][0],\n      ymax: r[1][1]\n    }) : null;\n  }\n\n  writeFullExtent(e, t) {\n    t.extent = [[e.xmin, e.ymin], [e.xmax, e.ymax]];\n  }\n\n  get featureInfoFormat() {\n    return m(this.featureInfoFormats) ? null : this.featureInfoFormats.find(Q) ?? this.featureInfoFormats.find(z) ?? null;\n  }\n\n  set featureInfoFormat(e) {\n    p(e) ? (Q(e) || z(e)) && this._override(\"featureInfoFormat\", e) : (this.revert(\"featureInfoFormat\", \"service\"), this._clearOverride(\"featureInfoFormat\"));\n  }\n\n  readImageFormat(e, t) {\n    const r = t.supportedImageFormatTypes;\n    return r && r.includes(\"image/png\") ? \"image/png\" : r && r[0];\n  }\n\n  readSpatialReferenceFromItemOrDocument(e, t) {\n    return new E(t.spatialReferences[0]);\n  }\n\n  writeSpatialReferences(e, t) {\n    const r = this.spatialReference?.wkid;\n    e && r ? (t.spatialReferences = e.filter(e => e !== r), t.spatialReferences.unshift(r)) : t.spatialReferences = e;\n  }\n\n  readSublayersFromItemOrMap(e, t, r) {\n    return Y(t.layers, r, t.visibleLayers);\n  }\n\n  readSublayers(e, t, r) {\n    return Y(t.layers, r);\n  }\n\n  writeSublayers(e, t, r, o) {\n    t.layers = [];\n    const s = new Map(),\n          i = e.flatten(({\n      sublayers: e\n    }) => e ?? []);\n\n    for (const a of i) if (\"number\" == typeof a.parent?.id) {\n      const e = s.get(a.parent.id);\n      null != e ? e.push(a.id) : s.set(a.parent.id, [a.id]);\n    }\n\n    for (const a of i) {\n      const e = {\n        sublayer: a,\n        ...o\n      },\n            r = a.write({\n        parentLayerId: \"number\" == typeof a.parent?.id ? a.parent.id : -1\n      }, e);\n\n      if (s.has(a.id) && (r.sublayerIds = s.get(a.id)), !a.sublayers && a.name) {\n        const r = a.write({}, e);\n        delete r.id, t.layers.push(r);\n      }\n    }\n\n    t.visibleLayers = i.filter(({\n      visible: e,\n      sublayers: t\n    }) => e && !t).map(({\n      name: e\n    }) => e).toArray();\n  }\n\n  createExportImageParameters(e, t, r, o) {\n    const s = o?.pixelRatio ?? 1,\n          i = R({\n      extent: e,\n      width: t\n    }) * s,\n          a = new B({\n      layer: this,\n      scale: i\n    }),\n          {\n      xmin: n,\n      ymin: l,\n      xmax: p,\n      ymax: m,\n      spatialReference: u\n    } = e,\n          c = G(u, this.spatialReferences),\n          f = \"1.3.0\" === this.version && W(c) ? `${l},${n},${m},${p}` : `${n},${l},${p},${m}`,\n          y = a.toJSON();\n    return {\n      bbox: f,\n      [\"1.3.0\" === this.version ? \"crs\" : \"srs\"]: null == c || isNaN(c) ? void 0 : \"EPSG:\" + c,\n      ...y\n    };\n  }\n\n  fetchImage(e, t, r, o) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const i = _this.mapUrl,\n            a = _this.createExportImageParameters(e, t, r, o);\n\n      if (!a.layers) {\n        const e = document.createElement(\"canvas\");\n        return e.width = t, e.height = r, e;\n      }\n\n      const n = o?.timeExtent?.start,\n            l = o?.timeExtent?.end,\n            m = p(n) && p(l) ? n.getTime() === l.getTime() ? A(n) : `${A(n)}/${A(l)}` : void 0,\n            u = {\n        responseType: \"image\",\n        query: _this._mixCustomParameters({\n          width: t,\n          height: r,\n          ...a,\n          time: m,\n          ..._this.refreshParameters\n        }),\n        signal: o?.signal\n      };\n      return s(i ?? \"\", u).then(e => e.data);\n    })();\n  }\n\n  fetchImageBitmap(e, t, r, o) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const i = _this2.mapUrl ?? \"\",\n            a = _this2.createExportImageParameters(e, t, r, o);\n\n      if (!a.layers) {\n        const e = document.createElement(\"canvas\");\n        return e.width = t, e.height = r, e;\n      }\n\n      const n = o?.timeExtent?.start,\n            l = o?.timeExtent?.end,\n            m = p(n) && p(l) ? n.getTime() === l.getTime() ? A(n) : `${A(n)}/${A(l)}` : void 0,\n            u = {\n        responseType: \"blob\",\n        query: _this2._mixCustomParameters({\n          width: t,\n          height: r,\n          ...a,\n          time: m,\n          ..._this2.refreshParameters\n        }),\n        signal: o?.signal\n      },\n            {\n        data: c\n      } = yield s(i, u);\n      return H(c, i);\n    })();\n  }\n\n  fetchFeatureInfo(e, t, r, o, s) {\n    const i = R({\n      extent: e,\n      width: t\n    }),\n          a = new B({\n      layer: this,\n      scale: i\n    }),\n          n = D(a.visibleSublayers);\n    if (m(this.featureInfoUrl) || m(n)) return Promise.resolve([]);\n    if (m(this.fetchFeatureInfoFunction) && m(this.featureInfoFormat)) return Promise.resolve([]);\n\n    const l = \"1.3.0\" === this.version ? {\n      I: o,\n      J: s\n    } : {\n      x: o,\n      y: s\n    },\n          u = {\n      query_layers: n,\n      request: \"GetFeatureInfo\",\n      info_format: this.featureInfoFormat,\n      feature_count: 25,\n      width: t,\n      height: r,\n      ...l\n    },\n          c = { ...this.createExportImageParameters(e, t, r),\n      ...u\n    },\n          f = this._mixCustomParameters(c);\n\n    return p(this.fetchFeatureInfoFunction) ? this.fetchFeatureInfoFunction(f) : this._defaultFetchFeatureInfoFunction(h(this.featureInfoUrl, f));\n  }\n\n  findSublayerById(e) {\n    return this.allSublayers.find(t => t.id === e);\n  }\n\n  findSublayerByName(e) {\n    return this.allSublayers.find(t => t.name === e);\n  }\n\n  serviceSupportsSpatialReference(e) {\n    return $(this.url) || null != this.spatialReferences && this.spatialReferences.some(t => {\n      const r = 900913 === t ? E.WebMercator : new E({\n        wkid: t\n      });\n      return P(r, e);\n    });\n  }\n\n  _defaultFetchFeatureInfoFunction(e) {\n    const t = document.createElement(\"iframe\");\n    t.src = g(e), t.style.border = \"none\", t.style.margin = \"0\", t.style.width = \"100%\", t.setAttribute(\"sandbox\", \"\");\n    const s = new o({\n      title: this.title,\n      content: t\n    }),\n          i = new r({\n      sourceLayer: this,\n      popupTemplate: s\n    });\n    return Promise.resolve([i]);\n  }\n\n  _fetchService(e) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!_this3.resourceInfo) {\n        const {\n          path: t,\n          query: r\n        } = _this3.parsedUrl ?? {};\n        r?.service && (r.SERVICE = r.service, delete r.service), r?.request && (r.REQUEST = r.request, delete r.request);\n        const {\n          data: o\n        } = yield s(t ?? \"\", {\n          query: {\n            SERVICE: \"WMS\",\n            REQUEST: \"GetCapabilities\",\n            ...r,\n            ..._this3.customParameters\n          },\n          responseType: \"xml\",\n          signal: e\n        });\n        _this3.resourceInfo = J(o);\n      }\n\n      if (_this3.parsedUrl) {\n        const e = new b(_this3.parsedUrl.path),\n              {\n          httpsDomains: r\n        } = t.request;\n        \"https\" !== e.scheme || e.port && \"443\" !== e.port || !e.host || r.includes(e.host) || r.push(e.host);\n      }\n\n      _this3.read(_this3.resourceInfo, {\n        origin: \"service\"\n      });\n    })();\n  }\n\n  _mixCustomParameters(e) {\n    if (!this.customLayerParameters && !this.customParameters) return e;\n    const t = { ...this.customParameters,\n      ...this.customLayerParameters\n    };\n\n    for (const r in t) e[r.toLowerCase()] = t[r];\n\n    return e;\n  }\n\n};\n\nfunction X(e, t) {\n  return e.some(e => {\n    for (const r in e) if (S(e, r, null, t)) return !0;\n\n    return !1;\n  });\n}\n\nfunction Y(e, t, r) {\n  e = e ?? [];\n  const o = new Map();\n  e.every(e => null == e.id) && (e = l(e)).forEach((e, t) => e.id = t);\n\n  for (const i of e) {\n    const e = new k();\n    e.read(i, t), r && !r.includes(e.name) && (e.visible = !1), o.set(e.id, e);\n  }\n\n  const s = [];\n\n  for (const a of e) {\n    const e = null != a.id ? o.get(a.id) : null;\n    if (e) if (null != a.parentLayerId && a.parentLayerId >= 0) {\n      const t = o.get(a.parentLayerId);\n      if (!t) continue;\n      t.sublayers || (t.sublayers = new i()), t.sublayers.push(e);\n    } else s.push(e);\n  }\n\n  return s;\n}\n\ne([v({\n  readOnly: !0\n})], K.prototype, \"allSublayers\", void 0), e([v({\n  json: {\n    type: Object,\n    write: !0\n  }\n})], K.prototype, \"customParameters\", void 0), e([v({\n  json: {\n    type: Object,\n    write: !0\n  }\n})], K.prototype, \"customLayerParameters\", void 0), e([v({\n  type: String,\n  json: {\n    write: !0\n  }\n})], K.prototype, \"copyright\", void 0), e([v()], K.prototype, \"description\", void 0), e([v({\n  readOnly: !0\n})], K.prototype, \"dimensions\", void 0), e([v({\n  json: {\n    type: [[Number]],\n    read: {\n      source: \"extent\"\n    },\n    write: {\n      target: \"extent\"\n    },\n    origins: {\n      \"web-document\": {\n        write: {\n          ignoreOrigin: !0\n        }\n      },\n      \"portal-item\": {\n        write: {\n          ignoreOrigin: !0\n        }\n      }\n    }\n  }\n})], K.prototype, \"fullExtent\", void 0), e([x([\"web-document\", \"portal-item\"], \"fullExtent\", [\"extent\"])], K.prototype, \"readFullExtentFromItemOrMap\", null), e([I([\"web-document\", \"portal-item\"], \"fullExtent\", {\n  extent: {\n    type: [[Number]]\n  }\n})], K.prototype, \"writeFullExtent\", null), e([v()], K.prototype, \"fullExtents\", void 0), e([v({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], K.prototype, \"featureInfoFormat\", null), e([v({\n  type: [String],\n  readOnly: !0\n})], K.prototype, \"featureInfoFormats\", void 0), e([v({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], K.prototype, \"featureInfoUrl\", void 0), e([v()], K.prototype, \"fetchFeatureInfoFunction\", void 0), e([v({\n  type: String,\n  json: {\n    origins: {\n      \"web-document\": {\n        default: \"image/png\",\n        type: V.jsonValues,\n        read: {\n          reader: V.read,\n          source: \"format\"\n        },\n        write: {\n          writer: V.write,\n          target: \"format\"\n        }\n      }\n    }\n  }\n})], K.prototype, \"imageFormat\", void 0), e([x(\"imageFormat\", [\"supportedImageFormatTypes\"])], K.prototype, \"readImageFormat\", null), e([v({\n  type: Number,\n  json: {\n    read: {\n      source: \"maxHeight\"\n    },\n    write: {\n      target: \"maxHeight\"\n    }\n  }\n})], K.prototype, \"imageMaxHeight\", void 0), e([v({\n  type: Number,\n  json: {\n    read: {\n      source: \"maxWidth\"\n    },\n    write: {\n      target: \"maxWidth\"\n    }\n  }\n})], K.prototype, \"imageMaxWidth\", void 0), e([v()], K.prototype, \"imageTransparency\", void 0), e([v(q)], K.prototype, \"legendEnabled\", void 0), e([v({\n  type: [\"show\", \"hide\", \"hide-children\"]\n})], K.prototype, \"listMode\", void 0), e([v({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], K.prototype, \"mapUrl\", void 0), e([v({\n  type: Boolean,\n  json: {\n    read: !1,\n    write: {\n      enabled: !0,\n      overridePolicy: () => ({\n        enabled: !1\n      })\n    }\n  }\n})], K.prototype, \"isReference\", void 0), e([v({\n  type: [\"WMS\"]\n})], K.prototype, \"operationalLayerType\", void 0), e([v()], K.prototype, \"resourceInfo\", void 0), e([v({\n  type: E,\n  json: {\n    origins: {\n      service: {\n        read: {\n          source: \"extent.spatialReference\"\n        }\n      }\n    },\n    write: !1\n  }\n})], K.prototype, \"spatialReference\", void 0), e([x([\"web-document\", \"portal-item\"], \"spatialReference\", [\"spatialReferences\"])], K.prototype, \"readSpatialReferenceFromItemOrDocument\", null), e([v({\n  type: [w],\n  json: {\n    read: !1,\n    origins: {\n      service: {\n        read: !0\n      },\n      \"web-document\": {\n        read: !1,\n        write: {\n          ignoreOrigin: !0\n        }\n      },\n      \"portal-item\": {\n        read: !1,\n        write: {\n          ignoreOrigin: !0\n        }\n      }\n    }\n  }\n})], K.prototype, \"spatialReferences\", void 0), e([I([\"web-document\", \"portal-item\"], \"spatialReferences\")], K.prototype, \"writeSpatialReferences\", null), e([v({\n  type: i.ofType(k),\n  json: {\n    write: {\n      target: \"layers\",\n\n      overridePolicy(e, t, r) {\n        if (X(this.allSublayers, r)) return {\n          ignoreOrigin: !0\n        };\n      }\n\n    }\n  }\n})], K.prototype, \"sublayers\", void 0), e([x([\"web-document\", \"portal-item\"], \"sublayers\", [\"layers\", \"visibleLayers\"])], K.prototype, \"readSublayersFromItemOrMap\", null), e([x(\"service\", \"sublayers\", [\"layers\"])], K.prototype, \"readSublayers\", null), e([I(\"sublayers\", {\n  layers: {\n    type: [k]\n  },\n  visibleLayers: {\n    type: [String]\n  }\n})], K.prototype, \"writeSublayers\", null), e([v({\n  json: {\n    read: !1\n  },\n  readOnly: !0,\n  value: \"wms\"\n})], K.prototype, \"type\", void 0), e([v(N)], K.prototype, \"url\", void 0), e([v({\n  type: String,\n  json: {\n    write: {\n      ignoreOrigin: !0\n    }\n  }\n})], K.prototype, \"version\", void 0), K = e([j(\"esri.layers.WMSLayer\")], K);\nconst Z = K;\nexport { Z as default };","map":{"version":3,"names":["_","e","t","r","o","s","i","a","JSONMap","n","clone","l","isSome","p","isNone","m","MultiOriginJSONMixin","u","throwIfAbortError","c","on","f","watch","y","sync","d","addQueryParameters","h","addProxy","g","Url","b","property","v","Integer","w","reader","x","subclass","j","writer","I","willPropertyWrite","S","F","E","getScale","R","equals","P","O","BlendLayer","L","OperationalLayer","U","PortalLayer","M","RefreshableLayer","T","ScaleRangeLayer","TemporalLayer","C","isAxesOrderReversedForWkid","W","isWmsServer","$","legendEnabled","q","url","N","ExportWMSImageParameters","B","createBitmap","H","k","normalizeWKID","G","toISOString","A","getPopupLayers","D","parseCapabilities","J","V","bmp","gif","jpg","png","svg","ignoreUnknown","Q","z","K","constructor","allSublayers","getCollections","sublayers","getChildrenFunction","customParameters","customLayerParameters","copyright","description","dimensions","fullExtent","fullExtents","featureInfoFormats","featureInfoUrl","fetchFeatureInfoFunction","imageFormat","imageMaxHeight","imageMaxWidth","imageTransparency","mapUrl","isReference","operationalLayerType","spatialReference","spatialReferences","type","version","addHandles","item","parent","layer","normalizeCtorArgs","load","signal","addResolvingPromise","loadFromPortal","supportedTypes","catch","then","_fetchService","Promise","resolve","readFullExtentFromItemOrMap","extent","xmin","ymin","xmax","ymax","writeFullExtent","featureInfoFormat","find","_override","revert","_clearOverride","readImageFormat","supportedImageFormatTypes","includes","readSpatialReferenceFromItemOrDocument","writeSpatialReferences","wkid","filter","unshift","readSublayersFromItemOrMap","Y","layers","visibleLayers","readSublayers","writeSublayers","Map","flatten","id","get","push","set","sublayer","write","parentLayerId","has","sublayerIds","name","visible","map","toArray","createExportImageParameters","pixelRatio","width","scale","toJSON","bbox","isNaN","fetchImage","document","createElement","height","timeExtent","start","end","getTime","responseType","query","_mixCustomParameters","time","refreshParameters","data","fetchImageBitmap","fetchFeatureInfo","visibleSublayers","query_layers","request","info_format","feature_count","_defaultFetchFeatureInfoFunction","findSublayerById","findSublayerByName","serviceSupportsSpatialReference","some","WebMercator","src","style","border","margin","setAttribute","title","content","sourceLayer","popupTemplate","resourceInfo","path","parsedUrl","service","SERVICE","REQUEST","httpsDomains","scheme","port","host","read","origin","toLowerCase","X","every","forEach","readOnly","prototype","json","Object","String","Number","source","target","origins","ignoreOrigin","default","jsonValues","Boolean","enabled","overridePolicy","ofType","value","Z"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/layers/WMSLayer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../chunks/tslib.es6.js\";import t from\"../config.js\";import r from\"../Graphic.js\";import o from\"../PopupTemplate.js\";import s from\"../request.js\";import i from\"../core/Collection.js\";import a from\"../core/CollectionFlattener.js\";import{JSONMap as n}from\"../core/jsonMap.js\";import{clone as l}from\"../core/lang.js\";import{isSome as p,isNone as m}from\"../core/maybe.js\";import{MultiOriginJSONMixin as u}from\"../core/MultiOriginJSONSupport.js\";import{throwIfAbortError as c}from\"../core/promiseUtils.js\";import{on as f,watch as y,sync as d}from\"../core/reactiveUtils.js\";import{addQueryParameters as h,addProxy as g,Url as b}from\"../core/urlUtils.js\";import{property as v}from\"../core/accessorSupport/decorators/property.js\";import{Integer as w}from\"../core/accessorSupport/ensureType.js\";import{reader as x}from\"../core/accessorSupport/decorators/reader.js\";import{subclass as j}from\"../core/accessorSupport/decorators/subclass.js\";import{writer as I}from\"../core/accessorSupport/decorators/writer.js\";import{willPropertyWrite as S}from\"../core/accessorSupport/write.js\";import F from\"../geometry/Extent.js\";import E from\"../geometry/SpatialReference.js\";import{getScale as R}from\"../geometry/support/scaleUtils.js\";import{equals as P}from\"../geometry/support/spatialReferenceUtils.js\";import O from\"./Layer.js\";import{BlendLayer as L}from\"./mixins/BlendLayer.js\";import{OperationalLayer as U}from\"./mixins/OperationalLayer.js\";import{PortalLayer as M}from\"./mixins/PortalLayer.js\";import{RefreshableLayer as T}from\"./mixins/RefreshableLayer.js\";import{ScaleRangeLayer as _}from\"./mixins/ScaleRangeLayer.js\";import{TemporalLayer as C}from\"./mixins/TemporalLayer.js\";import{isAxesOrderReversedForWkid as W}from\"./ogc/crsUtils.js\";import{isWmsServer as $}from\"./support/arcgisLayerUrl.js\";import{legendEnabled as q,url as N}from\"./support/commonProperties.js\";import{ExportWMSImageParameters as B}from\"./support/ExportWMSImageParameters.js\";import{createBitmap as H}from\"./support/imageBitmapUtils.js\";import k from\"./support/WMSSublayer.js\";import{normalizeWKID as G,toISOString as A,getPopupLayers as D,parseCapabilities as J}from\"./support/wmsUtils.js\";const V=new n({bmp:\"image/bmp\",gif:\"image/gif\",jpg:\"image/jpeg\",png:\"image/png\",svg:\"image/svg+xml\"},{ignoreUnknown:!1});function Q(e){return\"text/html\"===e}function z(e){return\"text/plain\"===e}let K=class extends(L(C(T(_(U(M(u(O)))))))){constructor(...e){super(...e),this.allSublayers=new a({getCollections:()=>[this.sublayers],getChildrenFunction:e=>e.sublayers}),this.customParameters=null,this.customLayerParameters=null,this.copyright=null,this.description=null,this.dimensions=null,this.fullExtent=null,this.fullExtents=null,this.featureInfoFormats=null,this.featureInfoUrl=null,this.fetchFeatureInfoFunction=null,this.imageFormat=null,this.imageMaxHeight=2048,this.imageMaxWidth=2048,this.imageTransparency=!0,this.legendEnabled=!0,this.mapUrl=null,this.isReference=null,this.operationalLayerType=\"WMS\",this.spatialReference=null,this.spatialReferences=null,this.sublayers=null,this.type=\"wms\",this.url=null,this.version=null,this.addHandles([f((()=>this.sublayers),\"after-add\",(({item:e})=>{e.parent=e.layer=this}),d),f((()=>this.sublayers),\"after-remove\",(({item:e})=>{e.layer=e.parent=null}),d),y((()=>this.sublayers),((e,t)=>{if(t)for(const r of t)r.layer=r.parent=null;if(e)for(const r of e)r.parent=r.layer=this}),d)])}normalizeCtorArgs(e,t){return\"string\"==typeof e?{url:e,...t}:e}load(e){const t=p(e)?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:[\"WMS\"]},e).catch(c).then((()=>this._fetchService(t)))),Promise.resolve(this)}readFullExtentFromItemOrMap(e,t){const r=t.extent;return r?new F({xmin:r[0][0],ymin:r[0][1],xmax:r[1][0],ymax:r[1][1]}):null}writeFullExtent(e,t){t.extent=[[e.xmin,e.ymin],[e.xmax,e.ymax]]}get featureInfoFormat(){return m(this.featureInfoFormats)?null:this.featureInfoFormats.find(Q)??this.featureInfoFormats.find(z)??null}set featureInfoFormat(e){p(e)?(Q(e)||z(e))&&this._override(\"featureInfoFormat\",e):(this.revert(\"featureInfoFormat\",\"service\"),this._clearOverride(\"featureInfoFormat\"))}readImageFormat(e,t){const r=t.supportedImageFormatTypes;return r&&r.includes(\"image/png\")?\"image/png\":r&&r[0]}readSpatialReferenceFromItemOrDocument(e,t){return new E(t.spatialReferences[0])}writeSpatialReferences(e,t){const r=this.spatialReference?.wkid;e&&r?(t.spatialReferences=e.filter((e=>e!==r)),t.spatialReferences.unshift(r)):t.spatialReferences=e}readSublayersFromItemOrMap(e,t,r){return Y(t.layers,r,t.visibleLayers)}readSublayers(e,t,r){return Y(t.layers,r)}writeSublayers(e,t,r,o){t.layers=[];const s=new Map,i=e.flatten((({sublayers:e})=>e??[]));for(const a of i)if(\"number\"==typeof a.parent?.id){const e=s.get(a.parent.id);null!=e?e.push(a.id):s.set(a.parent.id,[a.id])}for(const a of i){const e={sublayer:a,...o},r=a.write({parentLayerId:\"number\"==typeof a.parent?.id?a.parent.id:-1},e);if(s.has(a.id)&&(r.sublayerIds=s.get(a.id)),!a.sublayers&&a.name){const r=a.write({},e);delete r.id,t.layers.push(r)}}t.visibleLayers=i.filter((({visible:e,sublayers:t})=>e&&!t)).map((({name:e})=>e)).toArray()}createExportImageParameters(e,t,r,o){const s=o?.pixelRatio??1,i=R({extent:e,width:t})*s,a=new B({layer:this,scale:i}),{xmin:n,ymin:l,xmax:p,ymax:m,spatialReference:u}=e,c=G(u,this.spatialReferences),f=\"1.3.0\"===this.version&&W(c)?`${l},${n},${m},${p}`:`${n},${l},${p},${m}`,y=a.toJSON();return{bbox:f,[\"1.3.0\"===this.version?\"crs\":\"srs\"]:null==c||isNaN(c)?void 0:\"EPSG:\"+c,...y}}async fetchImage(e,t,r,o){const i=this.mapUrl,a=this.createExportImageParameters(e,t,r,o);if(!a.layers){const e=document.createElement(\"canvas\");return e.width=t,e.height=r,e}const n=o?.timeExtent?.start,l=o?.timeExtent?.end,m=p(n)&&p(l)?n.getTime()===l.getTime()?A(n):`${A(n)}/${A(l)}`:void 0,u={responseType:\"image\",query:this._mixCustomParameters({width:t,height:r,...a,time:m,...this.refreshParameters}),signal:o?.signal};return s(i??\"\",u).then((e=>e.data))}async fetchImageBitmap(e,t,r,o){const i=this.mapUrl??\"\",a=this.createExportImageParameters(e,t,r,o);if(!a.layers){const e=document.createElement(\"canvas\");return e.width=t,e.height=r,e}const n=o?.timeExtent?.start,l=o?.timeExtent?.end,m=p(n)&&p(l)?n.getTime()===l.getTime()?A(n):`${A(n)}/${A(l)}`:void 0,u={responseType:\"blob\",query:this._mixCustomParameters({width:t,height:r,...a,time:m,...this.refreshParameters}),signal:o?.signal},{data:c}=await s(i,u);return H(c,i)}fetchFeatureInfo(e,t,r,o,s){const i=R({extent:e,width:t}),a=new B({layer:this,scale:i}),n=D(a.visibleSublayers);if(m(this.featureInfoUrl)||m(n))return Promise.resolve([]);if(m(this.fetchFeatureInfoFunction)&&m(this.featureInfoFormat))return Promise.resolve([]);const l=\"1.3.0\"===this.version?{I:o,J:s}:{x:o,y:s},u={query_layers:n,request:\"GetFeatureInfo\",info_format:this.featureInfoFormat,feature_count:25,width:t,height:r,...l},c={...this.createExportImageParameters(e,t,r),...u},f=this._mixCustomParameters(c);return p(this.fetchFeatureInfoFunction)?this.fetchFeatureInfoFunction(f):this._defaultFetchFeatureInfoFunction(h(this.featureInfoUrl,f))}findSublayerById(e){return this.allSublayers.find((t=>t.id===e))}findSublayerByName(e){return this.allSublayers.find((t=>t.name===e))}serviceSupportsSpatialReference(e){return $(this.url)||null!=this.spatialReferences&&this.spatialReferences.some((t=>{const r=900913===t?E.WebMercator:new E({wkid:t});return P(r,e)}))}_defaultFetchFeatureInfoFunction(e){const t=document.createElement(\"iframe\");t.src=g(e),t.style.border=\"none\",t.style.margin=\"0\",t.style.width=\"100%\",t.setAttribute(\"sandbox\",\"\");const s=new o({title:this.title,content:t}),i=new r({sourceLayer:this,popupTemplate:s});return Promise.resolve([i])}async _fetchService(e){if(!this.resourceInfo){const{path:t,query:r}=this.parsedUrl??{};r?.service&&(r.SERVICE=r.service,delete r.service),r?.request&&(r.REQUEST=r.request,delete r.request);const{data:o}=await s(t??\"\",{query:{SERVICE:\"WMS\",REQUEST:\"GetCapabilities\",...r,...this.customParameters},responseType:\"xml\",signal:e});this.resourceInfo=J(o)}if(this.parsedUrl){const e=new b(this.parsedUrl.path),{httpsDomains:r}=t.request;\"https\"!==e.scheme||e.port&&\"443\"!==e.port||!e.host||r.includes(e.host)||r.push(e.host)}this.read(this.resourceInfo,{origin:\"service\"})}_mixCustomParameters(e){if(!this.customLayerParameters&&!this.customParameters)return e;const t={...this.customParameters,...this.customLayerParameters};for(const r in t)e[r.toLowerCase()]=t[r];return e}};function X(e,t){return e.some((e=>{for(const r in e)if(S(e,r,null,t))return!0;return!1}))}function Y(e,t,r){e=e??[];const o=new Map;e.every((e=>null==e.id))&&(e=l(e)).forEach(((e,t)=>e.id=t));for(const i of e){const e=new k;e.read(i,t),r&&!r.includes(e.name)&&(e.visible=!1),o.set(e.id,e)}const s=[];for(const a of e){const e=null!=a.id?o.get(a.id):null;if(e)if(null!=a.parentLayerId&&a.parentLayerId>=0){const t=o.get(a.parentLayerId);if(!t)continue;t.sublayers||(t.sublayers=new i),t.sublayers.push(e)}else s.push(e)}return s}e([v({readOnly:!0})],K.prototype,\"allSublayers\",void 0),e([v({json:{type:Object,write:!0}})],K.prototype,\"customParameters\",void 0),e([v({json:{type:Object,write:!0}})],K.prototype,\"customLayerParameters\",void 0),e([v({type:String,json:{write:!0}})],K.prototype,\"copyright\",void 0),e([v()],K.prototype,\"description\",void 0),e([v({readOnly:!0})],K.prototype,\"dimensions\",void 0),e([v({json:{type:[[Number]],read:{source:\"extent\"},write:{target:\"extent\"},origins:{\"web-document\":{write:{ignoreOrigin:!0}},\"portal-item\":{write:{ignoreOrigin:!0}}}}})],K.prototype,\"fullExtent\",void 0),e([x([\"web-document\",\"portal-item\"],\"fullExtent\",[\"extent\"])],K.prototype,\"readFullExtentFromItemOrMap\",null),e([I([\"web-document\",\"portal-item\"],\"fullExtent\",{extent:{type:[[Number]]}})],K.prototype,\"writeFullExtent\",null),e([v()],K.prototype,\"fullExtents\",void 0),e([v({type:String,json:{write:{ignoreOrigin:!0}}})],K.prototype,\"featureInfoFormat\",null),e([v({type:[String],readOnly:!0})],K.prototype,\"featureInfoFormats\",void 0),e([v({type:String,json:{write:{ignoreOrigin:!0}}})],K.prototype,\"featureInfoUrl\",void 0),e([v()],K.prototype,\"fetchFeatureInfoFunction\",void 0),e([v({type:String,json:{origins:{\"web-document\":{default:\"image/png\",type:V.jsonValues,read:{reader:V.read,source:\"format\"},write:{writer:V.write,target:\"format\"}}}}})],K.prototype,\"imageFormat\",void 0),e([x(\"imageFormat\",[\"supportedImageFormatTypes\"])],K.prototype,\"readImageFormat\",null),e([v({type:Number,json:{read:{source:\"maxHeight\"},write:{target:\"maxHeight\"}}})],K.prototype,\"imageMaxHeight\",void 0),e([v({type:Number,json:{read:{source:\"maxWidth\"},write:{target:\"maxWidth\"}}})],K.prototype,\"imageMaxWidth\",void 0),e([v()],K.prototype,\"imageTransparency\",void 0),e([v(q)],K.prototype,\"legendEnabled\",void 0),e([v({type:[\"show\",\"hide\",\"hide-children\"]})],K.prototype,\"listMode\",void 0),e([v({type:String,json:{write:{ignoreOrigin:!0}}})],K.prototype,\"mapUrl\",void 0),e([v({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],K.prototype,\"isReference\",void 0),e([v({type:[\"WMS\"]})],K.prototype,\"operationalLayerType\",void 0),e([v()],K.prototype,\"resourceInfo\",void 0),e([v({type:E,json:{origins:{service:{read:{source:\"extent.spatialReference\"}}},write:!1}})],K.prototype,\"spatialReference\",void 0),e([x([\"web-document\",\"portal-item\"],\"spatialReference\",[\"spatialReferences\"])],K.prototype,\"readSpatialReferenceFromItemOrDocument\",null),e([v({type:[w],json:{read:!1,origins:{service:{read:!0},\"web-document\":{read:!1,write:{ignoreOrigin:!0}},\"portal-item\":{read:!1,write:{ignoreOrigin:!0}}}}})],K.prototype,\"spatialReferences\",void 0),e([I([\"web-document\",\"portal-item\"],\"spatialReferences\")],K.prototype,\"writeSpatialReferences\",null),e([v({type:i.ofType(k),json:{write:{target:\"layers\",overridePolicy(e,t,r){if(X(this.allSublayers,r))return{ignoreOrigin:!0}}}}})],K.prototype,\"sublayers\",void 0),e([x([\"web-document\",\"portal-item\"],\"sublayers\",[\"layers\",\"visibleLayers\"])],K.prototype,\"readSublayersFromItemOrMap\",null),e([x(\"service\",\"sublayers\",[\"layers\"])],K.prototype,\"readSublayers\",null),e([I(\"sublayers\",{layers:{type:[k]},visibleLayers:{type:[String]}})],K.prototype,\"writeSublayers\",null),e([v({json:{read:!1},readOnly:!0,value:\"wms\"})],K.prototype,\"type\",void 0),e([v(N)],K.prototype,\"url\",void 0),e([v({type:String,json:{write:{ignoreOrigin:!0}}})],K.prototype,\"version\",void 0),K=e([j(\"esri.layers.WMSLayer\")],K);const Z=K;export{Z as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}