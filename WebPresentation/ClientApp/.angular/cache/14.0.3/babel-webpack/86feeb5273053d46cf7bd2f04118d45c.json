{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../../chunks/tslib.es6.js\";\nimport { isSome as t } from \"../../../../core/maybe.js\";\nimport { watch as i } from \"../../../../core/reactiveUtils.js\";\nimport { property as r } from \"../../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../../core/accessorSupport/ensureType.js\";\nimport \"../../../../core/arrayUtils.js\";\nimport { subclass as o } from \"../../../../core/accessorSupport/decorators/subclass.js\";\nimport { sampleVectorField as s } from \"../../../../layers/support/rasterFunctions/vectorFieldUtils.js\";\nimport { RasterVFTileContainer as l } from \"../../engine/imagery/RasterVFTileContainer.js\";\nimport { BaseImageryTileSubView2D as a } from \"./BaseImageryTileSubView2D.js\";\nlet c = class extends a {\n  constructor() {\n    super(...arguments), this._handle = null, this.type = \"rasterVF\";\n  }\n\n  canUseWebGLForProcessing() {\n    return !1;\n  }\n\n  fetchTile(e, t) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      t = { ...t,\n        interpolation: \"nearest\",\n        requestProjectedLocalDirections: !0\n      };\n      const i = yield _this.layer.fetchTile(e.level, e.row, e.col, t);\n      return \"vector-magdir\" === _this.layer.rasterInfo.dataType && i?.pixelBlock && (i.pixelBlock = yield _this.layer.convertVectorFieldData(i.pixelBlock, t)), i;\n    })();\n  }\n\n  updateTileSource(e, i) {\n    const r = i.symbolizerParams,\n          {\n      tileData: o\n    } = e;\n    o.key = e.key, o.width = this._tileInfoView.tileInfo.size[0], o.height = this._tileInfoView.tileInfo.size[1];\n    const {\n      symbolTileSize: s\n    } = r,\n          {\n      source: l\n    } = i;\n\n    if (o.offset = this._getTileSymbolOffset(o.key, s), t(l) && t(l.pixelBlock)) {\n      const e = {\n        extent: l.extent,\n        pixelBlock: l.pixelBlock\n      };\n      o.rawPixelData = e, o.symbolizerParameters = r, o.source = this._sampleVectorFieldData(l.pixelBlock, r, o.offset);\n    } else {\n      const e = [Math.round((this._tileInfoView.tileInfo[0] - o.offset[0]) / s), Math.round((this._tileInfoView.tileInfo[1] - o.offset[1]) / s)],\n            t = this.createEmptyTilePixelBlock(e);\n      o.source = t, o.symbolizerParameters = r;\n    }\n\n    return o.invalidateVAO(), Promise.resolve();\n  }\n\n  updateTileSymbolizerParameters(e, i) {\n    const r = i.local,\n          {\n      symbolTileSize: o\n    } = r,\n          {\n      tileData: s\n    } = e;\n    s.offset = this._getTileSymbolOffset(s.key, o);\n    const l = s.symbolizerParameters.symbolTileSize;\n    s.symbolizerParameters = r;\n    const a = s.rawPixelData?.pixelBlock;\n    return t(a) && l !== o && (s.source = this._sampleVectorFieldData(a, s.symbolizerParameters, s.offset)), Promise.resolve();\n  }\n\n  attach() {\n    super.attach(), this.container = new l(this._tileInfoView), this.container.isCustomTilingScheme = this._isCustomTilingScheme, this._updateSymbolType(this.layer.renderer), this._handle = i(() => this.layer.renderer, e => this._updateSymbolType(e));\n  }\n\n  detach() {\n    super.detach(), this.container.removeAllChildren(), this._handle?.remove(), this._handle = null, this.container = null;\n  }\n\n  _getTileSymbolOffset(e, t) {\n    const i = e.col * this._tileInfoView.tileInfo.size[0] % t,\n          r = e.row * this._tileInfoView.tileInfo.size[1] % t;\n    return [i > t / 2 ? t - i : -i, r > t / 2 ? t - r : -r];\n  }\n\n  _sampleVectorFieldData(e, t, i) {\n    const {\n      symbolTileSize: r\n    } = t;\n    return s(e, \"vector-uv\", r, i);\n  }\n\n  _updateSymbolType(e) {\n    \"vector-field\" === e.type && (this.container.symbolTypes = \"wind-barb\" === e.style ? [\"scalar\", \"triangle\"] : \"simple-scalar\" === e.style ? [\"scalar\"] : [\"triangle\"]);\n  }\n\n};\ne([r()], c.prototype, \"container\", void 0), e([r()], c.prototype, \"layer\", void 0), e([r()], c.prototype, \"type\", void 0), c = e([o(\"esri.views.2d.layers.imagery.VectorFieldTileView2D\")], c);\nconst n = c;\nexport { n as default };","map":{"version":3,"names":["_","e","isSome","t","watch","i","property","r","subclass","o","sampleVectorField","s","RasterVFTileContainer","l","BaseImageryTileSubView2D","a","c","constructor","arguments","_handle","type","canUseWebGLForProcessing","fetchTile","interpolation","requestProjectedLocalDirections","layer","level","row","col","rasterInfo","dataType","pixelBlock","convertVectorFieldData","updateTileSource","symbolizerParams","tileData","key","width","_tileInfoView","tileInfo","size","height","symbolTileSize","source","offset","_getTileSymbolOffset","extent","rawPixelData","symbolizerParameters","_sampleVectorFieldData","Math","round","createEmptyTilePixelBlock","invalidateVAO","Promise","resolve","updateTileSymbolizerParameters","local","attach","container","isCustomTilingScheme","_isCustomTilingScheme","_updateSymbolType","renderer","detach","removeAllChildren","remove","symbolTypes","style","prototype","n","default"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/views/2d/layers/imagery/VectorFieldTileView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import{isSome as t}from\"../../../../core/maybe.js\";import{watch as i}from\"../../../../core/reactiveUtils.js\";import{property as r}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/accessorSupport/ensureType.js\";import\"../../../../core/arrayUtils.js\";import{subclass as o}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{sampleVectorField as s}from\"../../../../layers/support/rasterFunctions/vectorFieldUtils.js\";import{RasterVFTileContainer as l}from\"../../engine/imagery/RasterVFTileContainer.js\";import{BaseImageryTileSubView2D as a}from\"./BaseImageryTileSubView2D.js\";let c=class extends a{constructor(){super(...arguments),this._handle=null,this.type=\"rasterVF\"}canUseWebGLForProcessing(){return!1}async fetchTile(e,t){t={...t,interpolation:\"nearest\",requestProjectedLocalDirections:!0};const i=await this.layer.fetchTile(e.level,e.row,e.col,t);return\"vector-magdir\"===this.layer.rasterInfo.dataType&&i?.pixelBlock&&(i.pixelBlock=await this.layer.convertVectorFieldData(i.pixelBlock,t)),i}updateTileSource(e,i){const r=i.symbolizerParams,{tileData:o}=e;o.key=e.key,o.width=this._tileInfoView.tileInfo.size[0],o.height=this._tileInfoView.tileInfo.size[1];const{symbolTileSize:s}=r,{source:l}=i;if(o.offset=this._getTileSymbolOffset(o.key,s),t(l)&&t(l.pixelBlock)){const e={extent:l.extent,pixelBlock:l.pixelBlock};o.rawPixelData=e,o.symbolizerParameters=r,o.source=this._sampleVectorFieldData(l.pixelBlock,r,o.offset)}else{const e=[Math.round((this._tileInfoView.tileInfo[0]-o.offset[0])/s),Math.round((this._tileInfoView.tileInfo[1]-o.offset[1])/s)],t=this.createEmptyTilePixelBlock(e);o.source=t,o.symbolizerParameters=r}return o.invalidateVAO(),Promise.resolve()}updateTileSymbolizerParameters(e,i){const r=i.local,{symbolTileSize:o}=r,{tileData:s}=e;s.offset=this._getTileSymbolOffset(s.key,o);const l=s.symbolizerParameters.symbolTileSize;s.symbolizerParameters=r;const a=s.rawPixelData?.pixelBlock;return t(a)&&l!==o&&(s.source=this._sampleVectorFieldData(a,s.symbolizerParameters,s.offset)),Promise.resolve()}attach(){super.attach(),this.container=new l(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,this._updateSymbolType(this.layer.renderer),this._handle=i((()=>this.layer.renderer),(e=>this._updateSymbolType(e)))}detach(){super.detach(),this.container.removeAllChildren(),this._handle?.remove(),this._handle=null,this.container=null}_getTileSymbolOffset(e,t){const i=e.col*this._tileInfoView.tileInfo.size[0]%t,r=e.row*this._tileInfoView.tileInfo.size[1]%t;return[i>t/2?t-i:-i,r>t/2?t-r:-r]}_sampleVectorFieldData(e,t,i){const{symbolTileSize:r}=t;return s(e,\"vector-uv\",r,i)}_updateSymbolType(e){\"vector-field\"===e.type&&(this.container.symbolTypes=\"wind-barb\"===e.style?[\"scalar\",\"triangle\"]:\"simple-scalar\"===e.style?[\"scalar\"]:[\"triangle\"])}};e([r()],c.prototype,\"container\",void 0),e([r()],c.prototype,\"layer\",void 0),e([r()],c.prototype,\"type\",void 0),c=e([o(\"esri.views.2d.layers.imagery.VectorFieldTileView2D\")],c);const n=c;export{n as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}