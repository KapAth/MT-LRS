{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as e } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Error.js\";\nimport { handlesGroup as r } from \"../../../core/handleUtils.js\";\nimport { isNone as s, isSome as o } from \"../../../core/maybe.js\";\nimport { watch as i } from \"../../../core/reactiveUtils.js\";\nimport { property as n } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as a } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport c from \"../../../rest/support/FeatureSet.js\";\nimport p from \"./FeatureLayerView2D.js\";\nimport { toJSONGeometryType as l } from \"./support/util.js\";\n\nfunction u(e, t) {\n  if (s(e) && s(t)) return null;\n  const r = {};\n  return o(t) && (r.geometry = t.toJSON()), o(e) && (r.where = e), r;\n}\n\nlet m = class extends p {\n  constructor() {\n    super(...arguments), this._enabledEventTypes = new Set(), this._isUserPaused = !1, this.errorString = null, this.connectionStatus = \"disconnected\";\n  }\n\n  initialize() {\n    this.addHandles([i(() => this.layer.customParameters, e => this._proxy.updateCustomParameters(e)), this.layer.on(\"send-message-to-socket\", e => this._proxy.sendMessageToSocket(e)), this.layer.on(\"send-message-to-client\", e => this._proxy.sendMessageToClient(e)), i(() => this.layer.purgeOptions, () => this._update()), i(() => this.suspended, e => {\n      e ? this._proxy.pauseStream() : this._isUserPaused || this._proxy.resumeStream();\n    })], \"constructor\");\n  }\n\n  get connectionError() {\n    if (this.errorString) return new t(\"stream-controller\", this.errorString);\n  }\n\n  pause() {\n    this._isUserPaused = !0, this._proxy.pauseStream();\n  }\n\n  resume() {\n    this._isUserPaused = !1, this._proxy.resumeStream();\n  }\n\n  on(e, t) {\n    if (Array.isArray(e)) return r(e.map(e => this.on(e, t)));\n    const s = [\"data-received\", \"message-received\"].includes(e);\n    s && (this._enabledEventTypes.add(e), this._proxy.enableEvent(e, !0));\n    const o = super.on(e, t),\n          i = this;\n    return {\n      remove() {\n        o.remove(), s && (i._proxy.closed || i.hasEventListener(e) || i._proxy.enableEvent(e, !1));\n      }\n\n    };\n  }\n\n  queryLatestObservations(e, r) {\n    if (!(this.layer.timeInfo?.endField || this.layer.timeInfo?.startField || this.layer.timeInfo?.trackIdField)) throw new t(\"streamlayer-no-timeField\", \"queryLatestObservation can only be used with services that define a TrackIdField\");\n    return this._proxy.queryLatestObservations(this._cleanUpQuery(e), r).then(e => {\n      const t = c.fromJSON(e);\n      return t.features.forEach(e => {\n        e.layer = this.layer, e.sourceLayer = this.layer;\n      }), t;\n    });\n  }\n\n  detach() {\n    super.detach(), this.connectionStatus = \"disconnected\";\n  }\n\n  _createClientOptions() {\n    return { ...super._createClientOptions(),\n      setProperty: e => {\n        this.set(e.propertyName, e.value);\n      }\n    };\n  }\n\n  _createTileRendererHash(e) {\n    const t = `${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(u(this.layer.definitionExpression, this.layer.geometryDefinition))})`;\n    return super._createTileRendererHash(e) + t;\n  }\n\n  _createServiceOptions() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const e = _this.layer,\n            {\n        objectIdField: t\n      } = e,\n            r = e.fields.map(e => e.toJSON()),\n            s = l(e.geometryType),\n            o = e.timeInfo && e.timeInfo.toJSON() || null,\n            i = e.spatialReference ? e.spatialReference.toJSON() : null;\n      return {\n        type: \"stream\",\n        fields: r,\n        geometryType: s,\n        objectIdField: t,\n        timeInfo: o,\n        source: _this.layer.parsedUrl,\n        serviceFilter: u(_this.layer.definitionExpression, _this.layer.geometryDefinition),\n        purgeOptions: _this.layer.purgeOptions.toJSON(),\n        enabledEventTypes: Array.from(_this._enabledEventTypes.values()),\n        spatialReference: i,\n        maxReconnectionAttempts: _this.layer.maxReconnectionAttempts,\n        maxReconnectionInterval: _this.layer.maxReconnectionInterval,\n        updateInterval: _this.layer.updateInterval,\n        customParameters: e.customParameters\n      };\n    })();\n  }\n\n};\ne([n()], m.prototype, \"errorString\", void 0), e([n({\n  readOnly: !0\n})], m.prototype, \"connectionError\", null), e([n()], m.prototype, \"connectionStatus\", void 0), m = e([a(\"esri.views.2d.layers.StreamLayerView2D\")], m);\nconst y = m;\nexport { y as default };","map":{"version":3,"names":["_","e","t","handlesGroup","r","isNone","s","isSome","o","watch","i","property","n","subclass","a","c","p","toJSONGeometryType","l","u","geometry","toJSON","where","m","constructor","arguments","_enabledEventTypes","Set","_isUserPaused","errorString","connectionStatus","initialize","addHandles","layer","customParameters","_proxy","updateCustomParameters","on","sendMessageToSocket","sendMessageToClient","purgeOptions","_update","suspended","pauseStream","resumeStream","connectionError","pause","resume","Array","isArray","map","includes","add","enableEvent","remove","closed","hasEventListener","queryLatestObservations","timeInfo","endField","startField","trackIdField","_cleanUpQuery","then","fromJSON","features","forEach","sourceLayer","detach","_createClientOptions","setProperty","set","propertyName","value","_createTileRendererHash","JSON","stringify","definitionExpression","geometryDefinition","_createServiceOptions","objectIdField","fields","geometryType","spatialReference","type","source","parsedUrl","serviceFilter","enabledEventTypes","from","values","maxReconnectionAttempts","maxReconnectionInterval","updateInterval","prototype","readOnly","y","default"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/views/2d/layers/StreamLayerView2D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{handlesGroup as r}from\"../../../core/handleUtils.js\";import{isNone as s,isSome as o}from\"../../../core/maybe.js\";import{watch as i}from\"../../../core/reactiveUtils.js\";import{property as n}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import c from\"../../../rest/support/FeatureSet.js\";import p from\"./FeatureLayerView2D.js\";import{toJSONGeometryType as l}from\"./support/util.js\";function u(e,t){if(s(e)&&s(t))return null;const r={};return o(t)&&(r.geometry=t.toJSON()),o(e)&&(r.where=e),r}let m=class extends p{constructor(){super(...arguments),this._enabledEventTypes=new Set,this._isUserPaused=!1,this.errorString=null,this.connectionStatus=\"disconnected\"}initialize(){this.addHandles([i((()=>this.layer.customParameters),(e=>this._proxy.updateCustomParameters(e))),this.layer.on(\"send-message-to-socket\",(e=>this._proxy.sendMessageToSocket(e))),this.layer.on(\"send-message-to-client\",(e=>this._proxy.sendMessageToClient(e))),i((()=>this.layer.purgeOptions),(()=>this._update())),i((()=>this.suspended),(e=>{e?this._proxy.pauseStream():this._isUserPaused||this._proxy.resumeStream()}))],\"constructor\")}get connectionError(){if(this.errorString)return new t(\"stream-controller\",this.errorString)}pause(){this._isUserPaused=!0,this._proxy.pauseStream()}resume(){this._isUserPaused=!1,this._proxy.resumeStream()}on(e,t){if(Array.isArray(e))return r(e.map((e=>this.on(e,t))));const s=[\"data-received\",\"message-received\"].includes(e);s&&(this._enabledEventTypes.add(e),this._proxy.enableEvent(e,!0));const o=super.on(e,t),i=this;return{remove(){o.remove(),s&&(i._proxy.closed||i.hasEventListener(e)||i._proxy.enableEvent(e,!1))}}}queryLatestObservations(e,r){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new t(\"streamlayer-no-timeField\",\"queryLatestObservation can only be used with services that define a TrackIdField\");return this._proxy.queryLatestObservations(this._cleanUpQuery(e),r).then((e=>{const t=c.fromJSON(e);return t.features.forEach((e=>{e.layer=this.layer,e.sourceLayer=this.layer})),t}))}detach(){super.detach(),this.connectionStatus=\"disconnected\"}_createClientOptions(){return{...super._createClientOptions(),setProperty:e=>{this.set(e.propertyName,e.value)}}}_createTileRendererHash(e){const t=`${JSON.stringify(this.layer.purgeOptions)}.${JSON.stringify(u(this.layer.definitionExpression,this.layer.geometryDefinition))})`;return super._createTileRendererHash(e)+t}async _createServiceOptions(){const e=this.layer,{objectIdField:t}=e,r=e.fields.map((e=>e.toJSON())),s=l(e.geometryType),o=e.timeInfo&&e.timeInfo.toJSON()||null,i=e.spatialReference?e.spatialReference.toJSON():null;return{type:\"stream\",fields:r,geometryType:s,objectIdField:t,timeInfo:o,source:this.layer.parsedUrl,serviceFilter:u(this.layer.definitionExpression,this.layer.geometryDefinition),purgeOptions:this.layer.purgeOptions.toJSON(),enabledEventTypes:Array.from(this._enabledEventTypes.values()),spatialReference:i,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,updateInterval:this.layer.updateInterval,customParameters:e.customParameters}}};e([n()],m.prototype,\"errorString\",void 0),e([n({readOnly:!0})],m.prototype,\"connectionError\",null),e([n()],m.prototype,\"connectionStatus\",void 0),m=e([a(\"esri.views.2d.layers.StreamLayerView2D\")],m);const y=m;export{y as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}