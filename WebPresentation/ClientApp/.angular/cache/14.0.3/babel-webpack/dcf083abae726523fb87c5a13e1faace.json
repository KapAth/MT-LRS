{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from \"../../../../../core/Error.js\";\nimport t from \"../../../../../core/Logger.js\";\nimport { isSome as r } from \"../../../../../core/maybe.js\";\nimport { isAbortError as a, throwIfAborted as s, throwIfNotAbortError as i } from \"../../../../../core/promiseUtils.js\";\nimport { BaseFeatureSource as o } from \"./BaseFeatureSource.js\";\n\nclass n extends o {\n  constructor(e) {\n    super(e);\n  }\n\n  _fetchDataTile(r) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const i = 6,\n            o = 20,\n            n = _this._subscriptions.get(r.key.id);\n\n      let d = !1,\n          c = 0,\n          u = 0;\n\n      const p = (e, t) => {\n        u--, s(n);\n        const a = r.id,\n              i = e.reader,\n              o = e.query;\n\n        if (!i.exceededTransferLimit) {\n          if (d = !0, 0 !== t && !i.hasFeatures) {\n            const e = {\n              id: a,\n              addOrUpdate: i,\n              end: 0 === u,\n              type: \"append\"\n            };\n            return n.add({\n              message: e,\n              query: o\n            }), void _this._onMessage(e);\n          }\n\n          const e = {\n            id: a,\n            addOrUpdate: i,\n            end: 0 === u,\n            type: \"append\"\n          };\n          return n.add({\n            message: e,\n            query: o\n          }), void _this._onMessage(e);\n        }\n\n        const c = {\n          id: a,\n          addOrUpdate: i,\n          end: d && 0 === u,\n          type: \"append\"\n        };\n        n.add({\n          message: c,\n          query: o\n        }), _this._onMessage(c);\n      };\n\n      let h = 0,\n          m = 0;\n\n      for (; !d && m++ < o;) {\n        let o;\n\n        for (let s = 0; s < h + 1; s++) {\n          const s = c++;\n          u++, o = _this._fetchDataTilePage(r, s, n).then(e => e && p(e, s)).catch(s => {\n            d = !0, a(s) || (t.getLogger(\"esri.views.2d.layers.features.sources.PagedFeatureSource\").error(new e(\"mapview-query-error\", \"Encountered error when fetching tile\", {\n              tile: r,\n              error: s\n            })), _this._onMessage({\n              id: r.id,\n              addOrUpdate: null,\n              end: d,\n              type: \"append\"\n            }));\n          });\n        }\n\n        yield o, s(n), h = Math.min(h + 2, i);\n      }\n    })();\n  }\n\n  _fetchDataTilePage(e, t, a) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      s(a);\n      const o = _this2._queryInfo,\n            n = {\n        start: _this2.pageSize * t,\n        num: _this2.pageSize,\n        returnExceededLimitFeatures: !0,\n        quantizationParameters: e.getQuantizationParameters()\n      };\n      r(_this2.maxRecordCountFactor) && (n.maxRecordCountFactor = _this2.maxRecordCountFactor);\n\n      const d = _this2.createTileQuery(e, n);\n\n      try {\n        const r = a.signal,\n              i = yield _this2._queue.push({\n          tile: e,\n          query: d,\n          signal: r,\n          depth: t\n        });\n        return s(a), i ? o !== _this2._queryInfo ? _this2._fetchDataTilePage(e, t, a) : {\n          reader: i,\n          query: d\n        } : null;\n      } catch (c) {\n        return i(c), null;\n      }\n    })();\n  }\n\n}\n\nexport { n as PagedFeatureSource };","map":{"version":3,"names":["e","t","isSome","r","isAbortError","a","throwIfAborted","s","throwIfNotAbortError","i","BaseFeatureSource","o","n","constructor","_fetchDataTile","_subscriptions","get","key","id","d","c","u","p","reader","query","exceededTransferLimit","hasFeatures","addOrUpdate","end","type","add","message","_onMessage","h","m","_fetchDataTilePage","then","catch","getLogger","error","tile","Math","min","_queryInfo","start","pageSize","num","returnExceededLimitFeatures","quantizationParameters","getQuantizationParameters","maxRecordCountFactor","createTileQuery","signal","_queue","push","depth","PagedFeatureSource"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/views/2d/layers/features/sources/PagedFeatureSource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport e from\"../../../../../core/Error.js\";import t from\"../../../../../core/Logger.js\";import{isSome as r}from\"../../../../../core/maybe.js\";import{isAbortError as a,throwIfAborted as s,throwIfNotAbortError as i}from\"../../../../../core/promiseUtils.js\";import{BaseFeatureSource as o}from\"./BaseFeatureSource.js\";class n extends o{constructor(e){super(e)}async _fetchDataTile(r){const i=6,o=20,n=this._subscriptions.get(r.key.id);let d=!1,c=0,u=0;const p=(e,t)=>{u--,s(n);const a=r.id,i=e.reader,o=e.query;if(!i.exceededTransferLimit){if(d=!0,0!==t&&!i.hasFeatures){const e={id:a,addOrUpdate:i,end:0===u,type:\"append\"};return n.add({message:e,query:o}),void this._onMessage(e)}const e={id:a,addOrUpdate:i,end:0===u,type:\"append\"};return n.add({message:e,query:o}),void this._onMessage(e)}const c={id:a,addOrUpdate:i,end:d&&0===u,type:\"append\"};n.add({message:c,query:o}),this._onMessage(c)};let h=0,m=0;for(;!d&&m++<o;){let o;for(let s=0;s<h+1;s++){const s=c++;u++,o=this._fetchDataTilePage(r,s,n).then((e=>e&&p(e,s))).catch((s=>{d=!0,a(s)||(t.getLogger(\"esri.views.2d.layers.features.sources.PagedFeatureSource\").error(new e(\"mapview-query-error\",\"Encountered error when fetching tile\",{tile:r,error:s})),this._onMessage({id:r.id,addOrUpdate:null,end:d,type:\"append\"}))}))}await o,s(n),h=Math.min(h+2,i)}}async _fetchDataTilePage(e,t,a){s(a);const o=this._queryInfo,n={start:this.pageSize*t,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:e.getQuantizationParameters()};r(this.maxRecordCountFactor)&&(n.maxRecordCountFactor=this.maxRecordCountFactor);const d=this.createTileQuery(e,n);try{const r=a.signal,i=await this._queue.push({tile:e,query:d,signal:r,depth:t});return s(a),i?o!==this._queryInfo?this._fetchDataTilePage(e,t,a):{reader:i,query:d}:null}catch(c){return i(c),null}}}export{n as PagedFeatureSource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}