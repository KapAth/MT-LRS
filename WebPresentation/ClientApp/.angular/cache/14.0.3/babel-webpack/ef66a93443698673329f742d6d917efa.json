{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { neverReached as t } from \"../../../../core/compilerUtils.js\";\nimport e from \"../../../../core/Error.js\";\nimport r from \"../../../../core/Evented.js\";\nimport { isPowerOfTwo as s, nextHighestPowerOfTwo as i } from \"../../../../core/mathUtils.js\";\nimport { isNone as a, isSome as o, removeMaybe as n } from \"../../../../core/maybe.js\";\nimport { throwIfAborted as h, onAbort as l, createAbortError as m } from \"../../../../core/promiseUtils.js\";\nimport { isArrayBuffer as p, isUint8Array as d } from \"../../../../core/typedArrayUtil.js\";\nimport { isBlobProtocol as _, isDataProtocol as c } from \"../../../../core/urlUtils.js\";\nimport { requestImage as u } from \"../../../../support/requestImageUtils.js\";\nimport { loadImageAsync as T } from \"../../../../support/requestUtils.js\";\nimport { T as g } from \"../../../../chunks/TextureOnly.glsl.js\";\nimport { PowerOfTwoResizeMode as f, TextureEncodingMimeType as w } from \"./basicInterfaces.js\";\nimport { estimateMemoryKTX2 as E, estimateMemoryBasis as A, createTextureKTX2 as x, createTextureBasis as D } from \"./BasisUtil.js\";\nimport { ContentObject as M } from \"./ContentObject.js\";\nimport { ContentObjectType as y } from \"./ContentObjectType.js\";\nimport { createDDSTexture as I } from \"./DDSUtil.js\";\nimport { createQuadVAO as F } from \"./glUtil3D.js\";\nimport { assert as O } from \"./Util.js\";\nimport { ContextType as R } from \"../../../webgl/context-util.js\";\nimport { TextureWrapMode as U, TextureType as P, PixelFormat as N, PixelType as b, TextureSamplingMode as C, TargetType as H, DepthStencilTargetType as V, PrimitiveType as v } from \"../../../webgl/enums.js\";\nimport { FramebufferObject as S } from \"../../../webgl/FramebufferObject.js\";\nimport { Texture as j } from \"../../../webgl/Texture.js\";\nimport { vertexCount as L } from \"../../../webgl/Util.js\";\n\nclass G extends M {\n  constructor(t, e) {\n    super(), this._data = t, this.type = y.Texture, this._glTexture = null, this._powerOfTwoStretchInfo = null, this._loadingPromise = null, this._loadingController = null, this.events = new r(), this._passParameters = new g(), this.params = e || {}, this.params.mipmap = !1 !== this.params.mipmap, this.params.noUnpackFlip = this.params.noUnpackFlip || !1, this.params.preMultiplyAlpha = this.params.preMultiplyAlpha || !1, this.params.wrap = this.params.wrap || {\n      s: U.REPEAT,\n      t: U.REPEAT\n    }, this.params.powerOfTwoResizeMode = this.params.powerOfTwoResizeMode || f.STRETCH, this.estimatedTexMemRequired = G._estimateTexMemRequired(this._data, this.params), this._startPreload();\n  }\n\n  _startPreload() {\n    const t = this._data;\n    a(t) || (t instanceof HTMLVideoElement ? this._startPreloadVideoElement(t) : t instanceof HTMLImageElement && this._startPreloadImageElement(t));\n  }\n\n  _startPreloadVideoElement(t) {\n    if (!(_(t.src) || \"auto\" === t.preload && t.crossOrigin)) {\n      t.preload = \"auto\", t.crossOrigin = \"anonymous\";\n      const e = !t.paused;\n\n      if (t.src = t.src, e && t.autoplay) {\n        const e = () => {\n          t.removeEventListener(\"canplay\", e), t.play();\n        };\n\n        t.addEventListener(\"canplay\", e);\n      }\n    }\n  }\n\n  _startPreloadImageElement(t) {\n    c(t.src) || _(t.src) || t.crossOrigin || (t.crossOrigin = \"anonymous\", t.src = t.src);\n  }\n\n  static _getDataDimensions(t) {\n    return t instanceof HTMLVideoElement ? {\n      width: t.videoWidth,\n      height: t.videoHeight\n    } : t;\n  }\n\n  static _estimateTexMemRequired(t, e) {\n    if (a(t)) return 0;\n    if (p(t) || d(t)) return e.encoding === w.KTX2_ENCODING ? E(t, !!e.mipmap) : e.encoding === w.BASIS_ENCODING ? A(t, !!e.mipmap) : t.byteLength;\n    const {\n      width: r,\n      height: s\n    } = t instanceof Image || t instanceof ImageData || t instanceof HTMLCanvasElement || t instanceof HTMLVideoElement ? G._getDataDimensions(t) : e;\n    return (e.mipmap ? 4 / 3 : 1) * r * s * (e.components || 4) || 0;\n  }\n\n  dispose() {\n    this._data = void 0;\n  }\n\n  get width() {\n    return this.params.width;\n  }\n\n  get height() {\n    return this.params.height;\n  }\n\n  _createDescriptor(t) {\n    return {\n      target: P.TEXTURE_2D,\n      pixelFormat: N.RGBA,\n      dataType: b.UNSIGNED_BYTE,\n      wrapMode: this.params.wrap,\n      flipped: !this.params.noUnpackFlip,\n      samplingMode: this.params.mipmap ? C.LINEAR_MIPMAP_LINEAR : C.LINEAR,\n      hasMipmap: this.params.mipmap,\n      preMultiplyAlpha: this.params.preMultiplyAlpha,\n      maxAnisotropy: this.params.maxAnisotropy ?? (this.params.mipmap ? t.parameters.maxMaxAnisotropy : 1)\n    };\n  }\n\n  get glTexture() {\n    return this._glTexture;\n  }\n\n  load(t, e) {\n    if (o(this._glTexture)) return this._glTexture;\n    if (o(this._loadingPromise)) return this._loadingPromise;\n    const r = this._data;\n    return a(r) ? (this._glTexture = new j(t, this._createDescriptor(t), null), this._glTexture) : \"string\" == typeof r ? this._loadFromURL(t, e, r) : r instanceof Image ? this._loadFromImageElement(t, e, r) : r instanceof HTMLVideoElement ? this._loadFromVideoElement(t, e, r) : r instanceof ImageData || r instanceof HTMLCanvasElement ? this._loadFromImage(t, r, e) : (p(r) || d(r)) && this.params.encoding === w.DDS_ENCODING ? (this._data = void 0, this._loadFromDDSData(t, r)) : (p(r) || d(r)) && this.params.encoding === w.KTX2_ENCODING ? (this._data = void 0, this._loadFromKTX2(t, r)) : (p(r) || d(r)) && this.params.encoding === w.BASIS_ENCODING ? (this._data = void 0, this._loadFromBasis(t, r)) : d(r) ? this._loadFromPixelData(t, r) : p(r) ? this._loadFromPixelData(t, new Uint8Array(r)) : null;\n  }\n\n  get requiresFrameUpdates() {\n    return this._data instanceof HTMLVideoElement;\n  }\n\n  frameUpdate(t, e, r) {\n    if (!(this._data instanceof HTMLVideoElement) || a(this._glTexture)) return r;\n    if (this._data.readyState < B.HAVE_CURRENT_DATA || r === this._data.currentTime) return r;\n\n    if (o(this._powerOfTwoStretchInfo)) {\n      const {\n        framebuffer: r,\n        vao: s,\n        sourceTexture: i\n      } = this._powerOfTwoStretchInfo;\n      i.setData(this._data), this._drawStretchedTexture(t, e, r, s, i, this._glTexture);\n    } else {\n      const {\n        videoWidth: t,\n        videoHeight: e\n      } = this._data,\n            {\n        width: r,\n        height: s\n      } = this._glTexture.descriptor;\n      t !== r || e !== s ? this._glTexture.updateData(0, 0, 0, Math.min(t, r), Math.min(e, s), this._data) : this._glTexture.setData(this._data);\n    }\n\n    return this._glTexture.descriptor.hasMipmap && this._glTexture.generateMipmap(), this.params.updateCallback && this.params.updateCallback(), this._data.currentTime;\n  }\n\n  _loadFromDDSData(t, e) {\n    return this._glTexture = I(t, this._createDescriptor(t), e), this._glTexture;\n  }\n\n  _loadFromKTX2(t, e) {\n    return this._loadAsync(() => x(t, this._createDescriptor(t), e).then(t => (this._glTexture = t, t)));\n  }\n\n  _loadFromBasis(t, e) {\n    return this._loadAsync(() => D(t, this._createDescriptor(t), e).then(t => (this._glTexture = t, t)));\n  }\n\n  _loadFromPixelData(t, e) {\n    O(this.params.width > 0 && this.params.height > 0);\n\n    const r = this._createDescriptor(t);\n\n    return r.pixelFormat = 1 === this.params.components ? N.LUMINANCE : 3 === this.params.components ? N.RGB : N.RGBA, r.width = this.params.width, r.height = this.params.height, this._glTexture = new j(t, r, e), this._glTexture;\n  }\n\n  _loadFromURL(t, e, r) {\n    var _this = this;\n\n    return this._loadAsync( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (s) {\n        const i = yield u(r, {\n          signal: s\n        });\n        return h(s), _this._loadFromImage(t, i, e);\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  _loadFromImageElement(t, e, r) {\n    var _this2 = this;\n\n    return r.complete ? this._loadFromImage(t, r, e) : this._loadAsync( /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* (s) {\n        const i = yield T(r, r.src, !1, s);\n        return h(s), _this2._loadFromImage(t, i, e);\n      });\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n  }\n\n  _loadFromVideoElement(t, e, r) {\n    return r.readyState >= B.HAVE_CURRENT_DATA ? this._loadFromImage(t, r, e) : this._loadFromVideoElementAsync(t, e, r);\n  }\n\n  _loadFromVideoElementAsync(t, r, s) {\n    return this._loadAsync(i => new Promise((a, o) => {\n      const h = () => {\n        s.removeEventListener(\"loadeddata\", p), s.removeEventListener(\"error\", d), n(_);\n      },\n            p = () => {\n        s.readyState >= B.HAVE_CURRENT_DATA && (h(), a(this._loadFromImage(t, s, r)));\n      },\n            d = t => {\n        h(), o(t || new e(\"Failed to load video\"));\n      };\n\n      s.addEventListener(\"loadeddata\", p), s.addEventListener(\"error\", d);\n\n      const _ = l(i, () => d(m()));\n    }));\n  }\n\n  _loadFromImage(t, e, r) {\n    const i = G._getDataDimensions(e);\n\n    this.params.width = i.width, this.params.height = i.height;\n\n    const a = this._createDescriptor(t);\n\n    return a.pixelFormat = 3 === this.params.components ? N.RGB : N.RGBA, !this._requiresPowerOfTwo(t, a) || s(i.width) && s(i.height) ? (a.width = i.width, a.height = i.height, this._glTexture = new j(t, a, e), this._glTexture) : (this._glTexture = this._makePowerOfTwoTexture(t, e, i, a, r), this._glTexture);\n  }\n\n  _loadAsync(t) {\n    const e = new AbortController();\n    this._loadingController = e;\n    const r = t(e.signal);\n    this._loadingPromise = r;\n\n    const s = () => {\n      this._loadingController === e && (this._loadingController = null), this._loadingPromise === r && (this._loadingPromise = null);\n    };\n\n    return r.then(s, s), r;\n  }\n\n  _requiresPowerOfTwo(t, e) {\n    const r = U.CLAMP_TO_EDGE,\n          s = \"number\" == typeof e.wrapMode ? e.wrapMode === r : e.wrapMode.s === r && e.wrapMode.t === r;\n    return t.type === R.WEBGL1 && (e.hasMipmap || !s);\n  }\n\n  _makePowerOfTwoTexture(e, r, s, a, o) {\n    const {\n      width: n,\n      height: h\n    } = s,\n          l = i(n),\n          m = i(h);\n    let p;\n\n    switch (a.width = l, a.height = m, this.params.powerOfTwoResizeMode) {\n      case f.PAD:\n        a.textureCoordinateScaleFactor = [n / l, h / m], p = new j(e, a), p.updateData(0, 0, 0, n, h, r);\n        break;\n\n      case f.STRETCH:\n      case null:\n      case void 0:\n        p = this._stretchToPowerOfTwo(e, r, a, o());\n        break;\n\n      default:\n        t(this.params.powerOfTwoResizeMode);\n    }\n\n    return a.hasMipmap && p.generateMipmap(), p;\n  }\n\n  _stretchToPowerOfTwo(t, e, r, s) {\n    const i = new j(t, r),\n          a = new S(t, {\n      colorTarget: H.TEXTURE,\n      depthStencilTarget: V.NONE\n    }, i),\n          o = new j(t, {\n      target: P.TEXTURE_2D,\n      pixelFormat: r.pixelFormat,\n      dataType: b.UNSIGNED_BYTE,\n      wrapMode: U.CLAMP_TO_EDGE,\n      samplingMode: C.LINEAR,\n      flipped: !!r.flipped,\n      maxAnisotropy: 8,\n      preMultiplyAlpha: r.preMultiplyAlpha\n    }, e),\n          n = F(t),\n          h = t.getBoundFramebufferObject();\n    return this._drawStretchedTexture(t, s, a, n, o, i), this.requiresFrameUpdates ? this._powerOfTwoStretchInfo = {\n      vao: n,\n      sourceTexture: o,\n      framebuffer: a\n    } : (n.dispose(!0), o.dispose(), a.detachColorTexture(), a.dispose()), t.bindFramebuffer(h), i;\n  }\n\n  _drawStretchedTexture(t, e, r, s, i, a) {\n    this._passParameters.texture = i, t.bindFramebuffer(r);\n    const o = t.getViewport();\n    t.setViewport(0, 0, a.descriptor.width, a.descriptor.height), t.bindTechnique(e, this._passParameters, null), t.bindVAO(s), t.drawArrays(v.TRIANGLE_STRIP, 0, L(s, \"geometry\")), t.bindFramebuffer(null), t.setViewport(o.x, o.y, o.width, o.height), this._passParameters.texture = null;\n  }\n\n  unload() {\n    if (o(this._powerOfTwoStretchInfo)) {\n      const {\n        framebuffer: t,\n        vao: e,\n        sourceTexture: r\n      } = this._powerOfTwoStretchInfo;\n      e.dispose(!0), r.dispose(), t.dispose(), this._glTexture = null, this._powerOfTwoStretchInfo = null;\n    }\n\n    if (o(this._glTexture) && (this._glTexture.dispose(), this._glTexture = null), o(this._loadingController)) {\n      const t = this._loadingController;\n      this._loadingController = null, this._loadingPromise = null, t.abort();\n    }\n\n    this.events.emit(\"unloaded\");\n  }\n\n}\n\nvar B;\n!function (t) {\n  t[t.HAVE_NOTHING = 0] = \"HAVE_NOTHING\", t[t.HAVE_METADATA = 1] = \"HAVE_METADATA\", t[t.HAVE_CURRENT_DATA = 2] = \"HAVE_CURRENT_DATA\", t[t.HAVE_FUTURE_DATA = 3] = \"HAVE_FUTURE_DATA\", t[t.HAVE_ENOUGH_DATA = 4] = \"HAVE_ENOUGH_DATA\";\n}(B || (B = {}));\nexport { G as Texture };","map":{"version":3,"names":["neverReached","t","e","r","isPowerOfTwo","s","nextHighestPowerOfTwo","i","isNone","a","isSome","o","removeMaybe","n","throwIfAborted","h","onAbort","l","createAbortError","m","isArrayBuffer","p","isUint8Array","d","isBlobProtocol","_","isDataProtocol","c","requestImage","u","loadImageAsync","T","g","PowerOfTwoResizeMode","f","TextureEncodingMimeType","w","estimateMemoryKTX2","E","estimateMemoryBasis","A","createTextureKTX2","x","createTextureBasis","D","ContentObject","M","ContentObjectType","y","createDDSTexture","I","createQuadVAO","F","assert","O","ContextType","R","TextureWrapMode","U","TextureType","P","PixelFormat","N","PixelType","b","TextureSamplingMode","C","TargetType","H","DepthStencilTargetType","V","PrimitiveType","v","FramebufferObject","S","Texture","j","vertexCount","L","G","constructor","_data","type","_glTexture","_powerOfTwoStretchInfo","_loadingPromise","_loadingController","events","_passParameters","params","mipmap","noUnpackFlip","preMultiplyAlpha","wrap","REPEAT","powerOfTwoResizeMode","STRETCH","estimatedTexMemRequired","_estimateTexMemRequired","_startPreload","HTMLVideoElement","_startPreloadVideoElement","HTMLImageElement","_startPreloadImageElement","src","preload","crossOrigin","paused","autoplay","removeEventListener","play","addEventListener","_getDataDimensions","width","videoWidth","height","videoHeight","encoding","KTX2_ENCODING","BASIS_ENCODING","byteLength","Image","ImageData","HTMLCanvasElement","components","dispose","_createDescriptor","target","TEXTURE_2D","pixelFormat","RGBA","dataType","UNSIGNED_BYTE","wrapMode","flipped","samplingMode","LINEAR_MIPMAP_LINEAR","LINEAR","hasMipmap","maxAnisotropy","parameters","maxMaxAnisotropy","glTexture","load","_loadFromURL","_loadFromImageElement","_loadFromVideoElement","_loadFromImage","DDS_ENCODING","_loadFromDDSData","_loadFromKTX2","_loadFromBasis","_loadFromPixelData","Uint8Array","requiresFrameUpdates","frameUpdate","readyState","B","HAVE_CURRENT_DATA","currentTime","framebuffer","vao","sourceTexture","setData","_drawStretchedTexture","descriptor","updateData","Math","min","generateMipmap","updateCallback","_loadAsync","then","LUMINANCE","RGB","signal","complete","_loadFromVideoElementAsync","Promise","_requiresPowerOfTwo","_makePowerOfTwoTexture","AbortController","CLAMP_TO_EDGE","WEBGL1","PAD","textureCoordinateScaleFactor","_stretchToPowerOfTwo","colorTarget","TEXTURE","depthStencilTarget","NONE","getBoundFramebufferObject","detachColorTexture","bindFramebuffer","texture","getViewport","setViewport","bindTechnique","bindVAO","drawArrays","TRIANGLE_STRIP","unload","abort","emit","HAVE_NOTHING","HAVE_METADATA","HAVE_FUTURE_DATA","HAVE_ENOUGH_DATA"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/views/3d/webgl-engine/lib/Texture.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{neverReached as t}from\"../../../../core/compilerUtils.js\";import e from\"../../../../core/Error.js\";import r from\"../../../../core/Evented.js\";import{isPowerOfTwo as s,nextHighestPowerOfTwo as i}from\"../../../../core/mathUtils.js\";import{isNone as a,isSome as o,removeMaybe as n}from\"../../../../core/maybe.js\";import{throwIfAborted as h,onAbort as l,createAbortError as m}from\"../../../../core/promiseUtils.js\";import{isArrayBuffer as p,isUint8Array as d}from\"../../../../core/typedArrayUtil.js\";import{isBlobProtocol as _,isDataProtocol as c}from\"../../../../core/urlUtils.js\";import{requestImage as u}from\"../../../../support/requestImageUtils.js\";import{loadImageAsync as T}from\"../../../../support/requestUtils.js\";import{T as g}from\"../../../../chunks/TextureOnly.glsl.js\";import{PowerOfTwoResizeMode as f,TextureEncodingMimeType as w}from\"./basicInterfaces.js\";import{estimateMemoryKTX2 as E,estimateMemoryBasis as A,createTextureKTX2 as x,createTextureBasis as D}from\"./BasisUtil.js\";import{ContentObject as M}from\"./ContentObject.js\";import{ContentObjectType as y}from\"./ContentObjectType.js\";import{createDDSTexture as I}from\"./DDSUtil.js\";import{createQuadVAO as F}from\"./glUtil3D.js\";import{assert as O}from\"./Util.js\";import{ContextType as R}from\"../../../webgl/context-util.js\";import{TextureWrapMode as U,TextureType as P,PixelFormat as N,PixelType as b,TextureSamplingMode as C,TargetType as H,DepthStencilTargetType as V,PrimitiveType as v}from\"../../../webgl/enums.js\";import{FramebufferObject as S}from\"../../../webgl/FramebufferObject.js\";import{Texture as j}from\"../../../webgl/Texture.js\";import{vertexCount as L}from\"../../../webgl/Util.js\";class G extends M{constructor(t,e){super(),this._data=t,this.type=y.Texture,this._glTexture=null,this._powerOfTwoStretchInfo=null,this._loadingPromise=null,this._loadingController=null,this.events=new r,this._passParameters=new g,this.params=e||{},this.params.mipmap=!1!==this.params.mipmap,this.params.noUnpackFlip=this.params.noUnpackFlip||!1,this.params.preMultiplyAlpha=this.params.preMultiplyAlpha||!1,this.params.wrap=this.params.wrap||{s:U.REPEAT,t:U.REPEAT},this.params.powerOfTwoResizeMode=this.params.powerOfTwoResizeMode||f.STRETCH,this.estimatedTexMemRequired=G._estimateTexMemRequired(this._data,this.params),this._startPreload()}_startPreload(){const t=this._data;a(t)||(t instanceof HTMLVideoElement?this._startPreloadVideoElement(t):t instanceof HTMLImageElement&&this._startPreloadImageElement(t))}_startPreloadVideoElement(t){if(!(_(t.src)||\"auto\"===t.preload&&t.crossOrigin)){t.preload=\"auto\",t.crossOrigin=\"anonymous\";const e=!t.paused;if(t.src=t.src,e&&t.autoplay){const e=()=>{t.removeEventListener(\"canplay\",e),t.play()};t.addEventListener(\"canplay\",e)}}}_startPreloadImageElement(t){c(t.src)||_(t.src)||t.crossOrigin||(t.crossOrigin=\"anonymous\",t.src=t.src)}static _getDataDimensions(t){return t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t}static _estimateTexMemRequired(t,e){if(a(t))return 0;if(p(t)||d(t))return e.encoding===w.KTX2_ENCODING?E(t,!!e.mipmap):e.encoding===w.BASIS_ENCODING?A(t,!!e.mipmap):t.byteLength;const{width:r,height:s}=t instanceof Image||t instanceof ImageData||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement?G._getDataDimensions(t):e;return(e.mipmap?4/3:1)*r*s*(e.components||4)||0}dispose(){this._data=void 0}get width(){return this.params.width}get height(){return this.params.height}_createDescriptor(t){return{target:P.TEXTURE_2D,pixelFormat:N.RGBA,dataType:b.UNSIGNED_BYTE,wrapMode:this.params.wrap,flipped:!this.params.noUnpackFlip,samplingMode:this.params.mipmap?C.LINEAR_MIPMAP_LINEAR:C.LINEAR,hasMipmap:this.params.mipmap,preMultiplyAlpha:this.params.preMultiplyAlpha,maxAnisotropy:this.params.maxAnisotropy??(this.params.mipmap?t.parameters.maxMaxAnisotropy:1)}}get glTexture(){return this._glTexture}load(t,e){if(o(this._glTexture))return this._glTexture;if(o(this._loadingPromise))return this._loadingPromise;const r=this._data;return a(r)?(this._glTexture=new j(t,this._createDescriptor(t),null),this._glTexture):\"string\"==typeof r?this._loadFromURL(t,e,r):r instanceof Image?this._loadFromImageElement(t,e,r):r instanceof HTMLVideoElement?this._loadFromVideoElement(t,e,r):r instanceof ImageData||r instanceof HTMLCanvasElement?this._loadFromImage(t,r,e):(p(r)||d(r))&&this.params.encoding===w.DDS_ENCODING?(this._data=void 0,this._loadFromDDSData(t,r)):(p(r)||d(r))&&this.params.encoding===w.KTX2_ENCODING?(this._data=void 0,this._loadFromKTX2(t,r)):(p(r)||d(r))&&this.params.encoding===w.BASIS_ENCODING?(this._data=void 0,this._loadFromBasis(t,r)):d(r)?this._loadFromPixelData(t,r):p(r)?this._loadFromPixelData(t,new Uint8Array(r)):null}get requiresFrameUpdates(){return this._data instanceof HTMLVideoElement}frameUpdate(t,e,r){if(!(this._data instanceof HTMLVideoElement)||a(this._glTexture))return r;if(this._data.readyState<B.HAVE_CURRENT_DATA||r===this._data.currentTime)return r;if(o(this._powerOfTwoStretchInfo)){const{framebuffer:r,vao:s,sourceTexture:i}=this._powerOfTwoStretchInfo;i.setData(this._data),this._drawStretchedTexture(t,e,r,s,i,this._glTexture)}else{const{videoWidth:t,videoHeight:e}=this._data,{width:r,height:s}=this._glTexture.descriptor;t!==r||e!==s?this._glTexture.updateData(0,0,0,Math.min(t,r),Math.min(e,s),this._data):this._glTexture.setData(this._data)}return this._glTexture.descriptor.hasMipmap&&this._glTexture.generateMipmap(),this.params.updateCallback&&this.params.updateCallback(),this._data.currentTime}_loadFromDDSData(t,e){return this._glTexture=I(t,this._createDescriptor(t),e),this._glTexture}_loadFromKTX2(t,e){return this._loadAsync((()=>x(t,this._createDescriptor(t),e).then((t=>(this._glTexture=t,t)))))}_loadFromBasis(t,e){return this._loadAsync((()=>D(t,this._createDescriptor(t),e).then((t=>(this._glTexture=t,t)))))}_loadFromPixelData(t,e){O(this.params.width>0&&this.params.height>0);const r=this._createDescriptor(t);return r.pixelFormat=1===this.params.components?N.LUMINANCE:3===this.params.components?N.RGB:N.RGBA,r.width=this.params.width,r.height=this.params.height,this._glTexture=new j(t,r,e),this._glTexture}_loadFromURL(t,e,r){return this._loadAsync((async s=>{const i=await u(r,{signal:s});return h(s),this._loadFromImage(t,i,e)}))}_loadFromImageElement(t,e,r){return r.complete?this._loadFromImage(t,r,e):this._loadAsync((async s=>{const i=await T(r,r.src,!1,s);return h(s),this._loadFromImage(t,i,e)}))}_loadFromVideoElement(t,e,r){return r.readyState>=B.HAVE_CURRENT_DATA?this._loadFromImage(t,r,e):this._loadFromVideoElementAsync(t,e,r)}_loadFromVideoElementAsync(t,r,s){return this._loadAsync((i=>new Promise(((a,o)=>{const h=()=>{s.removeEventListener(\"loadeddata\",p),s.removeEventListener(\"error\",d),n(_)},p=()=>{s.readyState>=B.HAVE_CURRENT_DATA&&(h(),a(this._loadFromImage(t,s,r)))},d=t=>{h(),o(t||new e(\"Failed to load video\"))};s.addEventListener(\"loadeddata\",p),s.addEventListener(\"error\",d);const _=l(i,(()=>d(m())))}))))}_loadFromImage(t,e,r){const i=G._getDataDimensions(e);this.params.width=i.width,this.params.height=i.height;const a=this._createDescriptor(t);return a.pixelFormat=3===this.params.components?N.RGB:N.RGBA,!this._requiresPowerOfTwo(t,a)||s(i.width)&&s(i.height)?(a.width=i.width,a.height=i.height,this._glTexture=new j(t,a,e),this._glTexture):(this._glTexture=this._makePowerOfTwoTexture(t,e,i,a,r),this._glTexture)}_loadAsync(t){const e=new AbortController;this._loadingController=e;const r=t(e.signal);this._loadingPromise=r;const s=()=>{this._loadingController===e&&(this._loadingController=null),this._loadingPromise===r&&(this._loadingPromise=null)};return r.then(s,s),r}_requiresPowerOfTwo(t,e){const r=U.CLAMP_TO_EDGE,s=\"number\"==typeof e.wrapMode?e.wrapMode===r:e.wrapMode.s===r&&e.wrapMode.t===r;return t.type===R.WEBGL1&&(e.hasMipmap||!s)}_makePowerOfTwoTexture(e,r,s,a,o){const{width:n,height:h}=s,l=i(n),m=i(h);let p;switch(a.width=l,a.height=m,this.params.powerOfTwoResizeMode){case f.PAD:a.textureCoordinateScaleFactor=[n/l,h/m],p=new j(e,a),p.updateData(0,0,0,n,h,r);break;case f.STRETCH:case null:case void 0:p=this._stretchToPowerOfTwo(e,r,a,o());break;default:t(this.params.powerOfTwoResizeMode)}return a.hasMipmap&&p.generateMipmap(),p}_stretchToPowerOfTwo(t,e,r,s){const i=new j(t,r),a=new S(t,{colorTarget:H.TEXTURE,depthStencilTarget:V.NONE},i),o=new j(t,{target:P.TEXTURE_2D,pixelFormat:r.pixelFormat,dataType:b.UNSIGNED_BYTE,wrapMode:U.CLAMP_TO_EDGE,samplingMode:C.LINEAR,flipped:!!r.flipped,maxAnisotropy:8,preMultiplyAlpha:r.preMultiplyAlpha},e),n=F(t),h=t.getBoundFramebufferObject();return this._drawStretchedTexture(t,s,a,n,o,i),this.requiresFrameUpdates?this._powerOfTwoStretchInfo={vao:n,sourceTexture:o,framebuffer:a}:(n.dispose(!0),o.dispose(),a.detachColorTexture(),a.dispose()),t.bindFramebuffer(h),i}_drawStretchedTexture(t,e,r,s,i,a){this._passParameters.texture=i,t.bindFramebuffer(r);const o=t.getViewport();t.setViewport(0,0,a.descriptor.width,a.descriptor.height),t.bindTechnique(e,this._passParameters,null),t.bindVAO(s),t.drawArrays(v.TRIANGLE_STRIP,0,L(s,\"geometry\")),t.bindFramebuffer(null),t.setViewport(o.x,o.y,o.width,o.height),this._passParameters.texture=null}unload(){if(o(this._powerOfTwoStretchInfo)){const{framebuffer:t,vao:e,sourceTexture:r}=this._powerOfTwoStretchInfo;e.dispose(!0),r.dispose(),t.dispose(),this._glTexture=null,this._powerOfTwoStretchInfo=null}if(o(this._glTexture)&&(this._glTexture.dispose(),this._glTexture=null),o(this._loadingController)){const t=this._loadingController;this._loadingController=null,this._loadingPromise=null,t.abort()}this.events.emit(\"unloaded\")}}var B;!function(t){t[t.HAVE_NOTHING=0]=\"HAVE_NOTHING\",t[t.HAVE_METADATA=1]=\"HAVE_METADATA\",t[t.HAVE_CURRENT_DATA=2]=\"HAVE_CURRENT_DATA\",t[t.HAVE_FUTURE_DATA=3]=\"HAVE_FUTURE_DATA\",t[t.HAVE_ENOUGH_DATA=4]=\"HAVE_ENOUGH_DATA\"}(B||(B={}));export{G as Texture};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}