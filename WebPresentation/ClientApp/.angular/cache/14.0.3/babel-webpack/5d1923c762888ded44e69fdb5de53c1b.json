{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport { NUMBER_MAX_FLOAT32 as e } from \"../../../core/mathUtils.js\";\nimport { isSome as s, isNone as n } from \"../../../core/maybe.js\";\nimport { property as o } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as a } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { getPixelValueRange as r } from \"../rasterFormats/pixelRangeUtils.js\";\nimport u from \"./BaseRasterFunction.js\";\nimport { createRemapLUT as i, MAX_MAP_SIZE_GPU as l, lookupPixels as p, lookupBandValues as c, remap as m } from \"./pixelUtils.js\";\nimport g from \"./RemapFunctionArguments.js\";\nlet h = class extends u {\n  constructor() {\n    super(...arguments), this.functionName = \"Remap\", this.functionArguments = null, this.rasterArgumentNames = [\"raster\"], this.lookup = null;\n  }\n\n  _bindSourceRasters() {\n    const t = this.sourceRasterInfos[0].clone(),\n          {\n      pixelType: e\n    } = t;\n    this.outputPixelType = this._getOutputPixelType(e), t.pixelType = this.outputPixelType, t.colormap = null, t.histograms = null, t.bandCount = 1, t.attributeTable = null;\n    const {\n      statistics: n\n    } = t,\n          {\n      allowUnmatched: o,\n      outputValues: a,\n      inputRanges: r,\n      noDataRanges: u,\n      isLastInputRangeInclusive: p\n    } = this.functionArguments;\n    if (s(n) && n.length && a?.length) if (o) {\n      const e = Math.min.apply(null, [...a, n[0].min]),\n            s = Math.max.apply(null, [...a, n[0].max]);\n      t.statistics = [{ ...n[0],\n        min: e,\n        max: s\n      }];\n    } else {\n      let e = a[0],\n          s = e;\n\n      for (let t = 0; t < a.length; t++) e = e > a[t] ? a[t] : e, s = s > a[t] ? s : a[t];\n\n      t.statistics = [{ ...n[0],\n        min: e,\n        max: s\n      }];\n    }\n    this.rasterInfo = t, this.lookup = o ? null : i({\n      srcPixelType: e,\n      inputRanges: r,\n      outputValues: a,\n      noDataRanges: u,\n      allowUnmatched: o,\n      isLastInputRangeInclusive: p,\n      outputPixelType: this.outputPixelType\n    });\n    return {\n      success: !0,\n      supportsGPU: (!a || a.length <= l) && (!u || u.length <= l)\n    };\n  }\n\n  _processPixels(t) {\n    const e = t.pixelBlocks?.[0];\n    if (n(e)) return null;\n    const {\n      lookup: o,\n      outputPixelType: a\n    } = this;\n\n    if (o) {\n      const t = p(e, {\n        lut: [o.lut],\n        offset: o.offset,\n        outputPixelType: a\n      });\n      return s(t) && o.mask && (t.mask = c(e.pixels[0], e.mask, o.mask, o.offset, \"u8\")), t;\n    }\n\n    const {\n      inputRanges: r,\n      outputValues: u,\n      noDataRanges: i,\n      allowUnmatched: l,\n      isLastInputRangeInclusive: g\n    } = this.functionArguments;\n    return m(e, {\n      inputRanges: r,\n      outputValues: u,\n      noDataRanges: i,\n      outputPixelType: a,\n      allowUnmatched: l,\n      isLastInputRangeInclusive: g\n    });\n  }\n\n  _getWebGLParameters() {\n    const {\n      allowUnmatched: t,\n      inputRanges: s,\n      outputValues: n,\n      noDataRanges: o,\n      isLastInputRangeInclusive: a\n    } = this.functionArguments,\n          u = new Float32Array(3 * l),\n          i = 1e-5,\n          p = n.length;\n\n    if (s?.length) {\n      let t = 0,\n          o = 0;\n\n      for (let r = 0; r < u.length; r += 3) u[r] = s[t++] ?? e - 1, u[r + 1] = s[t++] ?? e, u[r + 2] = n[o++] ?? 0, o <= p && (r > 0 && (u[r] -= i), (o < p || !a) && (u[r + 1] -= i));\n    }\n\n    const c = new Float32Array(2 * l);\n    c.fill(e), o?.length && c.set(o);\n    return {\n      allowUnmatched: t,\n      rangeMaps: u,\n      noDataRanges: c,\n      clampRange: r(this.outputPixelType)\n    };\n  }\n\n};\nt([o({\n  json: {\n    write: !0,\n    name: \"rasterFunction\"\n  }\n})], h.prototype, \"functionName\", void 0), t([o({\n  type: g,\n  json: {\n    write: !0,\n    name: \"rasterFunctionArguments\"\n  }\n})], h.prototype, \"functionArguments\", void 0), t([o()], h.prototype, \"rasterArgumentNames\", void 0), t([o({\n  json: {\n    write: !0\n  }\n})], h.prototype, \"lookup\", void 0), h = t([a(\"esri.layers.support.rasterFunctions.RemapFunction\")], h);\nconst f = h;\nexport { f as default };","map":{"version":3,"names":["_","t","NUMBER_MAX_FLOAT32","e","isSome","s","isNone","n","property","o","subclass","a","getPixelValueRange","r","u","createRemapLUT","i","MAX_MAP_SIZE_GPU","l","lookupPixels","p","lookupBandValues","c","remap","m","g","h","constructor","arguments","functionName","functionArguments","rasterArgumentNames","lookup","_bindSourceRasters","sourceRasterInfos","clone","pixelType","outputPixelType","_getOutputPixelType","colormap","histograms","bandCount","attributeTable","statistics","allowUnmatched","outputValues","inputRanges","noDataRanges","isLastInputRangeInclusive","length","Math","min","apply","max","rasterInfo","srcPixelType","success","supportsGPU","_processPixels","pixelBlocks","lut","offset","mask","pixels","_getWebGLParameters","Float32Array","fill","set","rangeMaps","clampRange","json","write","name","prototype","type","f","default"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/layers/support/rasterFunctions/RemapFunction.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import{NUMBER_MAX_FLOAT32 as e}from\"../../../core/mathUtils.js\";import{isSome as s,isNone as n}from\"../../../core/maybe.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import{getPixelValueRange as r}from\"../rasterFormats/pixelRangeUtils.js\";import u from\"./BaseRasterFunction.js\";import{createRemapLUT as i,MAX_MAP_SIZE_GPU as l,lookupPixels as p,lookupBandValues as c,remap as m}from\"./pixelUtils.js\";import g from\"./RemapFunctionArguments.js\";let h=class extends u{constructor(){super(...arguments),this.functionName=\"Remap\",this.functionArguments=null,this.rasterArgumentNames=[\"raster\"],this.lookup=null}_bindSourceRasters(){const t=this.sourceRasterInfos[0].clone(),{pixelType:e}=t;this.outputPixelType=this._getOutputPixelType(e),t.pixelType=this.outputPixelType,t.colormap=null,t.histograms=null,t.bandCount=1,t.attributeTable=null;const{statistics:n}=t,{allowUnmatched:o,outputValues:a,inputRanges:r,noDataRanges:u,isLastInputRangeInclusive:p}=this.functionArguments;if(s(n)&&n.length&&a?.length)if(o){const e=Math.min.apply(null,[...a,n[0].min]),s=Math.max.apply(null,[...a,n[0].max]);t.statistics=[{...n[0],min:e,max:s}]}else{let e=a[0],s=e;for(let t=0;t<a.length;t++)e=e>a[t]?a[t]:e,s=s>a[t]?s:a[t];t.statistics=[{...n[0],min:e,max:s}]}this.rasterInfo=t,this.lookup=o?null:i({srcPixelType:e,inputRanges:r,outputValues:a,noDataRanges:u,allowUnmatched:o,isLastInputRangeInclusive:p,outputPixelType:this.outputPixelType});return{success:!0,supportsGPU:(!a||a.length<=l)&&(!u||u.length<=l)}}_processPixels(t){const e=t.pixelBlocks?.[0];if(n(e))return null;const{lookup:o,outputPixelType:a}=this;if(o){const t=p(e,{lut:[o.lut],offset:o.offset,outputPixelType:a});return s(t)&&o.mask&&(t.mask=c(e.pixels[0],e.mask,o.mask,o.offset,\"u8\")),t}const{inputRanges:r,outputValues:u,noDataRanges:i,allowUnmatched:l,isLastInputRangeInclusive:g}=this.functionArguments;return m(e,{inputRanges:r,outputValues:u,noDataRanges:i,outputPixelType:a,allowUnmatched:l,isLastInputRangeInclusive:g})}_getWebGLParameters(){const{allowUnmatched:t,inputRanges:s,outputValues:n,noDataRanges:o,isLastInputRangeInclusive:a}=this.functionArguments,u=new Float32Array(3*l),i=1e-5,p=n.length;if(s?.length){let t=0,o=0;for(let r=0;r<u.length;r+=3)u[r]=s[t++]??e-1,u[r+1]=s[t++]??e,u[r+2]=n[o++]??0,o<=p&&(r>0&&(u[r]-=i),(o<p||!a)&&(u[r+1]-=i))}const c=new Float32Array(2*l);c.fill(e),o?.length&&c.set(o);return{allowUnmatched:t,rangeMaps:u,noDataRanges:c,clampRange:r(this.outputPixelType)}}};t([o({json:{write:!0,name:\"rasterFunction\"}})],h.prototype,\"functionName\",void 0),t([o({type:g,json:{write:!0,name:\"rasterFunctionArguments\"}})],h.prototype,\"functionArguments\",void 0),t([o()],h.prototype,\"rasterArgumentNames\",void 0),t([o({json:{write:!0}})],h.prototype,\"lookup\",void 0),h=t([a(\"esri.layers.support.rasterFunctions.RemapFunction\")],h);const f=h;export{f as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}