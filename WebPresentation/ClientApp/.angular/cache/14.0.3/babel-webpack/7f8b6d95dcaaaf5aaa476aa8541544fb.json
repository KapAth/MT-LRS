{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { PositionHint as e, indexOf as t } from \"../../../core/arrayUtils.js\";\nimport i from \"../../../core/Error.js\";\nimport { clone as s } from \"../../../core/lang.js\";\nimport { removeMaybe as r, destroyMaybe as a, isNone as n, isSome as o } from \"../../../core/maybe.js\";\nimport { MemCacheStorage as u, MemCache as c } from \"../../../core/MemCache.js\";\nimport { throwIfAborted as l } from \"../../../core/promiseUtils.js\";\nimport { getMetersPerUnitForSR as h } from \"../../../core/unitUtils.js\";\nimport { set as m, NEGATIVE_INFINITY as p, create as f, expandWithAABB as d } from \"../../../geometry/support/aaBoundingBox.js\";\nimport { fromValues as y, create as g } from \"../../../geometry/support/aaBoundingRect.js\";\nimport { getBoundsXY as _ } from \"../../../geometry/support/boundsUtils.js\";\nimport { fromJSON as x, isExtent as w, isPolygon as S } from \"../../../geometry/support/jsonUtils.js\";\nimport { normalizeCentralMeridian as F } from \"../../../geometry/support/normalizeUtils.js\";\nimport { equals as R, isValid as Q } from \"../../../geometry/support/spatialReferenceUtils.js\";\nimport { convertFromGeometry as I } from \"../featureConversionUtils.js\";\nimport { getWhereClause as j, validateFields as E, validateWhere as A, validateHaving as b, hasInvalidFieldType as P } from \"./attributeSupport.js\";\nimport { checkProjectionSupport as T, project as B, projectMany as C } from \"./projectionSupport.js\";\nimport { queryCapabilities as k } from \"./QueryEngineCapabilities.js\";\nimport { QueryEngineResult as v, SnappingTypes as q } from \"./QueryEngineResult.js\";\nimport { getSpatialQueryOperator as z, canQueryWithRBush as O, checkSpatialQuerySupport as G } from \"./spatialQuerySupport.js\";\nimport { getTimeExtent as M, getTimeOperator as U } from \"./timeSupport.js\";\nimport { QUERY_ENGINE_EMPTY_RESULT as Z, cleanFromGeometryEngine as N, normalizeQuery as H, getGeometry as D } from \"./utils.js\";\nimport L from \"../../support/FieldsIndex.js\";\nimport { loadArcade as J } from \"../../../support/arcadeOnDemand.js\";\nimport { noBudget as V } from \"../../../views/support/Scheduler.js\";\n\nfunction W(e) {\n  return null != e && e.every(e => \"exceedslimit\" !== e.statisticType);\n}\n\nconst $ = \"feature-store:unsupported-query\";\n\nclass K {\n  constructor(e, t = null, i, s, r) {\n    this.attributes = e, this.geometry = i, this.centroid = s, this.filterFlags = r, this.groupId = -1, this.displayId = t;\n  }\n\n}\n\nconst X = new u(2e6);\nlet Y = 0;\n\nclass ee {\n  constructor(e) {\n    this._geometryQueryCache = null, this._changeHandle = null, this.capabilities = {\n      query: k\n    }, this.geometryType = e.geometryType, this.hasM = !!e.hasM, this.hasZ = !!e.hasZ, this.objectIdField = e.objectIdField, this.spatialReference = e.spatialReference, this.definitionExpression = e.definitionExpression, this.featureStore = e.featureStore, this.aggregateAdapter = e.aggregateAdapter, this._changeHandle = this.featureStore.events.on(\"changed\", () => this.clearCache()), this.timeInfo = e.timeInfo, e.cacheSpatialQueries && (this._geometryQueryCache = new c(Y++ + \"$$\", X)), this.fieldsIndex = new L(e.fields), e.scheduler && e.priority && (this._frameTask = e.scheduler.registerTask(e.priority));\n  }\n\n  destroy() {\n    this._frameTask = r(this._frameTask), this.clearCache(), a(this._geometryQueryCache), this._changeHandle = r(this._changeHandle), a(this.fieldsIndex);\n  }\n\n  get featureAdapter() {\n    return this.featureStore.featureAdapter;\n  }\n\n  clearCache() {\n    this._geometryQueryCache?.clear(), this._allFeaturesPromise = null, this._timeExtentPromise = null;\n  }\n\n  executeQuery(e, t) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        return (yield _this._executeQuery(e, {}, t)).createQueryResponse();\n      } catch (i) {\n        if (i !== Z) throw i;\n        return new v([], e, _this).createQueryResponse();\n      }\n    })();\n  }\n\n  executeQueryForCount(e = {}, t) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        return (yield _this2._executeQuery(e, {\n          returnGeometry: !1,\n          returnCentroid: !1,\n          outSR: null\n        }, t)).createQueryResponseForCount();\n      } catch (i) {\n        if (i !== Z) throw i;\n        return 0;\n      }\n    })();\n  }\n\n  executeQueryForExtent(e, t) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const i = e.outSR;\n\n      try {\n        const s = yield _this3._executeQuery(e, {\n          returnGeometry: !0,\n          returnCentroid: !1,\n          outSR: null\n        }, t),\n              r = s.size;\n        if (!r) return {\n          count: 0,\n          extent: null\n        };\n        return {\n          count: r,\n          extent: yield _this3._getBounds(s.items, s.spatialReference, i || _this3.spatialReference)\n        };\n      } catch (s) {\n        if (s === Z) return {\n          count: 0,\n          extent: null\n        };\n        throw s;\n      }\n    })();\n  }\n\n  executeQueryForIds(e, t) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this4.executeQueryForIdSet(e, t).then(e => Array.from(e));\n    })();\n  }\n\n  executeQueryForIdSet(e, t) {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        const i = yield _this5._executeQuery(e, {\n          returnGeometry: !0,\n          returnCentroid: !1,\n          outSR: null\n        }, t),\n              s = i.items,\n              r = new Set();\n        return yield _this5._reschedule(() => {\n          for (const e of s) r.add(i.featureAdapter.getObjectId(e));\n        }, t), r;\n      } catch (i) {\n        if (i === Z) return new Set();\n        throw i;\n      }\n    })();\n  }\n\n  executeQueryForSnapping(e, t) {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        point: i,\n        distance: s,\n        types: r\n      } = e;\n      if (r === q.NONE) return {\n        candidates: []\n      };\n      const a = yield _this6._reschedule(() => _this6._checkQuerySupport(e.query), t),\n            o = !R(i.spatialReference, _this6.spatialReference);\n      o && (yield T(i.spatialReference, _this6.spatialReference));\n      const u = \"number\" == typeof s ? s : s.x,\n            c = \"number\" == typeof s ? s : s.y,\n            l = {\n        xmin: i.x - u,\n        xmax: i.x + u,\n        ymin: i.y - c,\n        ymax: i.y + c,\n        spatialReference: i.spatialReference\n      },\n            h = o ? B(l, _this6.spatialReference) : l;\n      if (!h) return {\n        candidates: []\n      };\n      const m = (yield F(x(i), null, {\n        signal: t\n      }))[0],\n            p = (yield F(x(h), null, {\n        signal: t\n      }))[0];\n      if (n(m) || n(p)) return {\n        candidates: []\n      };\n      const f = new v(yield _this6._reschedule(() => _this6._searchFeatures(_this6._getQueryBBoxes(p.toJSON())), t), a, _this6);\n      yield _this6._reschedule(() => _this6._executeObjectIdsQuery(f), t), yield _this6._reschedule(() => _this6._executeTimeQuery(f), t), yield _this6._reschedule(() => _this6._executeAttributesQuery(f), t);\n      const d = m.toJSON(),\n            y = o ? B(d, _this6.spatialReference) : d,\n            g = o ? Math.max(h.xmax - h.xmin, h.ymax - h.ymin) / 2 : s;\n      return f.createSnappingResponse({ ...e,\n        point: y,\n        distance: g\n      }, i.spatialReference);\n    })();\n  }\n\n  executeQueryForLatestObservations(e, t) {\n    var _this7 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!_this7.timeInfo || !_this7.timeInfo.trackIdField) throw new i($, \"Missing timeInfo or timeInfo.trackIdField\", {\n        query: e,\n        timeInfo: _this7.timeInfo\n      });\n\n      try {\n        const i = yield _this7._executeQuery(e, {}, t);\n        return yield _this7._reschedule(() => _this7._filterLatest(i), t), i.createQueryResponse();\n      } catch (s) {\n        if (s !== Z) throw s;\n        return new v([], e, _this7).createQueryResponse();\n      }\n    })();\n  }\n\n  executeQueryForSummaryStatistics(e = {}, t, i) {\n    var _this8 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        field: s,\n        normalizationField: r,\n        valueExpression: a\n      } = t;\n      return (yield _this8._getQueryEngineResultForStats(e, {\n        field: s,\n        normalizationField: r,\n        valueExpression: a\n      }, i)).createSummaryStatisticsResponse(t);\n    })();\n  }\n\n  executeQueryForUniqueValues(e = {}, t, i) {\n    var _this9 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        field: s,\n        field2: r,\n        field3: a,\n        valueExpression: n\n      } = t;\n      return (yield _this9._getQueryEngineResultForStats(e, {\n        field: s,\n        field2: r,\n        field3: a,\n        valueExpression: n\n      }, i)).createUniqueValuesResponse(t);\n    })();\n  }\n\n  executeQueryForClassBreaks(e = {}, t, i) {\n    var _this10 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        field: s,\n        normalizationField: r,\n        valueExpression: a\n      } = t;\n      return (yield _this10._getQueryEngineResultForStats(e, {\n        field: s,\n        normalizationField: r,\n        valueExpression: a\n      }, i)).createClassBreaksResponse(t);\n    })();\n  }\n\n  executeQueryForHistogram(e = {}, t, i) {\n    var _this11 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        field: s,\n        normalizationField: r,\n        valueExpression: a\n      } = t;\n      return (yield _this11._getQueryEngineResultForStats(e, {\n        field: s,\n        normalizationField: r,\n        valueExpression: a\n      }, i)).createHistogramResponse(t);\n    })();\n  }\n\n  fetchRecomputedExtents(e) {\n    var _this12 = this;\n\n    return _asyncToGenerator(function* () {\n      const [t, i] = yield Promise.all([\"getFullExtent\" in _this12.featureStore && _this12.featureStore.getFullExtent ? Promise.resolve(_this12.featureStore.getFullExtent(_this12.spatialReference)) : _this12._getBounds(yield _this12._getAllFeatures(), _this12.spatialReference, _this12.spatialReference), o(_this12._timeExtentPromise) ? _this12._timeExtentPromise : _this12._timeExtentPromise = M(_this12.timeInfo, _this12.featureStore)]);\n      return l(e), {\n        fullExtent: t,\n        timeExtent: i\n      };\n    })();\n  }\n\n  _getBounds(e, t, i) {\n    var _this13 = this;\n\n    return _asyncToGenerator(function* () {\n      const s = m(f(), p);\n      yield _this13.featureStore.forEachBounds(e, e => d(s, e));\n      const r = {\n        xmin: s[0],\n        ymin: s[1],\n        xmax: s[3],\n        ymax: s[4],\n        spatialReference: N(_this13.spatialReference)\n      };\n      _this13.hasZ && isFinite(s[2]) && isFinite(s[5]) && (r.zmin = s[2], r.zmax = s[5]);\n      const a = B(r, t, i);\n\n      if (a.spatialReference = N(i), a.xmax - a.xmin == 0) {\n        const e = h(a.spatialReference);\n        a.xmin -= e, a.xmax += e;\n      }\n\n      if (a.ymax - a.ymin == 0) {\n        const e = h(a.spatialReference);\n        a.ymin -= e, a.ymax += e;\n      }\n\n      if (_this13.hasZ && null != a.zmin && null != a.zmax && a.zmax - a.zmin == 0) {\n        const e = h(a.spatialReference);\n        a.zmin -= e, a.zmax += e;\n      }\n\n      return a;\n    })();\n  }\n\n  _schedule(e, t) {\n    var _this14 = this;\n\n    return _asyncToGenerator(function* () {\n      return o(_this14._frameTask) ? _this14._frameTask.schedule(e, t) : e(V);\n    })();\n  }\n\n  _reschedule(e, t) {\n    var _this15 = this;\n\n    return _asyncToGenerator(function* () {\n      return o(_this15._frameTask) ? _this15._frameTask.reschedule(e, t) : e(V);\n    })();\n  }\n\n  _getAllFeaturesQueryEngineResult(e) {\n    var _this16 = this;\n\n    return _asyncToGenerator(function* () {\n      return new v(yield _this16._getAllFeatures(), e, _this16);\n    })();\n  }\n\n  _getAllFeatures() {\n    var _this17 = this;\n\n    return _asyncToGenerator(function* () {\n      if (n(_this17._allFeaturesPromise)) {\n        const e = [];\n        _this17._allFeaturesPromise = _asyncToGenerator(function* () {\n          yield _this17.featureStore.forEach(t => e.push(t));\n        })().then(() => e);\n      }\n\n      const e = _this17._allFeaturesPromise,\n            t = yield e;\n      return e === _this17._allFeaturesPromise ? t.slice() : _this17._getAllFeatures();\n    })();\n  }\n\n  _executeQuery(e, t, i) {\n    var _this18 = this;\n\n    return _asyncToGenerator(function* () {\n      e = s(e), e = yield _this18._schedule(() => H(e, _this18.definitionExpression, _this18.spatialReference), i), e = yield _this18._reschedule(() => _this18._checkQuerySupport(e), i), e = { ...e,\n        ...t\n      };\n      const r = yield _this18._reschedule(() => _this18._executeSceneFilterQuery(e, i), i),\n            a = yield _this18._reschedule(() => _this18._executeGeometryQuery(e, r, i), i);\n      return yield _this18._reschedule(() => _this18._executeAggregateIdsQuery(a), i), yield _this18._reschedule(() => _this18._executeObjectIdsQuery(a), i), yield _this18._reschedule(() => _this18._executeTimeQuery(a), i), yield _this18._reschedule(() => _this18._executeAttributesQuery(a), i), a;\n    })();\n  }\n\n  _executeSceneFilterQuery(e, t) {\n    var _this19 = this;\n\n    return _asyncToGenerator(function* () {\n      if (n(e.sceneFilter)) return null;\n      const {\n        outSR: i,\n        returnGeometry: s,\n        returnCentroid: r\n      } = e,\n            a = _this19.featureStore.featureSpatialReference,\n            o = e.sceneFilter.geometry,\n            u = n(a) || R(a, o.spatialReference) ? o : B(o, a);\n      if (!u) return null;\n      const c = s || r,\n            l = Q(i) && !R(_this19.spatialReference, i) && c ? /*#__PURE__*/function () {\n        var _ref2 = _asyncToGenerator(function* (e) {\n          return _this19._project(e, i);\n        });\n\n        return function (_x) {\n          return _ref2.apply(this, arguments);\n        };\n      }() : e => e,\n            h = _this19.featureAdapter,\n            m = yield _this19._reschedule(() => _this19._searchFeatures(_this19._getQueryBBoxes(u)), t);\n\n      if (\"disjoint\" === e.sceneFilter.spatialRelationship) {\n        if (!m.length) return null;\n        const i = new Set();\n\n        for (const e of m) i.add(h.getObjectId(e));\n\n        const s = yield _this19._reschedule(() => _this19._getAllFeatures(), t),\n              r = yield _this19._reschedule( /*#__PURE__*/_asyncToGenerator(function* () {\n          const r = yield z(\"esriSpatialRelDisjoint\", u, _this19.geometryType, _this19.hasZ, _this19.hasM),\n                a = e => !i.has(h.getObjectId(e)) || r(h.getGeometry(e)),\n                n = yield _this19._runSpatialFilter(s, a, t);\n\n          return new v(n, e, _this19);\n        }), t);\n        return l(r);\n      }\n\n      if (!m.length) return new v([], e, _this19);\n      if (_this19._canExecuteSinglePass(u, e)) return l(new v(m, e, _this19));\n      const p = yield z(\"esriSpatialRelContains\", u, _this19.geometryType, _this19.hasZ, _this19.hasM),\n            f = yield _this19._runSpatialFilter(m, e => p(h.getGeometry(e)), t);\n      return l(new v(f, e, _this19));\n    })();\n  }\n\n  _executeGeometryQuery(i, s, r) {\n    var _this20 = this;\n\n    return _asyncToGenerator(function* () {\n      if (o(s) && 0 === s.items.length) return s;\n      i = o(s) ? s.query : i;\n      const {\n        geometry: a,\n        outSR: u,\n        spatialRel: c,\n        returnGeometry: l,\n        returnCentroid: h\n      } = i,\n            m = _this20.featureStore.featureSpatialReference,\n            p = !a || n(m) || R(m, a.spatialReference) ? a : B(a, m),\n            f = l || h,\n            d = Q(u) && !R(_this20.spatialReference, u),\n            y = _this20._geometryQueryCache && n(s) ? d && f ? JSON.stringify({\n        originalFilterGeometry: a,\n        spatialRelationship: c,\n        outSpatialReference: u\n      }) : JSON.stringify({\n        originalFilterGeometry: a,\n        spatialRelationship: c\n      }) : null,\n            g = y ? _this20._geometryQueryCache.get(y) : null;\n      if (o(g)) return new v(g, i, _this20);\n\n      const _ = /*#__PURE__*/function () {\n        var _ref4 = _asyncToGenerator(function* (e) {\n          return d && f && (yield _this20._project(e, u)), y && _this20._geometryQueryCache.put(y, e.items, e.items.length + 1), e;\n        });\n\n        return function _(_x2) {\n          return _ref4.apply(this, arguments);\n        };\n      }();\n\n      if (!p) return _(o(s) ? s : yield _this20._getAllFeaturesQueryEngineResult(i));\n      const x = _this20.featureAdapter;\n      let w = yield _this20._reschedule(() => _this20._searchFeatures(_this20._getQueryBBoxes(a)), r);\n\n      if (\"esriSpatialRelDisjoint\" === c) {\n        if (!w.length) return _(o(s) ? s : yield _this20._getAllFeaturesQueryEngineResult(i));\n        const e = new Set();\n\n        for (const i of w) e.add(x.getObjectId(i));\n\n        const t = o(s) ? s.items : yield _this20._reschedule(() => _this20._getAllFeatures(), r),\n              a = yield _this20._reschedule( /*#__PURE__*/_asyncToGenerator(function* () {\n          const s = yield z(c, p, _this20.geometryType, _this20.hasZ, _this20.hasM),\n                a = t => !e.has(x.getObjectId(t)) || s(x.getGeometry(t)),\n                n = yield _this20._runSpatialFilter(t, a, r);\n\n          return new v(n, i, _this20);\n        }), r);\n        return _(a);\n      }\n\n      if (o(s)) {\n        const i = new e();\n        w = w.filter(e => t(s.items, e, s.items.length, i) >= 0);\n      }\n\n      if (!w.length) {\n        const e = new v([], i, _this20);\n        return y && _this20._geometryQueryCache.put(y, e.items, 1), e;\n      }\n\n      if (_this20._canExecuteSinglePass(p, i)) return _(new v(w, i, _this20));\n      const S = yield z(c, p, _this20.geometryType, _this20.hasZ, _this20.hasM),\n            F = yield _this20._runSpatialFilter(w, e => S(x.getGeometry(e)), r);\n      return _(new v(F, i, _this20));\n    })();\n  }\n\n  _executeAggregateIdsQuery(e) {\n    if (0 === e.items.length || !e.query.aggregateIds || !e.query.aggregateIds.length || n(this.aggregateAdapter)) return;\n    const t = new Set();\n\n    for (const s of e.query.aggregateIds) {\n      this.aggregateAdapter.getFeatureObjectIds(s).forEach(e => t.add(e));\n    }\n\n    const i = this.featureAdapter.getObjectId;\n    e.items = e.items.filter(e => t.has(i(e)));\n  }\n\n  _executeObjectIdsQuery(e) {\n    if (0 === e.items.length || !e.query.objectIds || !e.query.objectIds.length) return;\n    const t = new Set(e.query.objectIds),\n          i = this.featureAdapter.getObjectId;\n    e.items = e.items.filter(e => t.has(i(e)));\n  }\n\n  _executeTimeQuery(e) {\n    if (0 === e.items.length) return;\n    const t = U(this.timeInfo, e.query.timeExtent, this.featureAdapter);\n    n(t) || (e.items = e.items.filter(t));\n  }\n\n  _executeAttributesQuery(e) {\n    if (0 === e.items.length) return;\n    const t = j(e.query.where, this.fieldsIndex);\n\n    if (t) {\n      if (!t.isStandardized) throw new TypeError(\"Where clause is not standardized\");\n      e.items = e.items.filter(e => t.testFeature(e, this.featureAdapter));\n    }\n  }\n\n  _runSpatialFilter(e, t, i) {\n    var _this21 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!t) return e;\n      if (n(_this21._frameTask)) return e.filter(e => t(e));\n      let s = 0;\n\n      const r = new Array(),\n            a = /*#__PURE__*/function () {\n        var _ref6 = _asyncToGenerator(function* (n) {\n          for (; s < e.length;) {\n            const o = e[s++];\n            t(o) && (r.push(o), n.madeProgress()), n.done && (yield _this21._reschedule(e => a(e), i));\n          }\n        });\n\n        return function a(_x3) {\n          return _ref6.apply(this, arguments);\n        };\n      }();\n\n      return _this21._reschedule(e => a(e), i).then(() => r);\n    })();\n  }\n\n  _filterLatest(e) {\n    const {\n      trackIdField: t,\n      startTimeField: i,\n      endTimeField: s\n    } = this.timeInfo,\n          r = s || i,\n          a = new Map(),\n          n = this.featureAdapter.getAttribute;\n\n    for (const o of e.items) {\n      const e = n(o, t),\n            i = n(o, r),\n            s = a.get(e);\n      (!s || i > n(s, r)) && a.set(e, o);\n    }\n\n    e.items = Array.from(a.values());\n  }\n\n  _canExecuteSinglePass(e, t) {\n    const {\n      spatialRel: i\n    } = t;\n    return O(e) && (\"esriSpatialRelEnvelopeIntersects\" === i || \"esriGeometryPoint\" === this.geometryType && (\"esriSpatialRelIntersects\" === i || \"esriSpatialRelContains\" === i || \"esriSpatialRelWithin\" === i));\n  }\n\n  _project(e, t) {\n    var _this22 = this;\n\n    return _asyncToGenerator(function* () {\n      if (!t || R(_this22.spatialReference, t)) return e;\n      const i = _this22.featureAdapter,\n            s = yield C(e.items.map(e => D(_this22.geometryType, _this22.hasZ, _this22.hasM, i.getGeometry(e))), _this22.spatialReference, t);\n      return e.items = s.map((t, s) => i.cloneWithGeometry(e.items[s], I(t, _this22.hasZ, _this22.hasM))), e;\n    })();\n  }\n\n  _getQueryBBoxes(e) {\n    if (O(e)) {\n      if (w(e)) return [y(e.xmin, e.ymin, e.xmax, e.ymax)];\n      if (S(e)) return e.rings.map(e => y(Math.min(e[0][0], e[2][0]), Math.min(e[0][1], e[2][1]), Math.max(e[0][0], e[2][0]), Math.max(e[0][1], e[2][1])));\n    }\n\n    return [_(g(), e)];\n  }\n\n  _searchFeatures(e) {\n    var _this23 = this;\n\n    return _asyncToGenerator(function* () {\n      const t = new Set();\n      yield Promise.all(e.map(e => _this23.featureStore.forEachInBounds(e, e => t.add(e))));\n      const i = Array.from(t.values());\n      return t.clear(), i;\n    })();\n  }\n\n  _checkStatisticsSupport(e, t) {\n    var _this24 = this;\n\n    return _asyncToGenerator(function* () {\n      if ((e.distance ?? 0) < 0 || null != e.geometryPrecision || e.multipatchOption || e.pixelSize || e.relationParam || e.text || e.outStatistics || e.groupByFieldsForStatistics || e.having || e.orderByFields) throw new i($, \"Unsupported query options\", {\n        query: e\n      });\n      return _this24._checkAttributesQuerySupport(e), Promise.all([_this24._checkStatisticsParamsSupport(t), G(e, _this24.geometryType, _this24.spatialReference), T(_this24.spatialReference, e.outSR)]).then(() => e);\n    })();\n  }\n\n  _checkStatisticsParamsSupport(e) {\n    var _this25 = this;\n\n    return _asyncToGenerator(function* () {\n      let t = [];\n\n      if (e.valueExpression) {\n        const {\n          arcadeUtils: i\n        } = yield J();\n        t = i.extractFieldNames(e.valueExpression);\n      }\n\n      if (e.field && t.push(e.field), e.field2 && t.push(e.field2), e.field3 && t.push(e.field3), e.normalizationField && t.push(e.normalizationField), !t.length) throw new i($, \"params should have at least a field or valueExpression\", {\n        params: e\n      });\n      E(_this25.fieldsIndex, t, \"params contains missing fields\");\n    })();\n  }\n\n  _checkQuerySupport(e) {\n    var _this26 = this;\n\n    return _asyncToGenerator(function* () {\n      if ((e.distance ?? 0) < 0 || null != e.geometryPrecision || e.multipatchOption || e.pixelSize || e.relationParam || e.text) throw new i($, \"Unsupported query options\", {\n        query: e\n      });\n      return _this26._checkAttributesQuerySupport(e), _this26._checkStatisticsQuerySupport(e), Promise.all([G(e, _this26.geometryType, _this26.spatialReference), T(_this26.spatialReference, e.outSR)]).then(() => e);\n    })();\n  }\n\n  _checkAttributesQuerySupport(e) {\n    const {\n      outFields: t,\n      orderByFields: s,\n      returnDistinctValues: r,\n      outStatistics: a\n    } = e,\n          n = a ? a.map(e => e.outStatisticFieldName && e.outStatisticFieldName.toLowerCase()).filter(Boolean) : [];\n\n    if (s && s.length > 0) {\n      const e = \" asc\",\n            t = \" desc\",\n            i = s.map(i => {\n        const s = i.toLowerCase();\n        return s.includes(e) ? s.split(e)[0] : s.includes(t) ? s.split(t)[0] : i;\n      }).filter(e => !n.includes(e));\n      E(this.fieldsIndex, i, \"orderByFields contains missing fields\");\n    }\n\n    if (t && t.length > 0) E(this.fieldsIndex, t, \"outFields contains missing fields\");else if (r) throw new i($, \"outFields should be specified for returnDistinctValues\", {\n      query: e\n    });\n    A(this.fieldsIndex, e.where);\n  }\n\n  _checkStatisticsQuerySupport(e) {\n    const {\n      outStatistics: t,\n      groupByFieldsForStatistics: s,\n      having: r\n    } = e,\n          a = s && s.length,\n          n = t && t.length;\n\n    if (r) {\n      if (!a || !n) throw new i($, \"outStatistics and groupByFieldsForStatistics should be specified with having\", {\n        query: e\n      });\n      b(this.fieldsIndex, r, t);\n    }\n\n    if (n) {\n      if (!W(t)) return;\n      const r = t.map(e => e.onStatisticField).filter(Boolean);\n      E(this.fieldsIndex, r, \"onStatisticFields contains missing fields\"), a && E(this.fieldsIndex, s, \"groupByFieldsForStatistics contains missing fields\");\n\n      for (const s of t) {\n        const {\n          onStatisticField: t,\n          statisticType: r\n        } = s;\n\n        if ((\"percentile_disc\" === r || \"percentile_cont\" === r) && \"statisticParameters\" in s) {\n          const {\n            statisticParameters: t\n          } = s;\n          if (!t) throw new i($, \"statisticParamters should be set for percentile type\", {\n            definition: s,\n            query: e\n          });\n        } else if (\"count\" !== r && t && P(t, this.fieldsIndex)) throw new i($, \"outStatistics contains non-numeric fields\", {\n          definition: s,\n          query: e\n        });\n      }\n    }\n  }\n\n  _getQueryEngineResultForStats(e, t, i) {\n    var _this27 = this;\n\n    return _asyncToGenerator(function* () {\n      e = s(e);\n\n      try {\n        e = yield _this27._schedule(() => H(e, _this27.definitionExpression, _this27.spatialReference), i), e = yield _this27._reschedule(() => _this27._checkStatisticsSupport(e, t), i);\n        const s = yield _this27._reschedule(() => _this27._executeSceneFilterQuery(e, i), i),\n              r = yield _this27._reschedule(() => _this27._executeGeometryQuery(e, s, i), i);\n        return yield _this27._reschedule(() => _this27._executeAggregateIdsQuery(r), i), yield _this27._reschedule(() => _this27._executeObjectIdsQuery(r), i), yield _this27._reschedule(() => _this27._executeTimeQuery(r), i), yield _this27._reschedule(() => _this27._executeAttributesQuery(r), i), r;\n      } catch (r) {\n        if (r !== Z) throw r;\n        return new v([], e, _this27);\n      }\n    })();\n  }\n\n}\n\nexport { K as Feature, ee as QueryEngine };","map":{"version":3,"names":["PositionHint","e","indexOf","t","i","clone","s","removeMaybe","r","destroyMaybe","a","isNone","n","isSome","o","MemCacheStorage","u","MemCache","c","throwIfAborted","l","getMetersPerUnitForSR","h","set","m","NEGATIVE_INFINITY","p","create","f","expandWithAABB","d","fromValues","y","g","getBoundsXY","_","fromJSON","x","isExtent","w","isPolygon","S","normalizeCentralMeridian","F","equals","R","isValid","Q","convertFromGeometry","I","getWhereClause","j","validateFields","E","validateWhere","A","validateHaving","b","hasInvalidFieldType","P","checkProjectionSupport","T","project","B","projectMany","C","queryCapabilities","k","QueryEngineResult","v","SnappingTypes","q","getSpatialQueryOperator","z","canQueryWithRBush","O","checkSpatialQuerySupport","G","getTimeExtent","M","getTimeOperator","U","QUERY_ENGINE_EMPTY_RESULT","Z","cleanFromGeometryEngine","N","normalizeQuery","H","getGeometry","D","L","loadArcade","J","noBudget","V","W","every","statisticType","$","K","constructor","attributes","geometry","centroid","filterFlags","groupId","displayId","X","Y","ee","_geometryQueryCache","_changeHandle","capabilities","query","geometryType","hasM","hasZ","objectIdField","spatialReference","definitionExpression","featureStore","aggregateAdapter","events","on","clearCache","timeInfo","cacheSpatialQueries","fieldsIndex","fields","scheduler","priority","_frameTask","registerTask","destroy","featureAdapter","clear","_allFeaturesPromise","_timeExtentPromise","executeQuery","_executeQuery","createQueryResponse","executeQueryForCount","returnGeometry","returnCentroid","outSR","createQueryResponseForCount","executeQueryForExtent","size","count","extent","_getBounds","items","executeQueryForIds","executeQueryForIdSet","then","Array","from","Set","_reschedule","add","getObjectId","executeQueryForSnapping","point","distance","types","NONE","candidates","_checkQuerySupport","xmin","xmax","ymin","ymax","signal","_searchFeatures","_getQueryBBoxes","toJSON","_executeObjectIdsQuery","_executeTimeQuery","_executeAttributesQuery","Math","max","createSnappingResponse","executeQueryForLatestObservations","trackIdField","_filterLatest","executeQueryForSummaryStatistics","field","normalizationField","valueExpression","_getQueryEngineResultForStats","createSummaryStatisticsResponse","executeQueryForUniqueValues","field2","field3","createUniqueValuesResponse","executeQueryForClassBreaks","createClassBreaksResponse","executeQueryForHistogram","createHistogramResponse","fetchRecomputedExtents","Promise","all","getFullExtent","resolve","_getAllFeatures","fullExtent","timeExtent","forEachBounds","isFinite","zmin","zmax","_schedule","schedule","reschedule","_getAllFeaturesQueryEngineResult","forEach","push","slice","_executeSceneFilterQuery","_executeGeometryQuery","_executeAggregateIdsQuery","sceneFilter","featureSpatialReference","_project","spatialRelationship","length","has","_runSpatialFilter","_canExecuteSinglePass","spatialRel","JSON","stringify","originalFilterGeometry","outSpatialReference","get","put","filter","aggregateIds","getFeatureObjectIds","objectIds","where","isStandardized","TypeError","testFeature","madeProgress","done","startTimeField","endTimeField","Map","getAttribute","values","map","cloneWithGeometry","rings","min","forEachInBounds","_checkStatisticsSupport","geometryPrecision","multipatchOption","pixelSize","relationParam","text","outStatistics","groupByFieldsForStatistics","having","orderByFields","_checkAttributesQuerySupport","_checkStatisticsParamsSupport","arcadeUtils","extractFieldNames","params","_checkStatisticsQuerySupport","outFields","returnDistinctValues","outStatisticFieldName","toLowerCase","Boolean","includes","split","onStatisticField","statisticParameters","definition","Feature","QueryEngine"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{PositionHint as e,indexOf as t}from\"../../../core/arrayUtils.js\";import i from\"../../../core/Error.js\";import{clone as s}from\"../../../core/lang.js\";import{removeMaybe as r,destroyMaybe as a,isNone as n,isSome as o}from\"../../../core/maybe.js\";import{MemCacheStorage as u,MemCache as c}from\"../../../core/MemCache.js\";import{throwIfAborted as l}from\"../../../core/promiseUtils.js\";import{getMetersPerUnitForSR as h}from\"../../../core/unitUtils.js\";import{set as m,NEGATIVE_INFINITY as p,create as f,expandWithAABB as d}from\"../../../geometry/support/aaBoundingBox.js\";import{fromValues as y,create as g}from\"../../../geometry/support/aaBoundingRect.js\";import{getBoundsXY as _}from\"../../../geometry/support/boundsUtils.js\";import{fromJSON as x,isExtent as w,isPolygon as S}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as F}from\"../../../geometry/support/normalizeUtils.js\";import{equals as R,isValid as Q}from\"../../../geometry/support/spatialReferenceUtils.js\";import{convertFromGeometry as I}from\"../featureConversionUtils.js\";import{getWhereClause as j,validateFields as E,validateWhere as A,validateHaving as b,hasInvalidFieldType as P}from\"./attributeSupport.js\";import{checkProjectionSupport as T,project as B,projectMany as C}from\"./projectionSupport.js\";import{queryCapabilities as k}from\"./QueryEngineCapabilities.js\";import{QueryEngineResult as v,SnappingTypes as q}from\"./QueryEngineResult.js\";import{getSpatialQueryOperator as z,canQueryWithRBush as O,checkSpatialQuerySupport as G}from\"./spatialQuerySupport.js\";import{getTimeExtent as M,getTimeOperator as U}from\"./timeSupport.js\";import{QUERY_ENGINE_EMPTY_RESULT as Z,cleanFromGeometryEngine as N,normalizeQuery as H,getGeometry as D}from\"./utils.js\";import L from\"../../support/FieldsIndex.js\";import{loadArcade as J}from\"../../../support/arcadeOnDemand.js\";import{noBudget as V}from\"../../../views/support/Scheduler.js\";function W(e){return null!=e&&e.every((e=>\"exceedslimit\"!==e.statisticType))}const $=\"feature-store:unsupported-query\";class K{constructor(e,t=null,i,s,r){this.attributes=e,this.geometry=i,this.centroid=s,this.filterFlags=r,this.groupId=-1,this.displayId=t}}const X=new u(2e6);let Y=0;class ee{constructor(e){this._geometryQueryCache=null,this._changeHandle=null,this.capabilities={query:k},this.geometryType=e.geometryType,this.hasM=!!e.hasM,this.hasZ=!!e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on(\"changed\",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new c(Y+++\"$$\",X)),this.fieldsIndex=new L(e.fields),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=r(this._frameTask),this.clearCache(),a(this._geometryQueryCache),this._changeHandle=r(this._changeHandle),a(this.fieldsIndex)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear(),this._allFeaturesPromise=null,this._timeExtentPromise=null}async executeQuery(e,t){try{return(await this._executeQuery(e,{},t)).createQueryResponse()}catch(i){if(i!==Z)throw i;return new v([],e,this).createQueryResponse()}}async executeQueryForCount(e={},t){try{return(await this._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},t)).createQueryResponseForCount()}catch(i){if(i!==Z)throw i;return 0}}async executeQueryForExtent(e,t){const i=e.outSR;try{const s=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),r=s.size;if(!r)return{count:0,extent:null};return{count:r,extent:await this._getBounds(s.items,s.spatialReference,i||this.spatialReference)}}catch(s){if(s===Z)return{count:0,extent:null};throw s}}async executeQueryForIds(e,t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e,t){try{const i=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),s=i.items,r=new Set;return await this._reschedule((()=>{for(const e of s)r.add(i.featureAdapter.getObjectId(e))}),t),r}catch(i){if(i===Z)return new Set;throw i}}async executeQueryForSnapping(e,t){const{point:i,distance:s,types:r}=e;if(r===q.NONE)return{candidates:[]};const a=await this._reschedule((()=>this._checkQuerySupport(e.query)),t),o=!R(i.spatialReference,this.spatialReference);o&&await T(i.spatialReference,this.spatialReference);const u=\"number\"==typeof s?s:s.x,c=\"number\"==typeof s?s:s.y,l={xmin:i.x-u,xmax:i.x+u,ymin:i.y-c,ymax:i.y+c,spatialReference:i.spatialReference},h=o?B(l,this.spatialReference):l;if(!h)return{candidates:[]};const m=(await F(x(i),null,{signal:t}))[0],p=(await F(x(h),null,{signal:t}))[0];if(n(m)||n(p))return{candidates:[]};const f=new v(await this._reschedule((()=>this._searchFeatures(this._getQueryBBoxes(p.toJSON()))),t),a,this);await this._reschedule((()=>this._executeObjectIdsQuery(f)),t),await this._reschedule((()=>this._executeTimeQuery(f)),t),await this._reschedule((()=>this._executeAttributesQuery(f)),t);const d=m.toJSON(),y=o?B(d,this.spatialReference):d,g=o?Math.max(h.xmax-h.xmin,h.ymax-h.ymin)/2:s;return f.createSnappingResponse({...e,point:y,distance:g},i.spatialReference)}async executeQueryForLatestObservations(e,t){if(!this.timeInfo||!this.timeInfo.trackIdField)throw new i($,\"Missing timeInfo or timeInfo.trackIdField\",{query:e,timeInfo:this.timeInfo});try{const i=await this._executeQuery(e,{},t);return await this._reschedule((()=>this._filterLatest(i)),t),i.createQueryResponse()}catch(s){if(s!==Z)throw s;return new v([],e,this).createQueryResponse()}}async executeQueryForSummaryStatistics(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createSummaryStatisticsResponse(t)}async executeQueryForUniqueValues(e={},t,i){const{field:s,field2:r,field3:a,valueExpression:n}=t;return(await this._getQueryEngineResultForStats(e,{field:s,field2:r,field3:a,valueExpression:n},i)).createUniqueValuesResponse(t)}async executeQueryForClassBreaks(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createClassBreaksResponse(t)}async executeQueryForHistogram(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._getQueryEngineResultForStats(e,{field:s,normalizationField:r,valueExpression:a},i)).createHistogramResponse(t)}async fetchRecomputedExtents(e){const[t,i]=await Promise.all([\"getFullExtent\"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getBounds(await this._getAllFeatures(),this.spatialReference,this.spatialReference),o(this._timeExtentPromise)?this._timeExtentPromise:this._timeExtentPromise=M(this.timeInfo,this.featureStore)]);return l(e),{fullExtent:t,timeExtent:i}}async _getBounds(e,t,i){const s=m(f(),p);await this.featureStore.forEachBounds(e,(e=>d(s,e)));const r={xmin:s[0],ymin:s[1],xmax:s[3],ymax:s[4],spatialReference:N(this.spatialReference)};this.hasZ&&isFinite(s[2])&&isFinite(s[5])&&(r.zmin=s[2],r.zmax=s[5]);const a=B(r,t,i);if(a.spatialReference=N(i),a.xmax-a.xmin==0){const e=h(a.spatialReference);a.xmin-=e,a.xmax+=e}if(a.ymax-a.ymin==0){const e=h(a.spatialReference);a.ymin-=e,a.ymax+=e}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin==0){const e=h(a.spatialReference);a.zmin-=e,a.zmax+=e}return a}async _schedule(e,t){return o(this._frameTask)?this._frameTask.schedule(e,t):e(V)}async _reschedule(e,t){return o(this._frameTask)?this._frameTask.reschedule(e,t):e(V)}async _getAllFeaturesQueryEngineResult(e){return new v(await this._getAllFeatures(),e,this)}async _getAllFeatures(){if(n(this._allFeaturesPromise)){const e=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach((t=>e.push(t)))})().then((()=>e))}const e=this._allFeaturesPromise,t=await e;return e===this._allFeaturesPromise?t.slice():this._getAllFeatures()}async _executeQuery(e,t,i){e=s(e),e=await this._schedule((()=>H(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>this._checkQuerySupport(e)),i),e={...e,...t};const r=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),a=await this._reschedule((()=>this._executeGeometryQuery(e,r,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(a)),i),await this._reschedule((()=>this._executeObjectIdsQuery(a)),i),await this._reschedule((()=>this._executeTimeQuery(a)),i),await this._reschedule((()=>this._executeAttributesQuery(a)),i),a}async _executeSceneFilterQuery(e,t){if(n(e.sceneFilter))return null;const{outSR:i,returnGeometry:s,returnCentroid:r}=e,a=this.featureStore.featureSpatialReference,o=e.sceneFilter.geometry,u=n(a)||R(a,o.spatialReference)?o:B(o,a);if(!u)return null;const c=s||r,l=Q(i)&&!R(this.spatialReference,i)&&c?async e=>this._project(e,i):e=>e,h=this.featureAdapter,m=await this._reschedule((()=>this._searchFeatures(this._getQueryBBoxes(u))),t);if(\"disjoint\"===e.sceneFilter.spatialRelationship){if(!m.length)return null;const i=new Set;for(const e of m)i.add(h.getObjectId(e));const s=await this._reschedule((()=>this._getAllFeatures()),t),r=await this._reschedule((async()=>{const r=await z(\"esriSpatialRelDisjoint\",u,this.geometryType,this.hasZ,this.hasM),a=e=>!i.has(h.getObjectId(e))||r(h.getGeometry(e)),n=await this._runSpatialFilter(s,a,t);return new v(n,e,this)}),t);return l(r)}if(!m.length)return new v([],e,this);if(this._canExecuteSinglePass(u,e))return l(new v(m,e,this));const p=await z(\"esriSpatialRelContains\",u,this.geometryType,this.hasZ,this.hasM),f=await this._runSpatialFilter(m,(e=>p(h.getGeometry(e))),t);return l(new v(f,e,this))}async _executeGeometryQuery(i,s,r){if(o(s)&&0===s.items.length)return s;i=o(s)?s.query:i;const{geometry:a,outSR:u,spatialRel:c,returnGeometry:l,returnCentroid:h}=i,m=this.featureStore.featureSpatialReference,p=!a||n(m)||R(m,a.spatialReference)?a:B(a,m),f=l||h,d=Q(u)&&!R(this.spatialReference,u),y=this._geometryQueryCache&&n(s)?d&&f?JSON.stringify({originalFilterGeometry:a,spatialRelationship:c,outSpatialReference:u}):JSON.stringify({originalFilterGeometry:a,spatialRelationship:c}):null,g=y?this._geometryQueryCache.get(y):null;if(o(g))return new v(g,i,this);const _=async e=>(d&&f&&await this._project(e,u),y&&this._geometryQueryCache.put(y,e.items,e.items.length+1),e);if(!p)return _(o(s)?s:await this._getAllFeaturesQueryEngineResult(i));const x=this.featureAdapter;let w=await this._reschedule((()=>this._searchFeatures(this._getQueryBBoxes(a))),r);if(\"esriSpatialRelDisjoint\"===c){if(!w.length)return _(o(s)?s:await this._getAllFeaturesQueryEngineResult(i));const e=new Set;for(const i of w)e.add(x.getObjectId(i));const t=o(s)?s.items:await this._reschedule((()=>this._getAllFeatures()),r),a=await this._reschedule((async()=>{const s=await z(c,p,this.geometryType,this.hasZ,this.hasM),a=t=>!e.has(x.getObjectId(t))||s(x.getGeometry(t)),n=await this._runSpatialFilter(t,a,r);return new v(n,i,this)}),r);return _(a)}if(o(s)){const i=new e;w=w.filter((e=>t(s.items,e,s.items.length,i)>=0))}if(!w.length){const e=new v([],i,this);return y&&this._geometryQueryCache.put(y,e.items,1),e}if(this._canExecuteSinglePass(p,i))return _(new v(w,i,this));const S=await z(c,p,this.geometryType,this.hasZ,this.hasM),F=await this._runSpatialFilter(w,(e=>S(x.getGeometry(e))),r);return _(new v(F,i,this))}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds||!e.query.aggregateIds.length||n(this.aggregateAdapter))return;const t=new Set;for(const s of e.query.aggregateIds){this.aggregateAdapter.getFeatureObjectIds(s).forEach((e=>t.add(e)))}const i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds||!e.query.objectIds.length)return;const t=new Set(e.query.objectIds),i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeTimeQuery(e){if(0===e.items.length)return;const t=U(this.timeInfo,e.query.timeExtent,this.featureAdapter);n(t)||(e.items=e.items.filter(t))}_executeAttributesQuery(e){if(0===e.items.length)return;const t=j(e.query.where,this.fieldsIndex);if(t){if(!t.isStandardized)throw new TypeError(\"Where clause is not standardized\");e.items=e.items.filter((e=>t.testFeature(e,this.featureAdapter)))}}async _runSpatialFilter(e,t,i){if(!t)return e;if(n(this._frameTask))return e.filter((e=>t(e)));let s=0;const r=new Array,a=async n=>{for(;s<e.length;){const o=e[s++];t(o)&&(r.push(o),n.madeProgress()),n.done&&await this._reschedule((e=>a(e)),i)}};return this._reschedule((e=>a(e)),i).then((()=>r))}_filterLatest(e){const{trackIdField:t,startTimeField:i,endTimeField:s}=this.timeInfo,r=s||i,a=new Map,n=this.featureAdapter.getAttribute;for(const o of e.items){const e=n(o,t),i=n(o,r),s=a.get(e);(!s||i>n(s,r))&&a.set(e,o)}e.items=Array.from(a.values())}_canExecuteSinglePass(e,t){const{spatialRel:i}=t;return O(e)&&(\"esriSpatialRelEnvelopeIntersects\"===i||\"esriGeometryPoint\"===this.geometryType&&(\"esriSpatialRelIntersects\"===i||\"esriSpatialRelContains\"===i||\"esriSpatialRelWithin\"===i))}async _project(e,t){if(!t||R(this.spatialReference,t))return e;const i=this.featureAdapter,s=await C(e.items.map((e=>D(this.geometryType,this.hasZ,this.hasM,i.getGeometry(e)))),this.spatialReference,t);return e.items=s.map(((t,s)=>i.cloneWithGeometry(e.items[s],I(t,this.hasZ,this.hasM)))),e}_getQueryBBoxes(e){if(O(e)){if(w(e))return[y(e.xmin,e.ymin,e.xmax,e.ymax)];if(S(e))return e.rings.map((e=>y(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[_(g(),e)]}async _searchFeatures(e){const t=new Set;await Promise.all(e.map((e=>this.featureStore.forEachInBounds(e,(e=>t.add(e))))));const i=Array.from(t.values());return t.clear(),i}async _checkStatisticsSupport(e,t){if((e.distance??0)<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text||e.outStatistics||e.groupByFieldsForStatistics||e.having||e.orderByFields)throw new i($,\"Unsupported query options\",{query:e});return this._checkAttributesQuerySupport(e),Promise.all([this._checkStatisticsParamsSupport(t),G(e,this.geometryType,this.spatialReference),T(this.spatialReference,e.outSR)]).then((()=>e))}async _checkStatisticsParamsSupport(e){let t=[];if(e.valueExpression){const{arcadeUtils:i}=await J();t=i.extractFieldNames(e.valueExpression)}if(e.field&&t.push(e.field),e.field2&&t.push(e.field2),e.field3&&t.push(e.field3),e.normalizationField&&t.push(e.normalizationField),!t.length)throw new i($,\"params should have at least a field or valueExpression\",{params:e});E(this.fieldsIndex,t,\"params contains missing fields\")}async _checkQuerySupport(e){if((e.distance??0)<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParam||e.text)throw new i($,\"Unsupported query options\",{query:e});return this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),Promise.all([G(e,this.geometryType,this.spatialReference),T(this.spatialReference,e.outSR)]).then((()=>e))}_checkAttributesQuerySupport(e){const{outFields:t,orderByFields:s,returnDistinctValues:r,outStatistics:a}=e,n=a?a.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if(s&&s.length>0){const e=\" asc\",t=\" desc\",i=s.map((i=>{const s=i.toLowerCase();return s.includes(e)?s.split(e)[0]:s.includes(t)?s.split(t)[0]:i})).filter((e=>!n.includes(e)));E(this.fieldsIndex,i,\"orderByFields contains missing fields\")}if(t&&t.length>0)E(this.fieldsIndex,t,\"outFields contains missing fields\");else if(r)throw new i($,\"outFields should be specified for returnDistinctValues\",{query:e});A(this.fieldsIndex,e.where)}_checkStatisticsQuerySupport(e){const{outStatistics:t,groupByFieldsForStatistics:s,having:r}=e,a=s&&s.length,n=t&&t.length;if(r){if(!a||!n)throw new i($,\"outStatistics and groupByFieldsForStatistics should be specified with having\",{query:e});b(this.fieldsIndex,r,t)}if(n){if(!W(t))return;const r=t.map((e=>e.onStatisticField)).filter(Boolean);E(this.fieldsIndex,r,\"onStatisticFields contains missing fields\"),a&&E(this.fieldsIndex,s,\"groupByFieldsForStatistics contains missing fields\");for(const s of t){const{onStatisticField:t,statisticType:r}=s;if((\"percentile_disc\"===r||\"percentile_cont\"===r)&&\"statisticParameters\"in s){const{statisticParameters:t}=s;if(!t)throw new i($,\"statisticParamters should be set for percentile type\",{definition:s,query:e})}else if(\"count\"!==r&&t&&P(t,this.fieldsIndex))throw new i($,\"outStatistics contains non-numeric fields\",{definition:s,query:e})}}}async _getQueryEngineResultForStats(e,t,i){e=s(e);try{e=await this._schedule((()=>H(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>this._checkStatisticsSupport(e,t)),i);const s=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),r=await this._reschedule((()=>this._executeGeometryQuery(e,s,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(r)),i),await this._reschedule((()=>this._executeObjectIdsQuery(r)),i),await this._reschedule((()=>this._executeTimeQuery(r)),i),await this._reschedule((()=>this._executeAttributesQuery(r)),i),r}catch(r){if(r!==Z)throw r;return new v([],e,this)}}}export{K as Feature,ee as QueryEngine};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}