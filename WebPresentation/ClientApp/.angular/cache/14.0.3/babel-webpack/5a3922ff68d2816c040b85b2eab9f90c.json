{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from \"../../../../../core/has.js\";\nimport { throwIfAborted as e, isAbortError as t } from \"../../../../../core/promiseUtils.js\";\nimport { BaseFeatureSource as r } from \"./BaseFeatureSource.js\";\nconst s = has(\"esri-mobile\"),\n      i = {\n  maxDrillLevel: s ? 1 : 4,\n  maxRecordCountFactor: s ? 1 : 3\n};\n\nclass a extends r {\n  constructor(e) {\n    super(e);\n  }\n\n  _fetchDataTile(r) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      const s = _this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,\n            a = _this._subscriptions.get(r.key.id),\n            o = a.signal,\n            n = r.getQuantizationParameters();\n\n      let c = 0;\n\n      const d = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator(function* (u, l) {\n          const p = _this._queryInfo,\n                m = _this.createTileQuery(u, {\n            maxRecordCountFactor: s ? i.maxRecordCountFactor : void 0,\n            returnExceededLimitFeatures: !1,\n            quantizationParameters: n\n          });\n\n          c++;\n\n          try {\n            const t = yield _this._queue.push({\n              tile: r,\n              query: m,\n              signal: o,\n              depth: l\n            });\n            if (c--, e(o), !t) return;\n            if (p !== _this._queryInfo) return void d(u, l);\n\n            if (t.exceededTransferLimit && l < i.maxDrillLevel) {\n              for (const e of u.createChildTiles()) d(e, l + 1);\n\n              return;\n            }\n\n            const s = {\n              id: r.id,\n              addOrUpdate: t,\n              end: 0 === c,\n              type: \"append\"\n            };\n            a.add({\n              query: m,\n              message: s\n            }), _this._onMessage(s);\n          } catch (h) {\n            t(h) || _this._onMessage({\n              id: r.id,\n              addOrUpdate: null,\n              end: !0,\n              type: \"append\"\n            });\n          }\n        });\n\n        return function d(_x, _x2) {\n          return _ref.apply(this, arguments);\n        };\n      }();\n\n      d(r, 0);\n    })();\n  }\n\n}\n\nexport { a as DrillDownFeatureSource };","map":{"version":3,"names":["has","throwIfAborted","e","isAbortError","t","BaseFeatureSource","r","s","i","maxDrillLevel","maxRecordCountFactor","a","constructor","_fetchDataTile","_serviceInfo","capabilities","query","supportsMaxRecordCountFactor","_subscriptions","get","key","id","o","signal","n","getQuantizationParameters","c","d","u","l","p","_queryInfo","m","createTileQuery","returnExceededLimitFeatures","quantizationParameters","_queue","push","tile","depth","exceededTransferLimit","createChildTiles","addOrUpdate","end","type","add","message","_onMessage","h","DrillDownFeatureSource"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/views/2d/layers/features/sources/DrillDownFeatureSource.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from\"../../../../../core/has.js\";import{throwIfAborted as e,isAbortError as t}from\"../../../../../core/promiseUtils.js\";import{BaseFeatureSource as r}from\"./BaseFeatureSource.js\";const s=has(\"esri-mobile\"),i={maxDrillLevel:s?1:4,maxRecordCountFactor:s?1:3};class a extends r{constructor(e){super(e)}async _fetchDataTile(r){const s=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,a=this._subscriptions.get(r.key.id),o=a.signal,n=r.getQuantizationParameters();let c=0;const d=async(u,l)=>{const p=this._queryInfo,m=this.createTileQuery(u,{maxRecordCountFactor:s?i.maxRecordCountFactor:void 0,returnExceededLimitFeatures:!1,quantizationParameters:n});c++;try{const t=await this._queue.push({tile:r,query:m,signal:o,depth:l});if(c--,e(o),!t)return;if(p!==this._queryInfo)return void d(u,l);if(t.exceededTransferLimit&&l<i.maxDrillLevel){for(const e of u.createChildTiles())d(e,l+1);return}const s={id:r.id,addOrUpdate:t,end:0===c,type:\"append\"};a.add({query:m,message:s}),this._onMessage(s)}catch(h){t(h)||this._onMessage({id:r.id,addOrUpdate:null,end:!0,type:\"append\"})}};d(r,0)}}export{a as DrillDownFeatureSource};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}