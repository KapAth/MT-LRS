{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as r } from \"../../../chunks/tslib.es6.js\";\nimport t from \"../../../core/Error.js\";\nimport { isNone as e, isSome as s } from \"../../../core/maybe.js\";\nimport { property as a } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as o } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport i from \"./BaseRaster.js\";\nlet n = class extends i {\n  constructor() {\n    super(...arguments), this.datasetFormat = \"Function\", this.tileType = \"Raster\", this.rasterFunction = null;\n  }\n\n  open(r) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.init();\n      const {\n        rasterFunction: e\n      } = _this;\n      _this.primaryRasters?.rasters?.length ? e.sourceRasters = _this.primaryRasters.rasters : _this.primaryRasters = e.getPrimaryRasters();\n      const {\n        rasters: s,\n        rasterIds: a\n      } = _this.primaryRasters,\n            o = s.map(t => t.rasterInfo ? void 0 : t.open(r));\n      yield Promise.all(o);\n      const i = s.map(({\n        rasterInfo: r\n      }) => r),\n            n = e.bind({\n        rasterInfos: i,\n        rasterIds: a\n      });\n      if (!n.success || 0 === i.length) throw new t(\"raster-function:open\", `cannot bind the function: ${n.error ?? \"\"}`);\n      yield _this.syncJobHandler();\n      const c = i[0];\n      _this.hasUniqueSourceStorageInfo = 1 === i.length || i.slice(1).every(r => _this._hasSameStorageInfo(r, c)), _this.set(\"sourceJSON\", s[0].sourceJSON), _this.set(\"rasterInfo\", e.rasterInfo);\n    })();\n  }\n\n  syncJobHandler() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      return _this2.rasterJobHandler?.updateRasterFunction(_this2.rasterFunction);\n    })();\n  }\n\n  fetchPixels(r, t, a, o = {}) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        rasters: i,\n        rasterIds: n\n      } = _this3.primaryRasters,\n            c = i.map(e => e.fetchPixels(r, t, a, o)),\n            p = yield Promise.all(c),\n            l = p.map(r => r.pixelBlock);\n      if (o.skipRasterFunction || l.every(r => e(r))) return p[0];\n      const m = p.find(r => s(r.pixelBlock))?.extent ?? r,\n            u = _this3.rasterJobHandler ? yield _this3.rasterJobHandler.process({\n        extent: m,\n        primaryPixelBlocks: l,\n        primaryRasterIds: n\n      }) : _this3.rasterFunction.process({\n        extent: m,\n        primaryPixelBlocks: l,\n        primaryRasterIds: n\n      });\n      return { ...p[0],\n        pixelBlock: u\n      };\n    })();\n  }\n\n  _hasSameStorageInfo(r, t) {\n    const {\n      storageInfo: e,\n      pixelSize: s,\n      spatialReference: a,\n      extent: o\n    } = r,\n          {\n      storageInfo: i,\n      pixelSize: n,\n      spatialReference: c,\n      extent: p\n    } = t;\n    return s.x === n.x && s.y === n.y && a.equals(c) && o.equals(p) && e.blockHeight === i.blockHeight && e.blockWidth === i.blockWidth && e.maximumPyramidLevel === i.maximumPyramidLevel;\n  }\n\n};\nr([a({\n  type: String,\n  json: {\n    write: !0\n  }\n})], n.prototype, \"datasetFormat\", void 0), r([a()], n.prototype, \"tileType\", void 0), r([a()], n.prototype, \"rasterFunction\", void 0), r([a()], n.prototype, \"primaryRasters\", void 0), n = r([o(\"esri.layers.support.rasterDatasets.FunctionRaster\")], n);\nconst c = n;\nexport { c as default };","map":{"version":3,"names":["_","r","t","isNone","e","isSome","s","property","a","subclass","o","i","n","constructor","arguments","datasetFormat","tileType","rasterFunction","open","init","primaryRasters","rasters","length","sourceRasters","getPrimaryRasters","rasterIds","map","rasterInfo","Promise","all","bind","rasterInfos","success","error","syncJobHandler","c","hasUniqueSourceStorageInfo","slice","every","_hasSameStorageInfo","set","sourceJSON","rasterJobHandler","updateRasterFunction","fetchPixels","p","l","pixelBlock","skipRasterFunction","m","find","extent","u","process","primaryPixelBlocks","primaryRasterIds","storageInfo","pixelSize","spatialReference","x","y","equals","blockHeight","blockWidth","maximumPyramidLevel","type","String","json","write","prototype","default"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/layers/support/rasterDatasets/FunctionRaster.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Error.js\";import{isNone as e,isSome as s}from\"../../../core/maybe.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import i from\"./BaseRaster.js\";let n=class extends i{constructor(){super(...arguments),this.datasetFormat=\"Function\",this.tileType=\"Raster\",this.rasterFunction=null}async open(r){await this.init();const{rasterFunction:e}=this;this.primaryRasters?.rasters?.length?e.sourceRasters=this.primaryRasters.rasters:this.primaryRasters=e.getPrimaryRasters();const{rasters:s,rasterIds:a}=this.primaryRasters,o=s.map((t=>t.rasterInfo?void 0:t.open(r)));await Promise.all(o);const i=s.map((({rasterInfo:r})=>r)),n=e.bind({rasterInfos:i,rasterIds:a});if(!n.success||0===i.length)throw new t(\"raster-function:open\",`cannot bind the function: ${n.error??\"\"}`);await this.syncJobHandler();const c=i[0];this.hasUniqueSourceStorageInfo=1===i.length||i.slice(1).every((r=>this._hasSameStorageInfo(r,c))),this.set(\"sourceJSON\",s[0].sourceJSON),this.set(\"rasterInfo\",e.rasterInfo)}async syncJobHandler(){return this.rasterJobHandler?.updateRasterFunction(this.rasterFunction)}async fetchPixels(r,t,a,o={}){const{rasters:i,rasterIds:n}=this.primaryRasters,c=i.map((e=>e.fetchPixels(r,t,a,o))),p=await Promise.all(c),l=p.map((r=>r.pixelBlock));if(o.skipRasterFunction||l.every((r=>e(r))))return p[0];const m=p.find((r=>s(r.pixelBlock)))?.extent??r,u=this.rasterJobHandler?await this.rasterJobHandler.process({extent:m,primaryPixelBlocks:l,primaryRasterIds:n}):this.rasterFunction.process({extent:m,primaryPixelBlocks:l,primaryRasterIds:n});return{...p[0],pixelBlock:u}}_hasSameStorageInfo(r,t){const{storageInfo:e,pixelSize:s,spatialReference:a,extent:o}=r,{storageInfo:i,pixelSize:n,spatialReference:c,extent:p}=t;return s.x===n.x&&s.y===n.y&&a.equals(c)&&o.equals(p)&&e.blockHeight===i.blockHeight&&e.blockWidth===i.blockWidth&&e.maximumPyramidLevel===i.maximumPyramidLevel}};r([a({type:String,json:{write:!0}})],n.prototype,\"datasetFormat\",void 0),r([a()],n.prototype,\"tileType\",void 0),r([a()],n.prototype,\"rasterFunction\",void 0),r([a()],n.prototype,\"primaryRasters\",void 0),n=r([o(\"esri.layers.support.rasterDatasets.FunctionRaster\")],n);const c=n;export{c as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}