{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isSome as e, unwrapOr as r } from \"../../core/maybe.js\";\nimport { sqlAnd as t } from \"../../core/sql.js\";\nimport { getJsonType as i } from \"../../geometry/support/jsonUtils.js\";\nimport { getScale as n } from \"../../geometry/support/scaleUtils.js\";\nimport { getLayerFloorFilterClause as s } from \"../../layers/support/floorFilterUtils.js\";\nimport { isExportDynamic as o } from \"../../layers/support/sublayerUtils.js\";\n\nconst l = e => e.spatialReference.wkid || JSON.stringify(e.spatialReference);\n\nfunction a(r, t) {\n  const {\n    dpi: n,\n    gdbVersion: s,\n    geometry: o,\n    geometryPrecision: a,\n    height: p,\n    layerOption: m,\n    mapExtent: y,\n    maxAllowableOffset: c,\n    returnFieldName: u,\n    returnGeometry: d,\n    returnUnformattedValues: g,\n    returnZ: x,\n    spatialReference: b,\n    timeExtent: h,\n    tolerance: E,\n    width: O\n  } = r.toJSON(),\n        {\n    dynamicLayers: S,\n    layerDefs: j,\n    layerIds: N\n  } = f(r),\n        J = t && e(t.geometry) ? t.geometry : null,\n        R = {\n    geometryPrecision: a,\n    maxAllowableOffset: c,\n    returnFieldName: u,\n    returnGeometry: d,\n    returnUnformattedValues: g,\n    returnZ: x,\n    tolerance: E\n  },\n        $ = J && J.toJSON() || o;\n\n  if (R.imageDisplay = `${O},${p},${n}`, s && (R.gdbVersion = s), $ && (delete $.spatialReference, R.geometry = JSON.stringify($), R.geometryType = i($)), b ? R.sr = b.wkid || JSON.stringify(b) : $ && $.spatialReference ? R.sr = l($) : y && y.spatialReference && (R.sr = l(y)), R.time = h ? [h.start, h.end].join(\",\") : null, y) {\n    const {\n      xmin: e,\n      ymin: r,\n      xmax: t,\n      ymax: i\n    } = y;\n    R.mapExtent = `${e},${r},${t},${i}`;\n  }\n\n  return j && (R.layerDefs = j), S && !j && (R.dynamicLayers = S), R.layers = \"popup\" === m ? \"visible\" : m, N && !S && (R.layers += `:${N.join(\",\")}`), R;\n}\n\nfunction f(r) {\n  const {\n    mapExtent: t,\n    floors: i,\n    width: l,\n    sublayers: a,\n    layerIds: f,\n    layerOption: m,\n    gdbVersion: y\n  } = r,\n        c = a?.find(e => null != e.layer)?.layer?.serviceSublayers,\n        u = \"popup\" === m,\n        d = {},\n        g = n({\n    extent: t,\n    width: l,\n    spatialReference: t?.spatialReference\n  }),\n        x = [],\n        b = e => {\n    const r = 0 === g,\n          t = 0 === e.minScale || g <= e.minScale,\n          i = 0 === e.maxScale || g >= e.maxScale;\n    if (e.visible && (r || t && i)) if (e.sublayers) e.sublayers.forEach(b);else {\n      if (!1 === f?.includes(e.id) || u && (!e.popupTemplate || !e.popupEnabled)) return;\n      x.unshift(e);\n    }\n  };\n\n  if (a?.forEach(b), a && !x.length) d.layerIds = [];else {\n    const r = o(x, c, y),\n          t = x.map(e => {\n      const r = s(i, e);\n      return e.toExportImageJSON(r);\n    });\n    if (r) d.dynamicLayers = JSON.stringify(t);else {\n      if (a) {\n        let e = x.map(({\n          id: e\n        }) => e);\n        f && (e = e.filter(e => f.includes(e))), d.layerIds = e;\n      } else f?.length && (d.layerIds = f);\n\n      const r = p(i, x);\n\n      if (e(r) && r.length) {\n        const e = {};\n\n        for (const t of r) t.definitionExpression && (e[t.id] = t.definitionExpression);\n\n        Object.keys(e).length && (d.layerDefs = JSON.stringify(e));\n      }\n    }\n  }\n  return d;\n}\n\nfunction p(e, i) {\n  const n = !!e?.length,\n        o = i.filter(e => null != e.definitionExpression || n && null != e.floorInfo);\n  return o.length ? o.map(i => {\n    const n = s(e, i),\n          o = t(n, i.definitionExpression);\n    return {\n      id: i.id,\n      definitionExpression: r(o, void 0)\n    };\n  }) : null;\n}\n\nexport { a as identifyToIdentifyRESTParameters, f as toDynamicLayersJSON };","map":{"version":3,"names":["isSome","e","unwrapOr","r","sqlAnd","t","getJsonType","i","getScale","n","getLayerFloorFilterClause","s","isExportDynamic","o","l","spatialReference","wkid","JSON","stringify","a","dpi","gdbVersion","geometry","geometryPrecision","height","p","layerOption","m","mapExtent","y","maxAllowableOffset","c","returnFieldName","u","returnGeometry","d","returnUnformattedValues","g","returnZ","x","b","timeExtent","h","tolerance","E","width","O","toJSON","dynamicLayers","S","layerDefs","j","layerIds","N","f","J","R","$","imageDisplay","geometryType","sr","time","start","end","join","xmin","ymin","xmax","ymax","layers","floors","sublayers","find","layer","serviceSublayers","extent","minScale","maxScale","visible","forEach","includes","id","popupTemplate","popupEnabled","unshift","length","map","toExportImageJSON","filter","definitionExpression","Object","keys","floorInfo","identifyToIdentifyRESTParameters","toDynamicLayersJSON"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/rest/operations/identify.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isSome as e,unwrapOr as r}from\"../../core/maybe.js\";import{sqlAnd as t}from\"../../core/sql.js\";import{getJsonType as i}from\"../../geometry/support/jsonUtils.js\";import{getScale as n}from\"../../geometry/support/scaleUtils.js\";import{getLayerFloorFilterClause as s}from\"../../layers/support/floorFilterUtils.js\";import{isExportDynamic as o}from\"../../layers/support/sublayerUtils.js\";const l=e=>e.spatialReference.wkid||JSON.stringify(e.spatialReference);function a(r,t){const{dpi:n,gdbVersion:s,geometry:o,geometryPrecision:a,height:p,layerOption:m,mapExtent:y,maxAllowableOffset:c,returnFieldName:u,returnGeometry:d,returnUnformattedValues:g,returnZ:x,spatialReference:b,timeExtent:h,tolerance:E,width:O}=r.toJSON(),{dynamicLayers:S,layerDefs:j,layerIds:N}=f(r),J=t&&e(t.geometry)?t.geometry:null,R={geometryPrecision:a,maxAllowableOffset:c,returnFieldName:u,returnGeometry:d,returnUnformattedValues:g,returnZ:x,tolerance:E},$=J&&J.toJSON()||o;if(R.imageDisplay=`${O},${p},${n}`,s&&(R.gdbVersion=s),$&&(delete $.spatialReference,R.geometry=JSON.stringify($),R.geometryType=i($)),b?R.sr=b.wkid||JSON.stringify(b):$&&$.spatialReference?R.sr=l($):y&&y.spatialReference&&(R.sr=l(y)),R.time=h?[h.start,h.end].join(\",\"):null,y){const{xmin:e,ymin:r,xmax:t,ymax:i}=y;R.mapExtent=`${e},${r},${t},${i}`}return j&&(R.layerDefs=j),S&&!j&&(R.dynamicLayers=S),R.layers=\"popup\"===m?\"visible\":m,N&&!S&&(R.layers+=`:${N.join(\",\")}`),R}function f(r){const{mapExtent:t,floors:i,width:l,sublayers:a,layerIds:f,layerOption:m,gdbVersion:y}=r,c=a?.find((e=>null!=e.layer))?.layer?.serviceSublayers,u=\"popup\"===m,d={},g=n({extent:t,width:l,spatialReference:t?.spatialReference}),x=[],b=e=>{const r=0===g,t=0===e.minScale||g<=e.minScale,i=0===e.maxScale||g>=e.maxScale;if(e.visible&&(r||t&&i))if(e.sublayers)e.sublayers.forEach(b);else{if(!1===f?.includes(e.id)||u&&(!e.popupTemplate||!e.popupEnabled))return;x.unshift(e)}};if(a?.forEach(b),a&&!x.length)d.layerIds=[];else{const r=o(x,c,y),t=x.map((e=>{const r=s(i,e);return e.toExportImageJSON(r)}));if(r)d.dynamicLayers=JSON.stringify(t);else{if(a){let e=x.map((({id:e})=>e));f&&(e=e.filter((e=>f.includes(e)))),d.layerIds=e}else f?.length&&(d.layerIds=f);const r=p(i,x);if(e(r)&&r.length){const e={};for(const t of r)t.definitionExpression&&(e[t.id]=t.definitionExpression);Object.keys(e).length&&(d.layerDefs=JSON.stringify(e))}}}return d}function p(e,i){const n=!!e?.length,o=i.filter((e=>null!=e.definitionExpression||n&&null!=e.floorInfo));return o.length?o.map((i=>{const n=s(e,i),o=t(n,i.definitionExpression);return{id:i.id,definitionExpression:r(o,void 0)}})):null}export{a as identifyToIdentifyRESTParameters,f as toDynamicLayersJSON};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}