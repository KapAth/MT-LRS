{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { isNone as t, isSome as n, unwrap as e, assertIsSome as i } from \"../../../core/maybe.js\";\nimport s from \"../PixelBlock.js\";\nimport { getPixelValueRange as o } from \"../rasterFormats/pixelRangeUtils.js\";\nimport { stretchTypeFunctionEnum as r } from \"../../../renderers/support/stretchRendererUtils.js\";\nconst a = 1,\n      l = [.299, .587, .114];\n\nfunction f(t, n = 256) {\n  n = Math.min(n, 256);\n  const {\n    size: e,\n    counts: i\n  } = t,\n        s = new Uint8Array(e),\n        o = i.reduce((t, e) => t + e / n, 0);\n  let r = 0,\n      a = 0,\n      l = 0,\n      f = o;\n\n  for (let u = 0; u < e; u++) if (l += i[u], !(u < e - 1 && l + i[u + 1] < f)) {\n    for (; r < n - 1 && f < l;) r++, f += o;\n\n    for (let t = a; t <= u; t++) s[t] = r;\n\n    a = u + 1;\n  }\n\n  for (let u = a; u < e; u++) s[u] = n - 1;\n\n  return s;\n}\n\nfunction u(t) {\n  const {\n    minCutOff: n,\n    maxCutOff: e,\n    gamma: i,\n    pixelType: s,\n    rounding: o\n  } = t,\n        r = t.outMin || 0,\n        a = t.outMax || 255;\n  if (![\"u8\", \"u16\", \"s8\", \"s16\"].includes(s)) return null;\n  const l = n.length;\n  let f,\n      u,\n      c = 0;\n  \"s8\" === s ? c = -127 : \"s16\" === s && (c = -32767);\n  let h = 256;\n  [\"u16\", \"s16\"].includes(s) && (h = 65536);\n  const p = [],\n        g = [],\n        x = a - r;\n\n  for (f = 0; f < l; f++) g[f] = e[f] - n[f], p[f] = 0 === g[f] ? 0 : x / g[f];\n\n  let d;\n  const y = [];\n  let C, O, b;\n\n  if (i && i.length >= l) {\n    const t = M(l, i);\n\n    for (f = 0; f < l; f++) {\n      for (b = [], u = 0; u < h; u++) if (0 !== g[f]) {\n        if (C = u + c, d = (C - n[f]) / g[f], O = 1, i[f] > 1 && (O -= (1 / x) ** (d * t[f])), C < e[f] && C > n[f]) {\n          const t = O * x * d ** (1 / i[f]) + r;\n          b[u] = \"floor\" === o ? Math.floor(t) : \"round\" === o ? Math.round(t) : t;\n        } else C >= e[f] ? b[u] = a : b[u] = r;\n      } else b[u] = r;\n\n      y[f] = b;\n    }\n  } else for (f = 0; f < l; f++) {\n    for (b = [], u = 0; u < h; u++) if (C = u + c, C <= n[f]) b[u] = r;else if (C >= e[f]) b[u] = a;else {\n      const t = (C - n[f]) * p[f] + r;\n      b[u] = \"floor\" === o ? Math.floor(t) : \"round\" === o ? Math.round(t) : t;\n    }\n\n    y[f] = b;\n  }\n\n  if (null != t.contrastOffset) {\n    const n = m(t.contrastOffset, t.brightnessOffset);\n\n    for (f = 0; f < l; f++) for (b = y[f], u = 0; u < h; u++) b[u] = n[b[u]];\n  }\n\n  return {\n    lut: y,\n    offset: c\n  };\n}\n\nfunction m(t, n) {\n  const e = Math.min(Math.max(t, -100), 100),\n        i = Math.min(Math.max(n ?? 0, -100), 100),\n        s = 255,\n        o = 128;\n  let r = 0,\n      a = 0;\n  const l = new Uint8Array(256);\n\n  for (r = 0; r < 256; r++) e > 0 && e < 100 ? a = (200 * r - 100 * s + 2 * s * i) / (2 * (100 - e)) + o : e <= 0 && e > -100 ? a = (200 * r - 100 * s + 2 * s * i) * (100 + e) / 2e4 + o : 100 === e ? (a = 200 * r - 100 * s + (s + 1) * (100 - e) + 2 * s * i, a = a > 0 ? s : 0) : -100 === e && (a = o), l[r] = a > s ? s : a < 0 ? 0 : a;\n\n  return l;\n}\n\nfunction c(t, n, e) {\n  const i = [];\n\n  for (let s = 0; s < n.length; s++) {\n    let o = 0,\n        r = 0,\n        a = 0;\n    \"min\" in n[s] ? ({\n      min: o,\n      max: r,\n      avg: a\n    } = n[s]) : [o, r, a] = n[s];\n    let f = a ?? 0;\n    \"u8\" !== t && (f = 255 * (f - o) / (r - o)), e && (f *= l[s]), i.push(h(f));\n  }\n\n  return i;\n}\n\nfunction h(t) {\n  if (t <= 0 || t >= 255) return a;\n  let n = 0;\n  150 !== t && (n = t <= 150 ? 45 * Math.cos(.01047 * t) : 17 * Math.sin(.021 * t));\n  const e = 255,\n        i = t + n,\n        s = Math.log(t / e),\n        o = Math.log(i / e);\n  if (0 === o) return a;\n  const r = s / o;\n  return isNaN(r) ? a : Math.min(9.9, Math.max(.01, r));\n}\n\nfunction p(n) {\n  if (t(n) || !n.pixels?.length) return null;\n  const {\n    pixels: e,\n    mask: i,\n    pixelType: s\n  } = n,\n        o = n.width * n.height,\n        r = e.length;\n  let a, l, f, u, m;\n  const c = [],\n        h = [];\n  let p, g, x, d, M, y, C, O, b, v;\n  const k = 256;\n\n  for (u = 0; u < r; u++) {\n    if (p = new Uint32Array(k), x = e[u], \"u8\" === s) {\n      if (a = -.5, l = 255.5, i) for (m = 0; m < o; m++) i[m] && p[x[m]]++;else for (m = 0; m < o; m++) p[x[m]]++;\n    } else {\n      let t = !1;\n      n.statistics || (n.updateStatistics(), t = !0);\n      const e = n.statistics;\n\n      if (a = e[u].minValue, l = e[u].maxValue, f = (l - a) / k, 0 === f) {\n        !e || n.validPixelCount || t || n.updateStatistics();\n        const i = (n.validPixelCount || n.width * n.height) / k;\n\n        for (let t = 0; t < k; t++) p[t] = Math.round(i * (t + 1)) - Math.round(i * t);\n      } else {\n        for (g = new Uint32Array(k + 1), m = 0; m < o; m++) i && !i[m] || g[Math.floor((x[m] - a) / f)]++;\n\n        for (m = 0; m < k - 1; m++) p[m] = g[m];\n\n        p[k - 1] = g[k - 1] + g[k];\n      }\n    }\n\n    for (c.push({\n      min: a,\n      max: l,\n      size: k,\n      counts: p\n    }), d = 0, M = 0, O = 0, m = 0; m < k; m++) d += p[m], M += m * p[m];\n\n    for (b = M / d, m = 0; m < k; m++) O += p[m] * (m - b) ** 2;\n\n    v = Math.sqrt(O / (d - 1)), f = (l - a) / k, y = (b + .5) * f + a, C = v * f, h.push({\n      min: a,\n      max: l,\n      avg: y,\n      stddev: C\n    });\n  }\n\n  return {\n    statistics: h,\n    histograms: c\n  };\n}\n\nfunction g(t) {\n  const n = [];\n\n  for (let e = 0; e < t.length; e++) {\n    const {\n      min: i,\n      max: s,\n      size: o,\n      counts: r\n    } = t[e];\n    let a = 0,\n        l = 0;\n\n    for (let t = 0; t < o; t++) a += r[t], l += t * r[t];\n\n    const f = l / a;\n    let u = 0;\n\n    for (let t = 0; t < o; t++) u += r[t] * (t - f) ** 2;\n\n    const m = (s - i) / o,\n          c = (f + .5) * m + i,\n          h = Math.sqrt(u / (a - 1)) * m;\n    n.push({\n      min: i,\n      max: s,\n      avg: c,\n      stddev: h\n    });\n  }\n\n  return n;\n}\n\nfunction x(t, s) {\n  const {\n    pixelBlock: a,\n    bandIds: l,\n    returnHistogramLut: u,\n    rasterInfo: m\n  } = s;\n  let c = null,\n      h = null,\n      g = t.stretchType;\n  if (\"number\" == typeof g && (g = r[g]), t.dra) {\n    if (\"minMax\" === g && n(a) && a.statistics) c = a.statistics.map(t => [t.minValue, t.maxValue, 0, 0]);else {\n      const t = p(a);\n      c = n(t) ? t.statistics : null, h = n(t) ? t.histograms : null;\n    }\n  } else c = t.statistics?.length > 0 ? t.statistics : e(m.statistics), h = t.histograms || e(m.histograms);\n  \"percentClip\" !== g && \"histogramEqualization\" !== g || h?.length || (g = \"minMax\");\n  const x = c?.length || h?.length || m.bandCount,\n        M = [],\n        y = [];\n  let C, O, b, v, k, w, z, A, U;\n  c && !Array.isArray(c[0]) && (c = c.map(t => [t.min, t.max, t.avg, t.stddev]));\n  const [P, T] = o(m.pixelType);\n\n  if (!c?.length) {\n    for (c = [], A = 0; A < x; A++) c.push([P, T, 1, 1]);\n\n    \"standardDeviation\" === g && (g = \"minMax\");\n  }\n\n  switch (g) {\n    case \"none\":\n      for (A = 0; A < x; A++) M[A] = P, y[A] = T;\n\n      break;\n\n    case \"minMax\":\n      for (A = 0; A < x; A++) M[A] = c[A][0], y[A] = c[A][1];\n\n      break;\n\n    case \"standardDeviation\":\n      for (A = 0; A < x; A++) M[A] = c[A][2] - t.numberOfStandardDeviations * c[A][3], y[A] = c[A][2] + t.numberOfStandardDeviations * c[A][3], M[A] < c[A][0] && (M[A] = c[A][0]), y[A] > c[A][1] && (y[A] = c[A][1]);\n\n      break;\n\n    case \"histogramEqualization\":\n      for (i(h), A = 0; A < x; A++) M[A] = h[A].min, y[A] = h[A].max;\n\n      break;\n\n    case \"percentClip\":\n      for (i(h), A = 0; A < h.length; A++) {\n        for (C = h[A], k = new Uint32Array(C.size), v = [...C.counts], v.length >= 20 && (v[0] = v[1] = v[2] = v[v.length - 1] = v[v.length - 2] = 0), b = 0, O = (C.max - C.min) / C.size, z = -.5 === C.min && 1 === O ? .5 : 0, U = 0; U < C.size; U++) b += v[U], k[U] = b;\n\n        for (w = (t.minPercent || 0) * b / 100, M[A] = C.min + z, U = 0; U < C.size; U++) if (k[U] > w) {\n          M[A] = C.min + O * (U + z);\n          break;\n        }\n\n        for (w = (1 - (t.maxPercent || 0) / 100) * b, y[A] = C.max + z, U = C.size - 2; U >= 0; U--) if (k[U] < w) {\n          y[A] = C.min + O * (U + 2 - z);\n          break;\n        }\n\n        if (y[A] < M[A]) {\n          const t = M[A];\n          M[A] = y[A], y[A] = t;\n        }\n      }\n\n      break;\n\n    default:\n      for (A = 0; A < x; A++) M[A] = c[A][0], y[A] = c[A][1];\n\n  }\n\n  let q, S, j;\n  \"histogramEqualization\" === g ? (i(h), S = h[0].size || 256, q = 0, u && (j = h.map(t => f(t)))) : (S = t.max || 255, q = t.min || 0);\n  return d({\n    minCutOff: M,\n    maxCutOff: y,\n    outMax: S,\n    outMin: q,\n    histogramLut: j\n  }, l);\n}\n\nfunction d(t, n) {\n  if (null == n || 0 === n.length) return t;\n  const e = Math.max.apply(null, n),\n        {\n    minCutOff: i,\n    maxCutOff: s,\n    outMin: o,\n    outMax: r,\n    histogramLut: a\n  } = t;\n  return i.length === n.length || i.length <= e ? t : {\n    minCutOff: n.map(t => i[t]),\n    maxCutOff: n.map(t => s[t]),\n    histogramLut: a ? n.map(t => a[t]) : null,\n    outMin: o,\n    outMax: r\n  };\n}\n\nfunction M(t, n) {\n  const e = new Float32Array(t);\n\n  for (let i = 0; i < t; i++) n[i] > 1 ? n[i] > 2 ? e[i] = 6.5 + (n[i] - 2) ** 2.5 : e[i] = 6.5 + 100 * (2 - n[i]) ** 4 : e[i] = 1;\n\n  return e;\n}\n\nfunction y(n, e) {\n  if (t(n) || !n.pixels?.length) return n;\n  const {\n    mask: i,\n    width: o,\n    height: r,\n    pixels: a\n  } = n,\n        {\n    minCutOff: l,\n    maxCutOff: f,\n    gamma: u\n  } = e,\n        m = e.outMin || 0,\n        c = e.outMax || 255,\n        h = o * r,\n        p = e.outputPixelType || \"u8\",\n        g = n.pixels.map(() => s.createEmptyBand(p, h)),\n        x = g.length;\n  let d, y, C, O, b;\n  const v = c - m,\n        k = [],\n        w = [];\n\n  for (d = 0; d < x; d++) w[d] = f[d] - l[d], k[d] = 0 === w[d] ? 0 : v / w[d];\n\n  const z = p.startsWith(\"u\") || p.startsWith(\"s\"),\n        A = u && u.length >= x,\n        U = !!e.isRenderer;\n\n  if (A) {\n    const t = M(x, u);\n\n    for (y = 0; y < h; y++) if (null == i || i[y]) for (d = 0; d < x; d++) if (0 !== w[d]) {\n      if (C = a[d][y], b = (C - l[d]) / w[d], O = 1, u[d] > 1 && (O -= (1 / v) ** (b * t[d])), C < f[d] && C > l[d]) {\n        const t = O * v * b ** (1 / u[d]) + m;\n        g[d][y] = U ? Math.floor(t) : z ? Math.round(t) : t;\n      } else C >= f[d] ? g[d][y] = c : g[d][y] = m;\n    } else g[d][y] = m;\n  } else for (y = 0; y < h; y++) if (null == i || i[y]) for (d = 0; d < x; d++) if (C = a[d][y], C < f[d] && C > l[d]) {\n    const t = (C - l[d]) * k[d] + m;\n    g[d][y] = U ? Math.floor(t) : z ? Math.round(t) : t;\n  } else C >= f[d] ? g[d][y] = c : g[d][y] = m;\n\n  const P = new s({\n    width: o,\n    height: r,\n    mask: i,\n    pixels: g,\n    pixelType: p\n  });\n  return P.updateStatistics(), P;\n}\n\nexport { M as computeGammaCorrection, c as computeGammaValues, m as createContrastBrightnessLUT, f as createHistogramEqualizationLUT, u as createStretchLUT, g as estimateStatisticsFromHistograms, p as estimateStatisticsHistograms, x as getStretchCutoff, y as stretch };","map":{"version":3,"names":["isNone","t","isSome","n","unwrap","e","assertIsSome","i","s","getPixelValueRange","o","stretchTypeFunctionEnum","r","a","l","f","Math","min","size","counts","Uint8Array","reduce","u","minCutOff","maxCutOff","gamma","pixelType","rounding","outMin","outMax","includes","length","c","h","p","g","x","d","y","C","O","b","M","floor","round","contrastOffset","m","brightnessOffset","lut","offset","max","avg","push","cos","sin","log","isNaN","pixels","mask","width","height","v","k","Uint32Array","statistics","updateStatistics","minValue","maxValue","validPixelCount","sqrt","stddev","histograms","pixelBlock","bandIds","returnHistogramLut","rasterInfo","stretchType","dra","map","bandCount","w","z","A","U","Array","isArray","P","T","numberOfStandardDeviations","minPercent","maxPercent","q","S","j","histogramLut","apply","Float32Array","outputPixelType","createEmptyBand","startsWith","isRenderer","computeGammaCorrection","computeGammaValues","createContrastBrightnessLUT","createHistogramEqualizationLUT","createStretchLUT","estimateStatisticsFromHistograms","estimateStatisticsHistograms","getStretchCutoff","stretch"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/layers/support/rasterFunctions/stretchUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{isNone as t,isSome as n,unwrap as e,assertIsSome as i}from\"../../../core/maybe.js\";import s from\"../PixelBlock.js\";import{getPixelValueRange as o}from\"../rasterFormats/pixelRangeUtils.js\";import{stretchTypeFunctionEnum as r}from\"../../../renderers/support/stretchRendererUtils.js\";const a=1,l=[.299,.587,.114];function f(t,n=256){n=Math.min(n,256);const{size:e,counts:i}=t,s=new Uint8Array(e),o=i.reduce(((t,e)=>t+e/n),0);let r=0,a=0,l=0,f=o;for(let u=0;u<e;u++)if(l+=i[u],!(u<e-1&&l+i[u+1]<f)){for(;r<n-1&&f<l;)r++,f+=o;for(let t=a;t<=u;t++)s[t]=r;a=u+1}for(let u=a;u<e;u++)s[u]=n-1;return s}function u(t){const{minCutOff:n,maxCutOff:e,gamma:i,pixelType:s,rounding:o}=t,r=t.outMin||0,a=t.outMax||255;if(![\"u8\",\"u16\",\"s8\",\"s16\"].includes(s))return null;const l=n.length;let f,u,c=0;\"s8\"===s?c=-127:\"s16\"===s&&(c=-32767);let h=256;[\"u16\",\"s16\"].includes(s)&&(h=65536);const p=[],g=[],x=a-r;for(f=0;f<l;f++)g[f]=e[f]-n[f],p[f]=0===g[f]?0:x/g[f];let d;const y=[];let C,O,b;if(i&&i.length>=l){const t=M(l,i);for(f=0;f<l;f++){for(b=[],u=0;u<h;u++)if(0!==g[f])if(C=u+c,d=(C-n[f])/g[f],O=1,i[f]>1&&(O-=(1/x)**(d*t[f])),C<e[f]&&C>n[f]){const t=O*x*d**(1/i[f])+r;b[u]=\"floor\"===o?Math.floor(t):\"round\"===o?Math.round(t):t}else C>=e[f]?b[u]=a:b[u]=r;else b[u]=r;y[f]=b}}else for(f=0;f<l;f++){for(b=[],u=0;u<h;u++)if(C=u+c,C<=n[f])b[u]=r;else if(C>=e[f])b[u]=a;else{const t=(C-n[f])*p[f]+r;b[u]=\"floor\"===o?Math.floor(t):\"round\"===o?Math.round(t):t}y[f]=b}if(null!=t.contrastOffset){const n=m(t.contrastOffset,t.brightnessOffset);for(f=0;f<l;f++)for(b=y[f],u=0;u<h;u++)b[u]=n[b[u]]}return{lut:y,offset:c}}function m(t,n){const e=Math.min(Math.max(t,-100),100),i=Math.min(Math.max(n??0,-100),100),s=255,o=128;let r=0,a=0;const l=new Uint8Array(256);for(r=0;r<256;r++)e>0&&e<100?a=(200*r-100*s+2*s*i)/(2*(100-e))+o:e<=0&&e>-100?a=(200*r-100*s+2*s*i)*(100+e)/2e4+o:100===e?(a=200*r-100*s+(s+1)*(100-e)+2*s*i,a=a>0?s:0):-100===e&&(a=o),l[r]=a>s?s:a<0?0:a;return l}function c(t,n,e){const i=[];for(let s=0;s<n.length;s++){let o=0,r=0,a=0;\"min\"in n[s]?({min:o,max:r,avg:a}=n[s]):[o,r,a]=n[s];let f=a??0;\"u8\"!==t&&(f=255*(f-o)/(r-o)),e&&(f*=l[s]),i.push(h(f))}return i}function h(t){if(t<=0||t>=255)return a;let n=0;150!==t&&(n=t<=150?45*Math.cos(.01047*t):17*Math.sin(.021*t));const e=255,i=t+n,s=Math.log(t/e),o=Math.log(i/e);if(0===o)return a;const r=s/o;return isNaN(r)?a:Math.min(9.9,Math.max(.01,r))}function p(n){if(t(n)||!n.pixels?.length)return null;const{pixels:e,mask:i,pixelType:s}=n,o=n.width*n.height,r=e.length;let a,l,f,u,m;const c=[],h=[];let p,g,x,d,M,y,C,O,b,v;const k=256;for(u=0;u<r;u++){if(p=new Uint32Array(k),x=e[u],\"u8\"===s)if(a=-.5,l=255.5,i)for(m=0;m<o;m++)i[m]&&p[x[m]]++;else for(m=0;m<o;m++)p[x[m]]++;else{let t=!1;n.statistics||(n.updateStatistics(),t=!0);const e=n.statistics;if(a=e[u].minValue,l=e[u].maxValue,f=(l-a)/k,0===f){!e||n.validPixelCount||t||n.updateStatistics();const i=(n.validPixelCount||n.width*n.height)/k;for(let t=0;t<k;t++)p[t]=Math.round(i*(t+1))-Math.round(i*t)}else{for(g=new Uint32Array(k+1),m=0;m<o;m++)i&&!i[m]||g[Math.floor((x[m]-a)/f)]++;for(m=0;m<k-1;m++)p[m]=g[m];p[k-1]=g[k-1]+g[k]}}for(c.push({min:a,max:l,size:k,counts:p}),d=0,M=0,O=0,m=0;m<k;m++)d+=p[m],M+=m*p[m];for(b=M/d,m=0;m<k;m++)O+=p[m]*(m-b)**2;v=Math.sqrt(O/(d-1)),f=(l-a)/k,y=(b+.5)*f+a,C=v*f,h.push({min:a,max:l,avg:y,stddev:C})}return{statistics:h,histograms:c}}function g(t){const n=[];for(let e=0;e<t.length;e++){const{min:i,max:s,size:o,counts:r}=t[e];let a=0,l=0;for(let t=0;t<o;t++)a+=r[t],l+=t*r[t];const f=l/a;let u=0;for(let t=0;t<o;t++)u+=r[t]*(t-f)**2;const m=(s-i)/o,c=(f+.5)*m+i,h=Math.sqrt(u/(a-1))*m;n.push({min:i,max:s,avg:c,stddev:h})}return n}function x(t,s){const{pixelBlock:a,bandIds:l,returnHistogramLut:u,rasterInfo:m}=s;let c=null,h=null,g=t.stretchType;if(\"number\"==typeof g&&(g=r[g]),t.dra)if(\"minMax\"===g&&n(a)&&a.statistics)c=a.statistics.map((t=>[t.minValue,t.maxValue,0,0]));else{const t=p(a);c=n(t)?t.statistics:null,h=n(t)?t.histograms:null}else c=t.statistics?.length>0?t.statistics:e(m.statistics),h=t.histograms||e(m.histograms);\"percentClip\"!==g&&\"histogramEqualization\"!==g||h?.length||(g=\"minMax\");const x=c?.length||h?.length||m.bandCount,M=[],y=[];let C,O,b,v,k,w,z,A,U;c&&!Array.isArray(c[0])&&(c=c.map((t=>[t.min,t.max,t.avg,t.stddev])));const[P,T]=o(m.pixelType);if(!c?.length){for(c=[],A=0;A<x;A++)c.push([P,T,1,1]);\"standardDeviation\"===g&&(g=\"minMax\")}switch(g){case\"none\":for(A=0;A<x;A++)M[A]=P,y[A]=T;break;case\"minMax\":for(A=0;A<x;A++)M[A]=c[A][0],y[A]=c[A][1];break;case\"standardDeviation\":for(A=0;A<x;A++)M[A]=c[A][2]-t.numberOfStandardDeviations*c[A][3],y[A]=c[A][2]+t.numberOfStandardDeviations*c[A][3],M[A]<c[A][0]&&(M[A]=c[A][0]),y[A]>c[A][1]&&(y[A]=c[A][1]);break;case\"histogramEqualization\":for(i(h),A=0;A<x;A++)M[A]=h[A].min,y[A]=h[A].max;break;case\"percentClip\":for(i(h),A=0;A<h.length;A++){for(C=h[A],k=new Uint32Array(C.size),v=[...C.counts],v.length>=20&&(v[0]=v[1]=v[2]=v[v.length-1]=v[v.length-2]=0),b=0,O=(C.max-C.min)/C.size,z=-.5===C.min&&1===O?.5:0,U=0;U<C.size;U++)b+=v[U],k[U]=b;for(w=(t.minPercent||0)*b/100,M[A]=C.min+z,U=0;U<C.size;U++)if(k[U]>w){M[A]=C.min+O*(U+z);break}for(w=(1-(t.maxPercent||0)/100)*b,y[A]=C.max+z,U=C.size-2;U>=0;U--)if(k[U]<w){y[A]=C.min+O*(U+2-z);break}if(y[A]<M[A]){const t=M[A];M[A]=y[A],y[A]=t}}break;default:for(A=0;A<x;A++)M[A]=c[A][0],y[A]=c[A][1]}let q,S,j;\"histogramEqualization\"===g?(i(h),S=h[0].size||256,q=0,u&&(j=h.map((t=>f(t))))):(S=t.max||255,q=t.min||0);return d({minCutOff:M,maxCutOff:y,outMax:S,outMin:q,histogramLut:j},l)}function d(t,n){if(null==n||0===n.length)return t;const e=Math.max.apply(null,n),{minCutOff:i,maxCutOff:s,outMin:o,outMax:r,histogramLut:a}=t;return i.length===n.length||i.length<=e?t:{minCutOff:n.map((t=>i[t])),maxCutOff:n.map((t=>s[t])),histogramLut:a?n.map((t=>a[t])):null,outMin:o,outMax:r}}function M(t,n){const e=new Float32Array(t);for(let i=0;i<t;i++)n[i]>1?n[i]>2?e[i]=6.5+(n[i]-2)**2.5:e[i]=6.5+100*(2-n[i])**4:e[i]=1;return e}function y(n,e){if(t(n)||!n.pixels?.length)return n;const{mask:i,width:o,height:r,pixels:a}=n,{minCutOff:l,maxCutOff:f,gamma:u}=e,m=e.outMin||0,c=e.outMax||255,h=o*r,p=e.outputPixelType||\"u8\",g=n.pixels.map((()=>s.createEmptyBand(p,h))),x=g.length;let d,y,C,O,b;const v=c-m,k=[],w=[];for(d=0;d<x;d++)w[d]=f[d]-l[d],k[d]=0===w[d]?0:v/w[d];const z=p.startsWith(\"u\")||p.startsWith(\"s\"),A=u&&u.length>=x,U=!!e.isRenderer;if(A){const t=M(x,u);for(y=0;y<h;y++)if(null==i||i[y])for(d=0;d<x;d++)if(0!==w[d])if(C=a[d][y],b=(C-l[d])/w[d],O=1,u[d]>1&&(O-=(1/v)**(b*t[d])),C<f[d]&&C>l[d]){const t=O*v*b**(1/u[d])+m;g[d][y]=U?Math.floor(t):z?Math.round(t):t}else C>=f[d]?g[d][y]=c:g[d][y]=m;else g[d][y]=m}else for(y=0;y<h;y++)if(null==i||i[y])for(d=0;d<x;d++)if(C=a[d][y],C<f[d]&&C>l[d]){const t=(C-l[d])*k[d]+m;g[d][y]=U?Math.floor(t):z?Math.round(t):t}else C>=f[d]?g[d][y]=c:g[d][y]=m;const P=new s({width:o,height:r,mask:i,pixels:g,pixelType:p});return P.updateStatistics(),P}export{M as computeGammaCorrection,c as computeGammaValues,m as createContrastBrightnessLUT,f as createHistogramEqualizationLUT,u as createStretchLUT,g as estimateStatisticsFromHistograms,p as estimateStatisticsHistograms,x as getStretchCutoff,y as stretch};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}