{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport \"../../../geometry.js\";\nimport e from \"../../../core/Error.js\";\nimport has from \"../../../core/has.js\";\nimport { unwrap as s } from \"../../../core/maybe.js\";\nimport { eachAlways as r, createAbortError as a } from \"../../../core/promiseUtils.js\";\nimport { property as o } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as i } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport n from \"./BaseRaster.js\";\nimport m from \"./InMemoryRaster.js\";\nimport { parsePAMInfo as l } from \"./pamParser.js\";\nimport { getFormat as p } from \"../rasterFormats/RasterCodec.js\";\nimport { estimateStatisticsFromHistograms as c } from \"../rasterFunctions/stretchUtils.js\";\nimport f from \"../rasterTransforms/PolynomialTransform.js\";\nimport u from \"../../../geometry/SpatialReference.js\";\nimport h from \"../../../geometry/Extent.js\";\nlet d = class extends n {\n  open(t) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this.init();\n      const e = yield _this._fetchData(t);\n      let {\n        spatialReference: s,\n        statistics: r,\n        histograms: a,\n        transform: o\n      } = yield _this._fetchAuxiliaryData(t);\n      const i = !s;\n      i && (s = new u({\n        wkid: 3857\n      })), a?.length && null == r && (r = c(a));\n      const {\n        width: n,\n        height: l\n      } = e;\n      let p = new h({\n        xmin: -.5,\n        ymin: .5 - l,\n        xmax: n - .5,\n        ymax: .5,\n        spatialReference: s\n      });\n      const f = o ? o.forwardTransform(p) : p;\n      let d = !0;\n\n      if (o) {\n        const t = o.forwardCoefficients;\n        d = t && 0 === t[1] && 0 === t[2], d && (o = null, p = f);\n      }\n\n      const w = new m({\n        data: {\n          extent: f,\n          nativeExtent: p,\n          transform: o,\n          pixelBlock: e,\n          statistics: r,\n          histograms: a,\n          keyProperties: {\n            DateType: \"Processed\"\n          },\n          isPseudoSpatialReference: i\n        }\n      });\n      yield w.open(), w.data = null, _this._set(\"rasterInfo\", w.rasterInfo), _this._inMemoryRaster = w;\n    })();\n  }\n\n  fetchRawTile(t, e, s, r = {}) {\n    return this._inMemoryRaster.fetchRawTile(t, e, s, r);\n  }\n\n  _fetchData(t) {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      const {\n        data: s\n      } = yield _this2.request(_this2.url, {\n        responseType: \"array-buffer\",\n        signal: t?.signal\n      }),\n            r = p(s).toUpperCase();\n      if (\"JPG\" !== r && \"PNG\" !== r && \"GIF\" !== r && \"BMP\" !== r) throw new e(\"image-aux-raster:open\", \"the data is not a supported format\");\n\n      _this2._set(\"datasetFormat\", r);\n\n      const a = r.toLowerCase(),\n            o = \"gif\" === a || \"bmp\" === a || !has(\"ios\"),\n            i = yield _this2.decodePixelBlock(s, {\n        format: a,\n        useCanvas: o,\n        hasNoZlibMask: !0\n      });\n      if (null == i) throw new e(\"image-aux-raster:open\", \"the data cannot be decoded\");\n      return i;\n    })();\n  }\n\n  _fetchAuxiliaryData(t) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      const e = s(t?.signal),\n            o = _this3.ioConfig.skipExtensions ?? [],\n            i = o.includes(\"aux.xml\") ? null : _this3.request(_this3.url + \".aux.xml\", {\n        responseType: \"xml\",\n        signal: e\n      }),\n            n = _this3.datasetFormat,\n            m = \"JPG\" === n ? \"jgw\" : \"PNG\" === n ? \"pgw\" : \"BMP\" === n ? \"bpw\" : null,\n            p = m && o.includes(m) ? null : _this3.request(_this3.url.slice(0, _this3.url.lastIndexOf(\".\")) + \".\" + m, {\n        responseType: \"text\",\n        signal: e\n      }),\n            c = yield r([i, p]);\n      if (e?.aborted) throw a();\n      const u = l(c[0].value?.data);\n\n      if (!u.transform) {\n        const t = c[1].value ? c[1].value.data.split(\"\\n\").slice(0, 6).map(t => Number(t)) : null;\n        u.transform = 6 === t?.length ? new f({\n          forwardCoefficients: [t[4], t[5], t[0], -t[1], t[2], -t[3]]\n        }) : null;\n      }\n\n      return u;\n    })();\n  }\n\n};\nt([o({\n  type: String,\n  json: {\n    write: !0\n  }\n})], d.prototype, \"datasetFormat\", void 0), d = t([i(\"esri.layers.support.rasterDatasets.ImageAuxRaster\")], d);\nconst w = d;\nexport { w as default };","map":{"version":3,"names":["_","t","e","has","unwrap","s","eachAlways","r","createAbortError","a","property","o","subclass","i","n","m","parsePAMInfo","l","getFormat","p","estimateStatisticsFromHistograms","c","f","u","h","d","open","init","_fetchData","spatialReference","statistics","histograms","transform","_fetchAuxiliaryData","wkid","length","width","height","xmin","ymin","xmax","ymax","forwardTransform","forwardCoefficients","w","data","extent","nativeExtent","pixelBlock","keyProperties","DateType","isPseudoSpatialReference","_set","rasterInfo","_inMemoryRaster","fetchRawTile","request","url","responseType","signal","toUpperCase","toLowerCase","decodePixelBlock","format","useCanvas","hasNoZlibMask","ioConfig","skipExtensions","includes","datasetFormat","slice","lastIndexOf","aborted","value","split","map","Number","type","String","json","write","prototype","default"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/layers/support/rasterDatasets/ImageAuxRaster.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import\"../../../geometry.js\";import e from\"../../../core/Error.js\";import has from\"../../../core/has.js\";import{unwrap as s}from\"../../../core/maybe.js\";import{eachAlways as r,createAbortError as a}from\"../../../core/promiseUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import n from\"./BaseRaster.js\";import m from\"./InMemoryRaster.js\";import{parsePAMInfo as l}from\"./pamParser.js\";import{getFormat as p}from\"../rasterFormats/RasterCodec.js\";import{estimateStatisticsFromHistograms as c}from\"../rasterFunctions/stretchUtils.js\";import f from\"../rasterTransforms/PolynomialTransform.js\";import u from\"../../../geometry/SpatialReference.js\";import h from\"../../../geometry/Extent.js\";let d=class extends n{async open(t){await this.init();const e=await this._fetchData(t);let{spatialReference:s,statistics:r,histograms:a,transform:o}=await this._fetchAuxiliaryData(t);const i=!s;i&&(s=new u({wkid:3857})),a?.length&&null==r&&(r=c(a));const{width:n,height:l}=e;let p=new h({xmin:-.5,ymin:.5-l,xmax:n-.5,ymax:.5,spatialReference:s});const f=o?o.forwardTransform(p):p;let d=!0;if(o){const t=o.forwardCoefficients;d=t&&0===t[1]&&0===t[2],d&&(o=null,p=f)}const w=new m({data:{extent:f,nativeExtent:p,transform:o,pixelBlock:e,statistics:r,histograms:a,keyProperties:{DateType:\"Processed\"},isPseudoSpatialReference:i}});await w.open(),w.data=null,this._set(\"rasterInfo\",w.rasterInfo),this._inMemoryRaster=w}fetchRawTile(t,e,s,r={}){return this._inMemoryRaster.fetchRawTile(t,e,s,r)}async _fetchData(t){const{data:s}=await this.request(this.url,{responseType:\"array-buffer\",signal:t?.signal}),r=p(s).toUpperCase();if(\"JPG\"!==r&&\"PNG\"!==r&&\"GIF\"!==r&&\"BMP\"!==r)throw new e(\"image-aux-raster:open\",\"the data is not a supported format\");this._set(\"datasetFormat\",r);const a=r.toLowerCase(),o=\"gif\"===a||\"bmp\"===a||!has(\"ios\"),i=await this.decodePixelBlock(s,{format:a,useCanvas:o,hasNoZlibMask:!0});if(null==i)throw new e(\"image-aux-raster:open\",\"the data cannot be decoded\");return i}async _fetchAuxiliaryData(t){const e=s(t?.signal),o=this.ioConfig.skipExtensions??[],i=o.includes(\"aux.xml\")?null:this.request(this.url+\".aux.xml\",{responseType:\"xml\",signal:e}),n=this.datasetFormat,m=\"JPG\"===n?\"jgw\":\"PNG\"===n?\"pgw\":\"BMP\"===n?\"bpw\":null,p=m&&o.includes(m)?null:this.request(this.url.slice(0,this.url.lastIndexOf(\".\"))+\".\"+m,{responseType:\"text\",signal:e}),c=await r([i,p]);if(e?.aborted)throw a();const u=l(c[0].value?.data);if(!u.transform){const t=c[1].value?c[1].value.data.split(\"\\n\").slice(0,6).map((t=>Number(t))):null;u.transform=6===t?.length?new f({forwardCoefficients:[t[4],t[5],t[0],-t[1],t[2],-t[3]]}):null}return u}};t([o({type:String,json:{write:!0}})],d.prototype,\"datasetFormat\",void 0),d=t([i(\"esri.layers.support.rasterDatasets.ImageAuxRaster\")],d);const w=d;export{w as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}