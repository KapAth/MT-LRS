{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from \"../../core/has.js\";\nimport { glsl as r } from \"../3d/webgl-engine/core/shaderModules/interfaces.js\";\nimport { BufferObject as e } from \"./BufferObject.js\";\nimport { ContextType as t } from \"./context-util.js\";\nimport { TargetType as o, DepthStencilTargetType as i, TextureType as n, TextureWrapMode as a, PixelFormat as s, PixelType as m, TextureSamplingMode as c, Usage as l, BufferType as p, PrimitiveType as g, DataType as d } from \"./enums.js\";\nimport { FramebufferObject as _ } from \"./FramebufferObject.js\";\nimport { WebGLDriverTestModule as f } from \"./WebGLDriverTestModule.js\";\n\nclass u extends f {\n  constructor(r) {\n    super(), this._rctx = r, this._dummyProgram = null, this._rctx.type === t.WEBGL2 && has(\"mac\") && has(\"chrome\") && (this._program = this._prepareProgram(), this._dummyProgram = this._prepareDummyProgram());\n  }\n\n  dispose() {\n    super.dispose(), this._dummyProgram?.dispose(), this._dummyProgram = null;\n  }\n\n  _test(r) {\n    const t = this._rctx;\n    t.resetState();\n    const f = new _(t, {\n      colorTarget: o.TEXTURE,\n      depthStencilTarget: i.NONE\n    }, {\n      target: n.TEXTURE_2D,\n      wrapMode: a.CLAMP_TO_EDGE,\n      pixelFormat: s.RGBA,\n      dataType: m.UNSIGNED_BYTE,\n      samplingMode: c.NEAREST,\n      width: 1,\n      height: 1\n    }),\n          u = e.createIndex(this._rctx, l.STATIC_DRAW, new Uint8Array([0]));\n    t.bindFramebuffer(f), t.setViewport(0, 0, 1, 1), t.useProgram(this._dummyProgram), t.bindBuffer(u, p.ELEMENT_ARRAY_BUFFER), t.drawElements(g.POINTS, 1, d.UNSIGNED_BYTE, 0), t.useProgram(r), t.bindVAO(null), t.drawArrays(g.TRIANGLES, 0, 258);\n    const h = new Uint8Array(4);\n    return f.readPixels(0, 0, 1, 1, s.RGBA, m.UNSIGNED_BYTE, h), f.dispose(), u.dispose(), 255 === h[0];\n  }\n\n  _prepareProgram() {\n    const e = 85,\n          t = `\\n    precision highp float;\\n\\n    varying float triangleId;\\n\\n    const vec3 triangleVertices[3] = vec3[3](vec3(-0.5, -0.5, 0.0), vec3(0.5, -0.5, 0.0), vec3(0.0, 0.5, 0.0));\\n\\n    void main(void) {\\n      triangleId = floor(float(gl_VertexID)/3.0);\\n\\n      vec3 position = triangleVertices[gl_VertexID % 3];\\n      float offset = triangleId / ${r.float(e)};\\n      position.z = 0.5 - offset;\\n\\n      gl_Position = vec4(position, 1.0);\\n    }\\n    `,\n          o = `\\n    precision highp float;\\n\\n    varying float triangleId;\\n\\n    void main(void) {\\n      gl_FragColor = triangleId == ${r.float(e)} ? vec4(0.0, 1.0, 0.0, 1.0) : vec4(1.0, 0.0, 0.0, 1.0);\\n    }\\n    `;\n    return this._rctx.programCache.acquire(t, o, new Map([]));\n  }\n\n  _prepareDummyProgram() {\n    const r = \"\\n    void main(void) {\\n      gl_Position = vec4(0.0, 0.0, float(gl_VertexID)-2.0, 1.0);\\n    }\",\n          e = \"\\n    void main(void) {\\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\\n    }\";\n    return this._rctx.programCache.acquire(r, e, new Map([]));\n  }\n\n}\n\nexport { u as DrawArraysRequiresIndicesTypeReset };","map":{"version":3,"names":["has","glsl","r","BufferObject","e","ContextType","t","TargetType","o","DepthStencilTargetType","i","TextureType","n","TextureWrapMode","a","PixelFormat","s","PixelType","m","TextureSamplingMode","c","Usage","l","BufferType","p","PrimitiveType","g","DataType","d","FramebufferObject","_","WebGLDriverTestModule","f","u","constructor","_rctx","_dummyProgram","type","WEBGL2","_program","_prepareProgram","_prepareDummyProgram","dispose","_test","resetState","colorTarget","TEXTURE","depthStencilTarget","NONE","target","TEXTURE_2D","wrapMode","CLAMP_TO_EDGE","pixelFormat","RGBA","dataType","UNSIGNED_BYTE","samplingMode","NEAREST","width","height","createIndex","STATIC_DRAW","Uint8Array","bindFramebuffer","setViewport","useProgram","bindBuffer","ELEMENT_ARRAY_BUFFER","drawElements","POINTS","bindVAO","drawArrays","TRIANGLES","h","readPixels","float","programCache","acquire","Map","DrawArraysRequiresIndicesTypeReset"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/views/webgl/testAppleAmdDrawArrays.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport has from\"../../core/has.js\";import{glsl as r}from\"../3d/webgl-engine/core/shaderModules/interfaces.js\";import{BufferObject as e}from\"./BufferObject.js\";import{ContextType as t}from\"./context-util.js\";import{TargetType as o,DepthStencilTargetType as i,TextureType as n,TextureWrapMode as a,PixelFormat as s,PixelType as m,TextureSamplingMode as c,Usage as l,BufferType as p,PrimitiveType as g,DataType as d}from\"./enums.js\";import{FramebufferObject as _}from\"./FramebufferObject.js\";import{WebGLDriverTestModule as f}from\"./WebGLDriverTestModule.js\";class u extends f{constructor(r){super(),this._rctx=r,this._dummyProgram=null,this._rctx.type===t.WEBGL2&&has(\"mac\")&&has(\"chrome\")&&(this._program=this._prepareProgram(),this._dummyProgram=this._prepareDummyProgram())}dispose(){super.dispose(),this._dummyProgram?.dispose(),this._dummyProgram=null}_test(r){const t=this._rctx;t.resetState();const f=new _(t,{colorTarget:o.TEXTURE,depthStencilTarget:i.NONE},{target:n.TEXTURE_2D,wrapMode:a.CLAMP_TO_EDGE,pixelFormat:s.RGBA,dataType:m.UNSIGNED_BYTE,samplingMode:c.NEAREST,width:1,height:1}),u=e.createIndex(this._rctx,l.STATIC_DRAW,new Uint8Array([0]));t.bindFramebuffer(f),t.setViewport(0,0,1,1),t.useProgram(this._dummyProgram),t.bindBuffer(u,p.ELEMENT_ARRAY_BUFFER),t.drawElements(g.POINTS,1,d.UNSIGNED_BYTE,0),t.useProgram(r),t.bindVAO(null),t.drawArrays(g.TRIANGLES,0,258);const h=new Uint8Array(4);return f.readPixels(0,0,1,1,s.RGBA,m.UNSIGNED_BYTE,h),f.dispose(),u.dispose(),255===h[0]}_prepareProgram(){const e=85,t=`\\n    precision highp float;\\n\\n    varying float triangleId;\\n\\n    const vec3 triangleVertices[3] = vec3[3](vec3(-0.5, -0.5, 0.0), vec3(0.5, -0.5, 0.0), vec3(0.0, 0.5, 0.0));\\n\\n    void main(void) {\\n      triangleId = floor(float(gl_VertexID)/3.0);\\n\\n      vec3 position = triangleVertices[gl_VertexID % 3];\\n      float offset = triangleId / ${r.float(e)};\\n      position.z = 0.5 - offset;\\n\\n      gl_Position = vec4(position, 1.0);\\n    }\\n    `,o=`\\n    precision highp float;\\n\\n    varying float triangleId;\\n\\n    void main(void) {\\n      gl_FragColor = triangleId == ${r.float(e)} ? vec4(0.0, 1.0, 0.0, 1.0) : vec4(1.0, 0.0, 0.0, 1.0);\\n    }\\n    `;return this._rctx.programCache.acquire(t,o,new Map([]))}_prepareDummyProgram(){const r=\"\\n    void main(void) {\\n      gl_Position = vec4(0.0, 0.0, float(gl_VertexID)-2.0, 1.0);\\n    }\",e=\"\\n    void main(void) {\\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\\n    }\";return this._rctx.programCache.acquire(r,e,new Map([]))}}export{u as DrawArraysRequiresIndicesTypeReset};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}