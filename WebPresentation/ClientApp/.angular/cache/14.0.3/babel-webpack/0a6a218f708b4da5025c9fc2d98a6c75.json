{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/ClientApp/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\n\n/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../chunks/tslib.es6.js\";\nimport \"../../geometry.js\";\nimport { rasterRendererTypes as e } from \"../../rasterRenderers.js\";\nimport r from \"../../request.js\";\nimport i from \"../../core/Error.js\";\nimport s from \"../../core/Logger.js\";\nimport { isNone as n, isSome as o } from \"../../core/maybe.js\";\nimport { property as a } from \"../../core/accessorSupport/decorators/property.js\";\nimport \"../../core/accessorSupport/ensureType.js\";\nimport \"../../core/arrayUtils.js\";\nimport { subclass as l } from \"../../core/accessorSupport/decorators/subclass.js\";\nimport { getInfo as u } from \"../../geometry/support/spatialReferenceUtils.js\";\nimport { sanitizeUrl as m } from \"../support/arcgisLayerUrl.js\";\nimport { url as d } from \"../support/commonProperties.js\";\nimport c from \"../support/DimensionalDefinition.js\";\nimport h from \"../support/MultidimensionalSubset.js\";\nimport f from \"../support/RasterFunction.js\";\nimport p from \"../support/RasterJobHandler.js\";\nimport y from \"../support/TileInfo.js\";\nimport b from \"../support/rasterDatasets/FunctionRaster.js\";\nimport { getDefaultMultidimensionalDefinition as g, hasExcludedVariableOrDimension as J, getDefaultVariablInfo as _, isMultiSliceOrRangeDefinition as F, getSubsetVariablesFromMdInfo as I } from \"../support/rasterDatasets/multidimensionalUtils.js\";\nimport { create as R } from \"../support/rasterFunctions/rasterFunctionHelper.js\";\nimport { convertVectorFieldData as S } from \"../support/rasterFunctions/vectorFieldUtils.js\";\nimport { normalizeRendererJSON as v, getVariableRasterInfo as x, getDefaultInterpolation as D, getDefaultBandCombination as j, createDefaultRenderer as H } from \"../../renderers/support/rasterRendererHelper.js\";\nimport T from \"../../renderers/support/RasterSymbolizer.js\";\nimport { createFlowMesh as w } from \"../../views/2d/engine/flow/dataUtils.js\";\nimport N from \"../../geometry/SpatialReference.js\";\n\nconst O = s.getLogger(\"esri.layers.mixins.ImageryTileMixin\"),\n      z = s => {\n  let z = class extends s {\n    constructor(...t) {\n      super(...t), this._isConstructedFromFunctionRaster = !1, this._rasterJobHandler = {\n        instance: null,\n        refCount: 0,\n        connectionPromise: null\n      }, this.bandIds = null, this.copyright = null, this.interpolation = \"nearest\", this.multidimensionalSubset = null, this.raster = null, this.rasterFunction = null, this.rasterInfo = null, this.sourceJSON = null, this.spatialReference = null, this.symbolizer = null, this._isConstructedFromFunctionRaster = \"Function\" === t[0]?.raster?.datasetFormat;\n    }\n\n    get fullExtent() {\n      return this.rasterInfo?.extent;\n    }\n\n    set multidimensionalDefinition(t) {\n      this._set(\"multidimensionalDefinition\", t), this.updateRenderer();\n    }\n\n    get tileInfo() {\n      return this.rasterInfo?.storageInfo.tileInfo;\n    }\n\n    set url(t) {\n      this._set(\"url\", m(t, O));\n    }\n\n    set renderer(t) {\n      this._set(\"renderer\", t), this.updateRenderer();\n    }\n\n    convertVectorFieldData(t, e) {\n      var _this = this;\n\n      return _asyncToGenerator(function* () {\n        if (n(t) || !_this.rasterInfo) return null;\n        const r = _this._rasterJobHandler.instance,\n              i = _this.rasterInfo.dataType;\n        return r ? r.convertVectorFieldData({\n          pixelBlock: t,\n          dataType: i\n        }, e) : S(t, i);\n      })();\n    }\n\n    createFlowMesh(t, e) {\n      var _this2 = this;\n\n      return _asyncToGenerator(function* () {\n        const r = _this2._rasterJobHandler.instance;\n        return r ? r.createFlowMesh(t, e) : w(t.meshType, t.simulationSettings, t.flowData, o(e.signal) ? e.signal : new AbortController().signal);\n      })();\n    }\n\n    normalizeRasterFetchOptions(t) {\n      const {\n        multidimensionalInfo: e\n      } = this.rasterInfo ?? {};\n      if (n(e)) return t;\n      let r = t.multidimensionalDefinition || this.multidimensionalDefinition;\n      !n(r) && r.length || (r = g(this.raster.rasterInfo, {\n        multidimensionalSubset: this.multidimensionalSubset\n      }));\n      const i = t.timeExtent || this.timeExtent;\n\n      if (o(r) && o(i) && (o(i.start) || o(i.end))) {\n        r = r.map(t => t.clone());\n        const s = e.variables.find(({\n          name: t\n        }) => t === r[0].variableName)?.dimensions?.find(({\n          name: t\n        }) => \"StdTime\" === t),\n              a = r.find(({\n          dimensionName: t\n        }) => \"StdTime\" === t);\n        if (!s || !a) return { ...t,\n          multidimensionalDefinition: null\n        };\n        const {\n          start: l,\n          end: u\n        } = i,\n              m = n(l) ? null : l.getTime(),\n              d = n(u) ? null : u.getTime(),\n              c = m ?? d,\n              h = d ?? m;\n\n        if (o(s.values)) {\n          const t = s.values.filter(t => {\n            if (Array.isArray(t)) {\n              if (c === h) return t[0] <= c && t[1] >= c;\n              const e = t[0] <= c && t[1] > c || t[0] < h && t[1] >= h,\n                    r = t[0] >= c && t[1] <= h || t[0] < c && t[1] > h;\n              return e || r;\n            }\n\n            return c === h ? t === c : t >= c && t <= h;\n          });\n\n          if (t.length) {\n            const e = t.sort((t, e) => {\n              if (c === h) return (t[0] ?? t) - (e[0] ?? e);\n              return Math.abs((t[1] ?? t) - h) - Math.abs((e[1] ?? e) - h);\n            })[0];\n            a.values = [e];\n          } else r = null;\n        } else if (s.hasRegularIntervals && s.extent) {\n          const [t, e] = s.extent;\n          c > e || h < t ? r = null : a.values = c === h ? [c] : [Math.max(t, c), Math.min(e, h)];\n        }\n      }\n\n      return o(r) && J(r, this.multidimensionalSubset) ? { ...t,\n        multidimensionalDefinition: null\n      } : { ...t,\n        multidimensionalDefinition: r\n      };\n    }\n\n    updateRasterFunction() {\n      var _this3 = this;\n\n      return _asyncToGenerator(function* () {\n        if (\"imagery-tile\" !== _this3.type || !_this3.rasterFunction && !_this3._cachedRasterFunctionJson || JSON.stringify(_this3.rasterFunction) === JSON.stringify(_this3._cachedRasterFunctionJson)) return;\n\n        if (_this3._isConstructedFromFunctionRaster && \"Function\" === _this3.raster.datasetFormat) {\n          const t = _this3.raster.rasterFunction.toJSON();\n\n          return !_this3.rasterFunction && t && _this3._set(\"rasterFunction\", f.fromJSON(t)), void (_this3._cachedRasterFunctionJson = _this3.rasterFunction?.toJSON());\n        }\n\n        let t,\n            e = _this3.raster,\n            r = !1;\n        \"Function\" === e.datasetFormat ? (t = e.primaryRasters.rasters, e = t[0], r = !0) : t = [e];\n        const {\n          rasterFunction: i\n        } = _this3;\n\n        if (i) {\n          const r = {\n            raster: e\n          };\n          t.length > 1 && t.forEach(t => r[t.url] = t);\n          const s = R(i.rasterFunctionDefinition ?? i.toJSON(), r),\n                n = new b({\n            rasterFunction: s\n          });\n          n.rasterJobHandler = _this3._rasterJobHandler.instance, yield n.open(), _this3._cachedRasterFunctionJson = _this3.rasterFunction?.toJSON(), _this3.raster = n;\n        } else _this3.raster = e, _this3._cachedRasterFunctionJson = null;\n\n        if (_this3._cachedRendererJson = null, !r && !i) return;\n        const {\n          bandIds: s\n        } = _this3,\n              {\n          bandCount: n\n        } = _this3.raster.rasterInfo,\n              o = s?.length ? s.some(t => t >= n) : n >= 3;\n        s && (o || \"raster-stretch\" !== _this3.renderer.type) && _this3._set(\"bandIds\", null), _this3._configDefaultRenderer(\"auto\");\n      })();\n    }\n\n    updateRenderer() {\n      var _this4 = this;\n\n      return _asyncToGenerator(function* () {\n        const {\n          loaded: t,\n          symbolizer: e\n        } = _this4;\n        if (!t || !e) return;\n        const {\n          rasterInfo: r\n        } = _this4.raster,\n              i = _(r, {\n          multidimensionalDefinition: _this4.multidimensionalDefinition,\n          multidimensionalSubset: _this4.multidimensionalSubset\n        })?.name,\n              s = v({ ..._this4.renderer.toJSON(),\n          variableName: i\n        });\n        if (JSON.stringify(_this4._cachedRendererJson) === JSON.stringify(s)) return;\n        const n = _this4._rasterJobHandler.instance;\n        n && (e.rasterInfo = x(r, i), e.rendererJSON = s, e.bind(), yield n.updateSymbolizer(e), _this4._cachedRendererJson = s);\n      })();\n    }\n\n    applyRenderer(t, e) {\n      var _this5 = this;\n\n      return _asyncToGenerator(function* () {\n        const r = t && t.pixelBlock;\n        if (!(o(r) && r.pixels && r.pixels.length > 0)) return null;\n        let i;\n        yield _this5.updateRenderer();\n        const s = _this5._rasterJobHandler.instance,\n              n = _this5.bandIds ?? [];\n        return i = s ? yield s.symbolize({ ...t,\n          simpleStretchParams: e,\n          bandIds: n\n        }) : _this5.symbolizer.symbolize({ ...t,\n          simpleStretchParams: e,\n          bandIds: n\n        }), i;\n      })();\n    }\n\n    getTileUrl(t, e, r) {\n      return \"RasterTileServer\" === this.raster.datasetFormat ? `${this.url}/tile/${t}/${e}/${r}` : \"\";\n    }\n\n    getCompatibleTileInfo(t, e, r = !1) {\n      if (!this.loaded || n(e)) return null;\n      if (r && t.equals(this.spatialReference)) return this.tileInfo;\n      const i = u(t);\n      return y.create({\n        size: 256,\n        spatialReference: t,\n        origin: i ? {\n          x: i.origin[0],\n          y: i.origin[1]\n        } : {\n          x: e.xmin,\n          y: e.ymax\n        }\n      });\n    }\n\n    getCompatibleFullExtent(t) {\n      return this.loaded ? (this._compatibleFullExtent && this._compatibleFullExtent.spatialReference.equals(t) || (this._compatibleFullExtent = this.raster.computeExtent(t)), this._compatibleFullExtent) : null;\n    }\n\n    fetchTile(t, e, i, s = {}) {\n      var _this6 = this;\n\n      return _asyncToGenerator(function* () {\n        if (C(_this6), s.requestAsImageElement) {\n          const n = _this6.getTileUrl(t, e, i);\n\n          return r(n, {\n            responseType: \"image\",\n            query: { ..._this6.refreshParameters,\n              ..._this6.raster.ioConfig.customFetchParameters\n            },\n            signal: s.signal\n          }).then(t => t.data);\n        }\n\n        const {\n          rasterInfo: a\n        } = _this6;\n\n        if (o(a.multidimensionalInfo) && (s = _this6.normalizeRasterFetchOptions(s), n(s.multidimensionalDefinition))) {\n          const r = s.tileInfo || a.storageInfo.tileInfo;\n          return {\n            extent: _this6.raster.getTileExtentFromTileInfo(t, e, i, r),\n            pixelBlock: null\n          };\n        }\n\n        return yield _this6._initJobHandler(), yield _this6.updateRasterFunction(), \"raster-shaded-relief\" === _this6.renderer.type && (s = { ...s,\n          buffer: {\n            cols: 1,\n            rows: 1\n          }\n        }), _this6.raster.fetchTile(t, e, i, s);\n      })();\n    }\n\n    fetchPixels(t, e, r, i = {}) {\n      var _this7 = this;\n\n      return _asyncToGenerator(function* () {\n        return o(_this7.rasterInfo.multidimensionalInfo) && (i = _this7.normalizeRasterFetchOptions(i), n(i.multidimensionalDefinition)) ? {\n          extent: t,\n          pixelBlock: null\n        } : (yield _this7._initJobHandler(), yield _this7.updateRasterFunction(), _this7.raster.fetchPixels(t, e, r, i));\n      })();\n    }\n\n    identify(t, e = {}) {\n      var _this8 = this;\n\n      return _asyncToGenerator(function* () {\n        const {\n          raster: r,\n          rasterInfo: s\n        } = _this8;\n\n        if (o(s.multidimensionalInfo)) {\n          if (!(s.hasMultidimensionalTranspose && !!(F(e.multidimensionalDefinition) || e.transposedVariableName || e.timeExtent)) && (e = _this8.normalizeRasterFetchOptions(e), n(e.multidimensionalDefinition))) return {\n            location: t,\n            value: null\n          };\n        }\n\n        const a = _this8.multidimensionalSubset?.areaOfInterest;\n        if (a && !a.contains(t)) throw new i(\"imagery-tile-mixin:identify\", \"the request cannot be fulfilled when falling outside of the multidimensional subset\");\n        return r.identify(t, e);\n      })();\n    }\n\n    increaseRasterJobHandlerUsage() {\n      this._rasterJobHandler.refCount++;\n    }\n\n    decreaseRasterJobHandlerUsage() {\n      this._rasterJobHandler.refCount--, this._rasterJobHandler.refCount <= 0 && this._shutdownJobHandler();\n    }\n\n    hasStandardTime() {\n      const t = this.rasterInfo?.multidimensionalInfo;\n      if (n(t) || \"standard-time\" !== this.rasterInfo?.dataType) return !1;\n      const e = this.multidimensionalDefinition,\n            r = e?.[0]?.variableName;\n      return t.variables.some(t => t.name === r && (!e?.[0].dimensionName || t.dimensions.some(t => \"StdTime\" === t.name)));\n    }\n\n    getStandardTimeValue(t) {\n      return new Date(24 * (t - 25569) * 3600 * 1e3).toString();\n    }\n\n    getMultidimensionalSubsetVariables(t) {\n      const e = t ?? this.rasterInfo?.multidimensionalInfo;\n      return I(this.multidimensionalSubset, e);\n    }\n\n    _configDefaultSettings() {\n      this._configDefaultInterpolation(), this.multidimensionalDefinition || (this.multidimensionalDefinition = g(this.raster.rasterInfo, {\n        multidimensionalSubset: this.multidimensionalSubset\n      })), this._configDefaultRenderer();\n    }\n\n    _initJobHandler() {\n      if (null != this._rasterJobHandler.connectionPromise) return this._rasterJobHandler.connectionPromise;\n      const t = new p();\n      return this._rasterJobHandler.connectionPromise = t.initialize().then(() => {\n        C(this), this._rasterJobHandler.instance = t, this.raster.rasterJobHandler = t, this.renderer && this.updateRenderer(), \"Function\" === this.raster.datasetFormat && this.raster.syncJobHandler();\n      }).catch(() => {}), this._rasterJobHandler.connectionPromise;\n    }\n\n    _shutdownJobHandler() {\n      this._rasterJobHandler.instance && this._rasterJobHandler.instance.destroy(), this._rasterJobHandler.instance = null, this._rasterJobHandler.connectionPromise = null, this._rasterJobHandler.refCount = 0, this._cachedRendererJson = null, this.raster && (this.raster.rasterJobHandler = null);\n    }\n\n    _configDefaultInterpolation() {\n      if (null == this.interpolation) {\n        C(this);\n        const {\n          raster: t\n        } = this,\n              e = D(t.rasterInfo, t.tileType, this.sourceJSON?.defaultResamplingMethod);\n\n        this._set(\"interpolation\", e);\n      }\n    }\n\n    _configDefaultRenderer(t = \"no\") {\n      C(this);\n      const {\n        rasterInfo: e\n      } = this.raster;\n      !this.bandIds && e.bandCount > 1 && (this.bandIds = j(e));\n      const r = _(e, {\n        multidimensionalDefinition: this.multidimensionalDefinition,\n        multidimensionalSubset: this.multidimensionalSubset\n      })?.name;\n\n      if (!this.renderer || \"override\" === t) {\n        const t = H(e, {\n          bandIds: this.bandIds,\n          variableName: r\n        });\n        \"WCSServer\" === this.raster.datasetFormat && \"raster-stretch\" === t.type && ((e.statistics?.[0].max ?? 0) > 1e24 || (e.statistics?.[0].min ?? 0) < -1e24) && (t.dynamicRangeAdjustment = !0, t.statistics = null, \"none\" === t.stretchType && (t.stretchType = \"min-max\")), this.renderer = t;\n      }\n\n      const i = v({ ...this.renderer.toJSON(),\n        variableName: r\n      }),\n            s = x(e, r);\n      this.symbolizer ? (this.symbolizer.rendererJSON = i, this.symbolizer.rasterInfo = s) : this.symbolizer = new T({\n        rendererJSON: i,\n        rasterInfo: s\n      });\n      const n = this.symbolizer.bind();\n\n      if (n.success) {\n        if (\"auto\" === t) {\n          const {\n            colormap: t\n          } = this.raster.rasterInfo,\n                e = this.renderer;\n          if (o(t)) {\n            if (\"raster-colormap\" !== e.type) this._configDefaultRenderer(\"override\");else {\n              const t = H(this.raster.rasterInfo);\n              JSON.stringify(t) !== JSON.stringify(e) && this._configDefaultRenderer(\"override\");\n            }\n          } else if (\"raster-stretch\" === e.type) {\n            const t = this.bandIds?.length,\n                  r = e.statistics?.length;\n            !e.dynamicRangeAdjustment && r && t && r !== t && this._configDefaultRenderer(\"override\");\n          }\n        }\n      } else O.warn(\"imagery-tile-mixin\", n.error || \"The given renderer is not supported by the layer.\"), \"auto\" === t && this._configDefaultRenderer(\"override\");\n    }\n\n  };\n\n  function C(t) {\n    if (!t.raster || !t.rasterInfo) throw new i(\"imagery-tile\", \"no raster\");\n  }\n\n  return t([a()], z.prototype, \"_cachedRendererJson\", void 0), t([a()], z.prototype, \"_cachedRasterFunctionJson\", void 0), t([a()], z.prototype, \"_compatibleFullExtent\", void 0), t([a()], z.prototype, \"_isConstructedFromFunctionRaster\", void 0), t([a()], z.prototype, \"_rasterJobHandler\", void 0), t([a()], z.prototype, \"bandIds\", void 0), t([a({\n    json: {\n      origins: {\n        service: {\n          read: {\n            source: \"copyrightText\"\n          }\n        }\n      }\n    }\n  })], z.prototype, \"copyright\", void 0), t([a({\n    json: {\n      read: !1\n    }\n  })], z.prototype, \"fullExtent\", null), t([a()], z.prototype, \"interpolation\", void 0), t([a()], z.prototype, \"ioConfig\", void 0), t([a({\n    type: [c],\n    json: {\n      write: !0\n    }\n  })], z.prototype, \"multidimensionalDefinition\", null), t([a({\n    type: h,\n    json: {\n      write: !0\n    }\n  })], z.prototype, \"multidimensionalSubset\", void 0), t([a()], z.prototype, \"raster\", void 0), t([a({\n    type: f\n  })], z.prototype, \"rasterFunction\", void 0), t([a()], z.prototype, \"rasterInfo\", void 0), t([a()], z.prototype, \"sourceJSON\", void 0), t([a({\n    readOnly: !0,\n    type: N,\n    json: {\n      read: !1\n    }\n  })], z.prototype, \"spatialReference\", void 0), t([a({\n    json: {\n      read: !1\n    }\n  })], z.prototype, \"tileInfo\", null), t([a(d)], z.prototype, \"url\", null), t([a({\n    types: e\n  })], z.prototype, \"renderer\", null), t([a()], z.prototype, \"symbolizer\", void 0), z = t([l(\"esri.layers.ImageryTileMixin\")], z), z;\n};\n\nexport { z as ImageryTileMixin };","map":{"version":3,"names":["_","t","rasterRendererTypes","e","r","i","s","isNone","n","isSome","o","property","a","subclass","l","getInfo","u","sanitizeUrl","m","url","d","c","h","f","p","y","b","getDefaultMultidimensionalDefinition","g","hasExcludedVariableOrDimension","J","getDefaultVariablInfo","isMultiSliceOrRangeDefinition","F","getSubsetVariablesFromMdInfo","I","create","R","convertVectorFieldData","S","normalizeRendererJSON","v","getVariableRasterInfo","x","getDefaultInterpolation","D","getDefaultBandCombination","j","createDefaultRenderer","H","T","createFlowMesh","w","N","O","getLogger","z","constructor","_isConstructedFromFunctionRaster","_rasterJobHandler","instance","refCount","connectionPromise","bandIds","copyright","interpolation","multidimensionalSubset","raster","rasterFunction","rasterInfo","sourceJSON","spatialReference","symbolizer","datasetFormat","fullExtent","extent","multidimensionalDefinition","_set","updateRenderer","tileInfo","storageInfo","renderer","dataType","pixelBlock","meshType","simulationSettings","flowData","signal","AbortController","normalizeRasterFetchOptions","multidimensionalInfo","length","timeExtent","start","end","map","clone","variables","find","name","variableName","dimensions","dimensionName","getTime","values","filter","Array","isArray","sort","Math","abs","hasRegularIntervals","max","min","updateRasterFunction","type","_cachedRasterFunctionJson","JSON","stringify","toJSON","fromJSON","primaryRasters","rasters","forEach","rasterFunctionDefinition","rasterJobHandler","open","_cachedRendererJson","bandCount","some","_configDefaultRenderer","loaded","rendererJSON","bind","updateSymbolizer","applyRenderer","pixels","symbolize","simpleStretchParams","getTileUrl","getCompatibleTileInfo","equals","size","origin","xmin","ymax","getCompatibleFullExtent","_compatibleFullExtent","computeExtent","fetchTile","C","requestAsImageElement","responseType","query","refreshParameters","ioConfig","customFetchParameters","then","data","getTileExtentFromTileInfo","_initJobHandler","buffer","cols","rows","fetchPixels","identify","hasMultidimensionalTranspose","transposedVariableName","location","value","areaOfInterest","contains","increaseRasterJobHandlerUsage","decreaseRasterJobHandlerUsage","_shutdownJobHandler","hasStandardTime","getStandardTimeValue","Date","toString","getMultidimensionalSubsetVariables","_configDefaultSettings","_configDefaultInterpolation","initialize","syncJobHandler","catch","destroy","tileType","defaultResamplingMethod","statistics","dynamicRangeAdjustment","stretchType","success","colormap","warn","error","prototype","json","origins","service","read","source","write","readOnly","types","ImageryTileMixin"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/layers/mixins/ImageryTileMixin.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../chunks/tslib.es6.js\";import\"../../geometry.js\";import{rasterRendererTypes as e}from\"../../rasterRenderers.js\";import r from\"../../request.js\";import i from\"../../core/Error.js\";import s from\"../../core/Logger.js\";import{isNone as n,isSome as o}from\"../../core/maybe.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import{subclass as l}from\"../../core/accessorSupport/decorators/subclass.js\";import{getInfo as u}from\"../../geometry/support/spatialReferenceUtils.js\";import{sanitizeUrl as m}from\"../support/arcgisLayerUrl.js\";import{url as d}from\"../support/commonProperties.js\";import c from\"../support/DimensionalDefinition.js\";import h from\"../support/MultidimensionalSubset.js\";import f from\"../support/RasterFunction.js\";import p from\"../support/RasterJobHandler.js\";import y from\"../support/TileInfo.js\";import b from\"../support/rasterDatasets/FunctionRaster.js\";import{getDefaultMultidimensionalDefinition as g,hasExcludedVariableOrDimension as J,getDefaultVariablInfo as _,isMultiSliceOrRangeDefinition as F,getSubsetVariablesFromMdInfo as I}from\"../support/rasterDatasets/multidimensionalUtils.js\";import{create as R}from\"../support/rasterFunctions/rasterFunctionHelper.js\";import{convertVectorFieldData as S}from\"../support/rasterFunctions/vectorFieldUtils.js\";import{normalizeRendererJSON as v,getVariableRasterInfo as x,getDefaultInterpolation as D,getDefaultBandCombination as j,createDefaultRenderer as H}from\"../../renderers/support/rasterRendererHelper.js\";import T from\"../../renderers/support/RasterSymbolizer.js\";import{createFlowMesh as w}from\"../../views/2d/engine/flow/dataUtils.js\";import N from\"../../geometry/SpatialReference.js\";const O=s.getLogger(\"esri.layers.mixins.ImageryTileMixin\"),z=s=>{let z=class extends s{constructor(...t){super(...t),this._isConstructedFromFunctionRaster=!1,this._rasterJobHandler={instance:null,refCount:0,connectionPromise:null},this.bandIds=null,this.copyright=null,this.interpolation=\"nearest\",this.multidimensionalSubset=null,this.raster=null,this.rasterFunction=null,this.rasterInfo=null,this.sourceJSON=null,this.spatialReference=null,this.symbolizer=null,this._isConstructedFromFunctionRaster=\"Function\"===t[0]?.raster?.datasetFormat}get fullExtent(){return this.rasterInfo?.extent}set multidimensionalDefinition(t){this._set(\"multidimensionalDefinition\",t),this.updateRenderer()}get tileInfo(){return this.rasterInfo?.storageInfo.tileInfo}set url(t){this._set(\"url\",m(t,O))}set renderer(t){this._set(\"renderer\",t),this.updateRenderer()}async convertVectorFieldData(t,e){if(n(t)||!this.rasterInfo)return null;const r=this._rasterJobHandler.instance,i=this.rasterInfo.dataType;return r?r.convertVectorFieldData({pixelBlock:t,dataType:i},e):S(t,i)}async createFlowMesh(t,e){const r=this._rasterJobHandler.instance;return r?r.createFlowMesh(t,e):w(t.meshType,t.simulationSettings,t.flowData,o(e.signal)?e.signal:(new AbortController).signal)}normalizeRasterFetchOptions(t){const{multidimensionalInfo:e}=this.rasterInfo??{};if(n(e))return t;let r=t.multidimensionalDefinition||this.multidimensionalDefinition;!n(r)&&r.length||(r=g(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset}));const i=t.timeExtent||this.timeExtent;if(o(r)&&o(i)&&(o(i.start)||o(i.end))){r=r.map((t=>t.clone()));const s=e.variables.find((({name:t})=>t===r[0].variableName))?.dimensions?.find((({name:t})=>\"StdTime\"===t)),a=r.find((({dimensionName:t})=>\"StdTime\"===t));if(!s||!a)return{...t,multidimensionalDefinition:null};const{start:l,end:u}=i,m=n(l)?null:l.getTime(),d=n(u)?null:u.getTime(),c=m??d,h=d??m;if(o(s.values)){const t=s.values.filter((t=>{if(Array.isArray(t)){if(c===h)return t[0]<=c&&t[1]>=c;const e=t[0]<=c&&t[1]>c||t[0]<h&&t[1]>=h,r=t[0]>=c&&t[1]<=h||t[0]<c&&t[1]>h;return e||r}return c===h?t===c:t>=c&&t<=h}));if(t.length){const e=t.sort(((t,e)=>{if(c===h)return(t[0]??t)-(e[0]??e);return Math.abs((t[1]??t)-h)-Math.abs((e[1]??e)-h)}))[0];a.values=[e]}else r=null}else if(s.hasRegularIntervals&&s.extent){const[t,e]=s.extent;c>e||h<t?r=null:a.values=c===h?[c]:[Math.max(t,c),Math.min(e,h)]}}return o(r)&&J(r,this.multidimensionalSubset)?{...t,multidimensionalDefinition:null}:{...t,multidimensionalDefinition:r}}async updateRasterFunction(){if(\"imagery-tile\"!==this.type||!this.rasterFunction&&!this._cachedRasterFunctionJson||JSON.stringify(this.rasterFunction)===JSON.stringify(this._cachedRasterFunctionJson))return;if(this._isConstructedFromFunctionRaster&&\"Function\"===this.raster.datasetFormat){const t=this.raster.rasterFunction.toJSON();return!this.rasterFunction&&t&&this._set(\"rasterFunction\",f.fromJSON(t)),void(this._cachedRasterFunctionJson=this.rasterFunction?.toJSON())}let t,e=this.raster,r=!1;\"Function\"===e.datasetFormat?(t=e.primaryRasters.rasters,e=t[0],r=!0):t=[e];const{rasterFunction:i}=this;if(i){const r={raster:e};t.length>1&&t.forEach((t=>r[t.url]=t));const s=R(i.rasterFunctionDefinition??i.toJSON(),r),n=new b({rasterFunction:s});n.rasterJobHandler=this._rasterJobHandler.instance,await n.open(),this._cachedRasterFunctionJson=this.rasterFunction?.toJSON(),this.raster=n}else this.raster=e,this._cachedRasterFunctionJson=null;if(this._cachedRendererJson=null,!r&&!i)return;const{bandIds:s}=this,{bandCount:n}=this.raster.rasterInfo,o=s?.length?s.some((t=>t>=n)):n>=3;s&&(o||\"raster-stretch\"!==this.renderer.type)&&this._set(\"bandIds\",null),this._configDefaultRenderer(\"auto\")}async updateRenderer(){const{loaded:t,symbolizer:e}=this;if(!t||!e)return;const{rasterInfo:r}=this.raster,i=_(r,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name,s=v({...this.renderer.toJSON(),variableName:i});if(JSON.stringify(this._cachedRendererJson)===JSON.stringify(s))return;const n=this._rasterJobHandler.instance;n&&(e.rasterInfo=x(r,i),e.rendererJSON=s,e.bind(),await n.updateSymbolizer(e),this._cachedRendererJson=s)}async applyRenderer(t,e){const r=t&&t.pixelBlock;if(!(o(r)&&r.pixels&&r.pixels.length>0))return null;let i;await this.updateRenderer();const s=this._rasterJobHandler.instance,n=this.bandIds??[];return i=s?await s.symbolize({...t,simpleStretchParams:e,bandIds:n}):this.symbolizer.symbolize({...t,simpleStretchParams:e,bandIds:n}),i}getTileUrl(t,e,r){return\"RasterTileServer\"===this.raster.datasetFormat?`${this.url}/tile/${t}/${e}/${r}`:\"\"}getCompatibleTileInfo(t,e,r=!1){if(!this.loaded||n(e))return null;if(r&&t.equals(this.spatialReference))return this.tileInfo;const i=u(t);return y.create({size:256,spatialReference:t,origin:i?{x:i.origin[0],y:i.origin[1]}:{x:e.xmin,y:e.ymax}})}getCompatibleFullExtent(t){return this.loaded?(this._compatibleFullExtent&&this._compatibleFullExtent.spatialReference.equals(t)||(this._compatibleFullExtent=this.raster.computeExtent(t)),this._compatibleFullExtent):null}async fetchTile(t,e,i,s={}){if(C(this),s.requestAsImageElement){const n=this.getTileUrl(t,e,i);return r(n,{responseType:\"image\",query:{...this.refreshParameters,...this.raster.ioConfig.customFetchParameters},signal:s.signal}).then((t=>t.data))}const{rasterInfo:a}=this;if(o(a.multidimensionalInfo)&&(s=this.normalizeRasterFetchOptions(s),n(s.multidimensionalDefinition))){const r=s.tileInfo||a.storageInfo.tileInfo;return{extent:this.raster.getTileExtentFromTileInfo(t,e,i,r),pixelBlock:null}}return await this._initJobHandler(),await this.updateRasterFunction(),\"raster-shaded-relief\"===this.renderer.type&&(s={...s,buffer:{cols:1,rows:1}}),this.raster.fetchTile(t,e,i,s)}async fetchPixels(t,e,r,i={}){return o(this.rasterInfo.multidimensionalInfo)&&(i=this.normalizeRasterFetchOptions(i),n(i.multidimensionalDefinition))?{extent:t,pixelBlock:null}:(await this._initJobHandler(),await this.updateRasterFunction(),this.raster.fetchPixels(t,e,r,i))}async identify(t,e={}){const{raster:r,rasterInfo:s}=this;if(o(s.multidimensionalInfo)){if(!(s.hasMultidimensionalTranspose&&!!(F(e.multidimensionalDefinition)||e.transposedVariableName||e.timeExtent))&&(e=this.normalizeRasterFetchOptions(e),n(e.multidimensionalDefinition)))return{location:t,value:null}}const a=this.multidimensionalSubset?.areaOfInterest;if(a&&!a.contains(t))throw new i(\"imagery-tile-mixin:identify\",\"the request cannot be fulfilled when falling outside of the multidimensional subset\");return r.identify(t,e)}increaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount++}decreaseRasterJobHandlerUsage(){this._rasterJobHandler.refCount--,this._rasterJobHandler.refCount<=0&&this._shutdownJobHandler()}hasStandardTime(){const t=this.rasterInfo?.multidimensionalInfo;if(n(t)||\"standard-time\"!==this.rasterInfo?.dataType)return!1;const e=this.multidimensionalDefinition,r=e?.[0]?.variableName;return t.variables.some((t=>t.name===r&&(!e?.[0].dimensionName||t.dimensions.some((t=>\"StdTime\"===t.name)))))}getStandardTimeValue(t){return new Date(24*(t-25569)*3600*1e3).toString()}getMultidimensionalSubsetVariables(t){const e=t??this.rasterInfo?.multidimensionalInfo;return I(this.multidimensionalSubset,e)}_configDefaultSettings(){this._configDefaultInterpolation(),this.multidimensionalDefinition||(this.multidimensionalDefinition=g(this.raster.rasterInfo,{multidimensionalSubset:this.multidimensionalSubset})),this._configDefaultRenderer()}_initJobHandler(){if(null!=this._rasterJobHandler.connectionPromise)return this._rasterJobHandler.connectionPromise;const t=new p;return this._rasterJobHandler.connectionPromise=t.initialize().then((()=>{C(this),this._rasterJobHandler.instance=t,this.raster.rasterJobHandler=t,this.renderer&&this.updateRenderer(),\"Function\"===this.raster.datasetFormat&&this.raster.syncJobHandler()})).catch((()=>{})),this._rasterJobHandler.connectionPromise}_shutdownJobHandler(){this._rasterJobHandler.instance&&this._rasterJobHandler.instance.destroy(),this._rasterJobHandler.instance=null,this._rasterJobHandler.connectionPromise=null,this._rasterJobHandler.refCount=0,this._cachedRendererJson=null,this.raster&&(this.raster.rasterJobHandler=null)}_configDefaultInterpolation(){if(null==this.interpolation){C(this);const{raster:t}=this,e=D(t.rasterInfo,t.tileType,this.sourceJSON?.defaultResamplingMethod);this._set(\"interpolation\",e)}}_configDefaultRenderer(t=\"no\"){C(this);const{rasterInfo:e}=this.raster;!this.bandIds&&e.bandCount>1&&(this.bandIds=j(e));const r=_(e,{multidimensionalDefinition:this.multidimensionalDefinition,multidimensionalSubset:this.multidimensionalSubset})?.name;if(!this.renderer||\"override\"===t){const t=H(e,{bandIds:this.bandIds,variableName:r});\"WCSServer\"===this.raster.datasetFormat&&\"raster-stretch\"===t.type&&((e.statistics?.[0].max??0)>1e24||(e.statistics?.[0].min??0)<-1e24)&&(t.dynamicRangeAdjustment=!0,t.statistics=null,\"none\"===t.stretchType&&(t.stretchType=\"min-max\")),this.renderer=t}const i=v({...this.renderer.toJSON(),variableName:r}),s=x(e,r);this.symbolizer?(this.symbolizer.rendererJSON=i,this.symbolizer.rasterInfo=s):this.symbolizer=new T({rendererJSON:i,rasterInfo:s});const n=this.symbolizer.bind();if(n.success){if(\"auto\"===t){const{colormap:t}=this.raster.rasterInfo,e=this.renderer;if(o(t))if(\"raster-colormap\"!==e.type)this._configDefaultRenderer(\"override\");else{const t=H(this.raster.rasterInfo);JSON.stringify(t)!==JSON.stringify(e)&&this._configDefaultRenderer(\"override\")}else if(\"raster-stretch\"===e.type){const t=this.bandIds?.length,r=e.statistics?.length;!e.dynamicRangeAdjustment&&r&&t&&r!==t&&this._configDefaultRenderer(\"override\")}}}else O.warn(\"imagery-tile-mixin\",n.error||\"The given renderer is not supported by the layer.\"),\"auto\"===t&&this._configDefaultRenderer(\"override\")}};function C(t){if(!t.raster||!t.rasterInfo)throw new i(\"imagery-tile\",\"no raster\")}return t([a()],z.prototype,\"_cachedRendererJson\",void 0),t([a()],z.prototype,\"_cachedRasterFunctionJson\",void 0),t([a()],z.prototype,\"_compatibleFullExtent\",void 0),t([a()],z.prototype,\"_isConstructedFromFunctionRaster\",void 0),t([a()],z.prototype,\"_rasterJobHandler\",void 0),t([a()],z.prototype,\"bandIds\",void 0),t([a({json:{origins:{service:{read:{source:\"copyrightText\"}}}}})],z.prototype,\"copyright\",void 0),t([a({json:{read:!1}})],z.prototype,\"fullExtent\",null),t([a()],z.prototype,\"interpolation\",void 0),t([a()],z.prototype,\"ioConfig\",void 0),t([a({type:[c],json:{write:!0}})],z.prototype,\"multidimensionalDefinition\",null),t([a({type:h,json:{write:!0}})],z.prototype,\"multidimensionalSubset\",void 0),t([a()],z.prototype,\"raster\",void 0),t([a({type:f})],z.prototype,\"rasterFunction\",void 0),t([a()],z.prototype,\"rasterInfo\",void 0),t([a()],z.prototype,\"sourceJSON\",void 0),t([a({readOnly:!0,type:N,json:{read:!1}})],z.prototype,\"spatialReference\",void 0),t([a({json:{read:!1}})],z.prototype,\"tileInfo\",null),t([a(d)],z.prototype,\"url\",null),t([a({types:e})],z.prototype,\"renderer\",null),t([a()],z.prototype,\"symbolizer\",void 0),z=t([l(\"esri.layers.ImageryTileMixin\")],z),z};export{z as ImageryTileMixin};\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA,SAAOA,CAAC,IAAIC,CAAZ,QAAkB,2BAAlB;AAA8C,OAAM,mBAAN;AAA0B,SAAOC,mBAAmB,IAAIC,CAA9B,QAAoC,0BAApC;AAA+D,OAAOC,CAAP,MAAa,kBAAb;AAAgC,OAAOC,CAAP,MAAa,qBAAb;AAAmC,OAAOC,CAAP,MAAa,sBAAb;AAAoC,SAAOC,MAAM,IAAIC,CAAjB,EAAmBC,MAAM,IAAIC,CAA7B,QAAmC,qBAAnC;AAAyD,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,mDAAzB;AAA6E,OAAM,0CAAN;AAAiD,OAAM,0BAAN;AAAiC,SAAOC,QAAQ,IAAIC,CAAnB,QAAyB,mDAAzB;AAA6E,SAAOC,OAAO,IAAIC,CAAlB,QAAwB,iDAAxB;AAA0E,SAAOC,WAAW,IAAIC,CAAtB,QAA4B,8BAA5B;AAA2D,SAAOC,GAAG,IAAIC,CAAd,QAAoB,gCAApB;AAAqD,OAAOC,CAAP,MAAa,qCAAb;AAAmD,OAAOC,CAAP,MAAa,sCAAb;AAAoD,OAAOC,CAAP,MAAa,8BAAb;AAA4C,OAAOC,CAAP,MAAa,gCAAb;AAA8C,OAAOC,CAAP,MAAa,wBAAb;AAAsC,OAAOC,CAAP,MAAa,6CAAb;AAA2D,SAAOC,oCAAoC,IAAIC,CAA/C,EAAiDC,8BAA8B,IAAIC,CAAnF,EAAqFC,qBAAqB,IAAI/B,CAA9G,EAAgHgC,6BAA6B,IAAIC,CAAjJ,EAAmJC,4BAA4B,IAAIC,CAAnL,QAAyL,oDAAzL;AAA8O,SAAOC,MAAM,IAAIC,CAAjB,QAAuB,oDAAvB;AAA4E,SAAOC,sBAAsB,IAAIC,CAAjC,QAAuC,gDAAvC;AAAwF,SAAOC,qBAAqB,IAAIC,CAAhC,EAAkCC,qBAAqB,IAAIC,CAA3D,EAA6DC,uBAAuB,IAAIC,CAAxF,EAA0FC,yBAAyB,IAAIC,CAAvH,EAAyHC,qBAAqB,IAAIC,CAAlJ,QAAwJ,iDAAxJ;AAA0M,OAAOC,CAAP,MAAa,6CAAb;AAA2D,SAAOC,cAAc,IAAIC,CAAzB,QAA+B,yCAA/B;AAAyE,OAAOC,CAAP,MAAa,oCAAb;;AAAkD,MAAMC,CAAC,GAAChD,CAAC,CAACiD,SAAF,CAAY,qCAAZ,CAAR;AAAA,MAA2DC,CAAC,GAAClD,CAAC,IAAE;EAAC,IAAIkD,CAAC,GAAC,cAAclD,CAAd,CAAe;IAACmD,WAAW,CAAC,GAAGxD,CAAJ,EAAM;MAAC,MAAM,GAAGA,CAAT,GAAY,KAAKyD,gCAAL,GAAsC,CAAC,CAAnD,EAAqD,KAAKC,iBAAL,GAAuB;QAACC,QAAQ,EAAC,IAAV;QAAeC,QAAQ,EAAC,CAAxB;QAA0BC,iBAAiB,EAAC;MAA5C,CAA5E,EAA8H,KAAKC,OAAL,GAAa,IAA3I,EAAgJ,KAAKC,SAAL,GAAe,IAA/J,EAAoK,KAAKC,aAAL,GAAmB,SAAvL,EAAiM,KAAKC,sBAAL,GAA4B,IAA7N,EAAkO,KAAKC,MAAL,GAAY,IAA9O,EAAmP,KAAKC,cAAL,GAAoB,IAAvQ,EAA4Q,KAAKC,UAAL,GAAgB,IAA5R,EAAiS,KAAKC,UAAL,GAAgB,IAAjT,EAAsT,KAAKC,gBAAL,GAAsB,IAA5U,EAAiV,KAAKC,UAAL,GAAgB,IAAjW,EAAsW,KAAKd,gCAAL,GAAsC,eAAazD,CAAC,CAAC,CAAD,CAAD,EAAMkE,MAAN,EAAcM,aAAva;IAAqb;;IAAc,IAAVC,UAAU,GAAE;MAAC,OAAO,KAAKL,UAAL,EAAiBM,MAAxB;IAA+B;;IAA8B,IAA1BC,0BAA0B,CAAC3E,CAAD,EAAG;MAAC,KAAK4E,IAAL,CAAU,4BAAV,EAAuC5E,CAAvC,GAA0C,KAAK6E,cAAL,EAA1C;IAAgE;;IAAY,IAARC,QAAQ,GAAE;MAAC,OAAO,KAAKV,UAAL,EAAiBW,WAAjB,CAA6BD,QAApC;IAA6C;;IAAO,IAAH5D,GAAG,CAAClB,CAAD,EAAG;MAAC,KAAK4E,IAAL,CAAU,KAAV,EAAgB3D,CAAC,CAACjB,CAAD,EAAGqD,CAAH,CAAjB;IAAwB;;IAAY,IAAR2B,QAAQ,CAAChF,CAAD,EAAG;MAAC,KAAK4E,IAAL,CAAU,UAAV,EAAqB5E,CAArB,GAAwB,KAAK6E,cAAL,EAAxB;IAA8C;;IAAMxC,sBAAsB,CAACrC,CAAD,EAAGE,CAAH,EAAK;MAAA;;MAAA;QAAC,IAAGK,CAAC,CAACP,CAAD,CAAD,IAAM,CAAC,KAAI,CAACoE,UAAf,EAA0B,OAAO,IAAP;QAAY,MAAMjE,CAAC,GAAC,KAAI,CAACuD,iBAAL,CAAuBC,QAA/B;QAAA,MAAwCvD,CAAC,GAAC,KAAI,CAACgE,UAAL,CAAgBa,QAA1D;QAAmE,OAAO9E,CAAC,GAACA,CAAC,CAACkC,sBAAF,CAAyB;UAAC6C,UAAU,EAAClF,CAAZ;UAAciF,QAAQ,EAAC7E;QAAvB,CAAzB,EAAmDF,CAAnD,CAAD,GAAuDoC,CAAC,CAACtC,CAAD,EAAGI,CAAH,CAAhE;MAA1G;IAAgL;;IAAM8C,cAAc,CAAClD,CAAD,EAAGE,CAAH,EAAK;MAAA;;MAAA;QAAC,MAAMC,CAAC,GAAC,MAAI,CAACuD,iBAAL,CAAuBC,QAA/B;QAAwC,OAAOxD,CAAC,GAACA,CAAC,CAAC+C,cAAF,CAAiBlD,CAAjB,EAAmBE,CAAnB,CAAD,GAAuBiD,CAAC,CAACnD,CAAC,CAACmF,QAAH,EAAYnF,CAAC,CAACoF,kBAAd,EAAiCpF,CAAC,CAACqF,QAAnC,EAA4C5E,CAAC,CAACP,CAAC,CAACoF,MAAH,CAAD,GAAYpF,CAAC,CAACoF,MAAd,GAAsB,IAAIC,eAAJ,EAAD,CAAsBD,MAAvF,CAAhC;MAAzC;IAAwK;;IAAAE,2BAA2B,CAACxF,CAAD,EAAG;MAAC,MAAK;QAACyF,oBAAoB,EAACvF;MAAtB,IAAyB,KAAKkE,UAAL,IAAiB,EAA/C;MAAkD,IAAG7D,CAAC,CAACL,CAAD,CAAJ,EAAQ,OAAOF,CAAP;MAAS,IAAIG,CAAC,GAACH,CAAC,CAAC2E,0BAAF,IAA8B,KAAKA,0BAAzC;MAAoE,CAACpE,CAAC,CAACJ,CAAD,CAAF,IAAOA,CAAC,CAACuF,MAAT,KAAkBvF,CAAC,GAACwB,CAAC,CAAC,KAAKuC,MAAL,CAAYE,UAAb,EAAwB;QAACH,sBAAsB,EAAC,KAAKA;MAA7B,CAAxB,CAArB;MAAoG,MAAM7D,CAAC,GAACJ,CAAC,CAAC2F,UAAF,IAAc,KAAKA,UAA3B;;MAAsC,IAAGlF,CAAC,CAACN,CAAD,CAAD,IAAMM,CAAC,CAACL,CAAD,CAAP,KAAaK,CAAC,CAACL,CAAC,CAACwF,KAAH,CAAD,IAAYnF,CAAC,CAACL,CAAC,CAACyF,GAAH,CAA1B,CAAH,EAAsC;QAAC1F,CAAC,GAACA,CAAC,CAAC2F,GAAF,CAAO9F,CAAC,IAAEA,CAAC,CAAC+F,KAAF,EAAV,CAAF;QAAwB,MAAM1F,CAAC,GAACH,CAAC,CAAC8F,SAAF,CAAYC,IAAZ,CAAkB,CAAC;UAACC,IAAI,EAAClG;QAAN,CAAD,KAAYA,CAAC,KAAGG,CAAC,CAAC,CAAD,CAAD,CAAKgG,YAAvC,GAAuDC,UAAvD,EAAmEH,IAAnE,CAAyE,CAAC;UAACC,IAAI,EAAClG;QAAN,CAAD,KAAY,cAAYA,CAAjG,CAAR;QAAA,MAA6GW,CAAC,GAACR,CAAC,CAAC8F,IAAF,CAAQ,CAAC;UAACI,aAAa,EAACrG;QAAf,CAAD,KAAqB,cAAYA,CAAzC,CAA/G;QAA4J,IAAG,CAACK,CAAD,IAAI,CAACM,CAAR,EAAU,OAAM,EAAC,GAAGX,CAAJ;UAAM2E,0BAA0B,EAAC;QAAjC,CAAN;QAA6C,MAAK;UAACiB,KAAK,EAAC/E,CAAP;UAASgF,GAAG,EAAC9E;QAAb,IAAgBX,CAArB;QAAA,MAAuBa,CAAC,GAACV,CAAC,CAACM,CAAD,CAAD,GAAK,IAAL,GAAUA,CAAC,CAACyF,OAAF,EAAnC;QAAA,MAA+CnF,CAAC,GAACZ,CAAC,CAACQ,CAAD,CAAD,GAAK,IAAL,GAAUA,CAAC,CAACuF,OAAF,EAA3D;QAAA,MAAuElF,CAAC,GAACH,CAAC,IAAEE,CAA5E;QAAA,MAA8EE,CAAC,GAACF,CAAC,IAAEF,CAAnF;;QAAqF,IAAGR,CAAC,CAACJ,CAAC,CAACkG,MAAH,CAAJ,EAAe;UAAC,MAAMvG,CAAC,GAACK,CAAC,CAACkG,MAAF,CAASC,MAAT,CAAiBxG,CAAC,IAAE;YAAC,IAAGyG,KAAK,CAACC,OAAN,CAAc1G,CAAd,CAAH,EAAoB;cAAC,IAAGoB,CAAC,KAAGC,CAAP,EAAS,OAAOrB,CAAC,CAAC,CAAD,CAAD,IAAMoB,CAAN,IAASpB,CAAC,CAAC,CAAD,CAAD,IAAMoB,CAAtB;cAAwB,MAAMlB,CAAC,GAACF,CAAC,CAAC,CAAD,CAAD,IAAMoB,CAAN,IAASpB,CAAC,CAAC,CAAD,CAAD,GAAKoB,CAAd,IAAiBpB,CAAC,CAAC,CAAD,CAAD,GAAKqB,CAAL,IAAQrB,CAAC,CAAC,CAAD,CAAD,IAAMqB,CAAvC;cAAA,MAAyClB,CAAC,GAACH,CAAC,CAAC,CAAD,CAAD,IAAMoB,CAAN,IAASpB,CAAC,CAAC,CAAD,CAAD,IAAMqB,CAAf,IAAkBrB,CAAC,CAAC,CAAD,CAAD,GAAKoB,CAAL,IAAQpB,CAAC,CAAC,CAAD,CAAD,GAAKqB,CAA1E;cAA4E,OAAOnB,CAAC,IAAEC,CAAV;YAAY;;YAAA,OAAOiB,CAAC,KAAGC,CAAJ,GAAMrB,CAAC,KAAGoB,CAAV,GAAYpB,CAAC,IAAEoB,CAAH,IAAMpB,CAAC,IAAEqB,CAA5B;UAA8B,CAAjM,CAAR;;UAA4M,IAAGrB,CAAC,CAAC0F,MAAL,EAAY;YAAC,MAAMxF,CAAC,GAACF,CAAC,CAAC2G,IAAF,CAAQ,CAAC3G,CAAD,EAAGE,CAAH,KAAO;cAAC,IAAGkB,CAAC,KAAGC,CAAP,EAAS,OAAM,CAACrB,CAAC,CAAC,CAAD,CAAD,IAAMA,CAAP,KAAWE,CAAC,CAAC,CAAD,CAAD,IAAMA,CAAjB,CAAN;cAA0B,OAAO0G,IAAI,CAACC,GAAL,CAAS,CAAC7G,CAAC,CAAC,CAAD,CAAD,IAAMA,CAAP,IAAUqB,CAAnB,IAAsBuF,IAAI,CAACC,GAAL,CAAS,CAAC3G,CAAC,CAAC,CAAD,CAAD,IAAMA,CAAP,IAAUmB,CAAnB,CAA7B;YAAmD,CAAtG,EAAyG,CAAzG,CAAR;YAAoHV,CAAC,CAAC4F,MAAF,GAAS,CAACrG,CAAD,CAAT;UAAa,CAA9I,MAAmJC,CAAC,GAAC,IAAF;QAAO,CAAtX,MAA2X,IAAGE,CAAC,CAACyG,mBAAF,IAAuBzG,CAAC,CAACqE,MAA5B,EAAmC;UAAC,MAAK,CAAC1E,CAAD,EAAGE,CAAH,IAAMG,CAAC,CAACqE,MAAb;UAAoBtD,CAAC,GAAClB,CAAF,IAAKmB,CAAC,GAACrB,CAAP,GAASG,CAAC,GAAC,IAAX,GAAgBQ,CAAC,CAAC4F,MAAF,GAASnF,CAAC,KAAGC,CAAJ,GAAM,CAACD,CAAD,CAAN,GAAU,CAACwF,IAAI,CAACG,GAAL,CAAS/G,CAAT,EAAWoB,CAAX,CAAD,EAAewF,IAAI,CAACI,GAAL,CAAS9G,CAAT,EAAWmB,CAAX,CAAf,CAAnC;QAAiE;MAAC;;MAAA,OAAOZ,CAAC,CAACN,CAAD,CAAD,IAAM0B,CAAC,CAAC1B,CAAD,EAAG,KAAK8D,sBAAR,CAAP,GAAuC,EAAC,GAAGjE,CAAJ;QAAM2E,0BAA0B,EAAC;MAAjC,CAAvC,GAA8E,EAAC,GAAG3E,CAAJ;QAAM2E,0BAA0B,EAACxE;MAAjC,CAArF;IAAyH;;IAAM8G,oBAAoB,GAAE;MAAA;;MAAA;QAAC,IAAG,mBAAiB,MAAI,CAACC,IAAtB,IAA4B,CAAC,MAAI,CAAC/C,cAAN,IAAsB,CAAC,MAAI,CAACgD,yBAAxD,IAAmFC,IAAI,CAACC,SAAL,CAAe,MAAI,CAAClD,cAApB,MAAsCiD,IAAI,CAACC,SAAL,CAAe,MAAI,CAACF,yBAApB,CAA5H,EAA2K;;QAAO,IAAG,MAAI,CAAC1D,gCAAL,IAAuC,eAAa,MAAI,CAACS,MAAL,CAAYM,aAAnE,EAAiF;UAAC,MAAMxE,CAAC,GAAC,MAAI,CAACkE,MAAL,CAAYC,cAAZ,CAA2BmD,MAA3B,EAAR;;UAA4C,OAAM,CAAC,MAAI,CAACnD,cAAN,IAAsBnE,CAAtB,IAAyB,MAAI,CAAC4E,IAAL,CAAU,gBAAV,EAA2BtD,CAAC,CAACiG,QAAF,CAAWvH,CAAX,CAA3B,CAAzB,EAAmE,MAAK,MAAI,CAACmH,yBAAL,GAA+B,MAAI,CAAChD,cAAL,EAAqBmD,MAArB,EAApC,CAAzE;QAA4I;;QAAA,IAAItH,CAAJ;QAAA,IAAME,CAAC,GAAC,MAAI,CAACgE,MAAb;QAAA,IAAoB/D,CAAC,GAAC,CAAC,CAAvB;QAAyB,eAAaD,CAAC,CAACsE,aAAf,IAA8BxE,CAAC,GAACE,CAAC,CAACsH,cAAF,CAAiBC,OAAnB,EAA2BvH,CAAC,GAACF,CAAC,CAAC,CAAD,CAA9B,EAAkCG,CAAC,GAAC,CAAC,CAAnE,IAAsEH,CAAC,GAAC,CAACE,CAAD,CAAxE;QAA4E,MAAK;UAACiE,cAAc,EAAC/D;QAAhB,IAAmB,MAAxB;;QAA6B,IAAGA,CAAH,EAAK;UAAC,MAAMD,CAAC,GAAC;YAAC+D,MAAM,EAAChE;UAAR,CAAR;UAAmBF,CAAC,CAAC0F,MAAF,GAAS,CAAT,IAAY1F,CAAC,CAAC0H,OAAF,CAAW1H,CAAC,IAAEG,CAAC,CAACH,CAAC,CAACkB,GAAH,CAAD,GAASlB,CAAvB,CAAZ;UAAuC,MAAMK,CAAC,GAAC+B,CAAC,CAAChC,CAAC,CAACuH,wBAAF,IAA4BvH,CAAC,CAACkH,MAAF,EAA7B,EAAwCnH,CAAxC,CAAT;UAAA,MAAoDI,CAAC,GAAC,IAAIkB,CAAJ,CAAM;YAAC0C,cAAc,EAAC9D;UAAhB,CAAN,CAAtD;UAAgFE,CAAC,CAACqH,gBAAF,GAAmB,MAAI,CAAClE,iBAAL,CAAuBC,QAA1C,QAAyDpD,CAAC,CAACsH,IAAF,EAAzD,EAAkE,MAAI,CAACV,yBAAL,GAA+B,MAAI,CAAChD,cAAL,EAAqBmD,MAArB,EAAjG,EAA+H,MAAI,CAACpD,MAAL,GAAY3D,CAA3I;QAA6I,CAA7R,MAAkS,MAAI,CAAC2D,MAAL,GAAYhE,CAAZ,EAAc,MAAI,CAACiH,yBAAL,GAA+B,IAA7C;;QAAkD,IAAG,MAAI,CAACW,mBAAL,GAAyB,IAAzB,EAA8B,CAAC3H,CAAD,IAAI,CAACC,CAAtC,EAAwC;QAAO,MAAK;UAAC0D,OAAO,EAACzD;QAAT,IAAY,MAAjB;QAAA,MAAsB;UAAC0H,SAAS,EAACxH;QAAX,IAAc,MAAI,CAAC2D,MAAL,CAAYE,UAAhD;QAAA,MAA2D3D,CAAC,GAACJ,CAAC,EAAEqF,MAAH,GAAUrF,CAAC,CAAC2H,IAAF,CAAQhI,CAAC,IAAEA,CAAC,IAAEO,CAAd,CAAV,GAA4BA,CAAC,IAAE,CAA5F;QAA8FF,CAAC,KAAGI,CAAC,IAAE,qBAAmB,MAAI,CAACuE,QAAL,CAAckC,IAAvC,CAAD,IAA+C,MAAI,CAACtC,IAAL,CAAU,SAAV,EAAoB,IAApB,CAA/C,EAAyE,MAAI,CAACqD,sBAAL,CAA4B,MAA5B,CAAzE;MAAhiC;IAA6oC;;IAAMpD,cAAc,GAAE;MAAA;;MAAA;QAAC,MAAK;UAACqD,MAAM,EAAClI,CAAR;UAAUuE,UAAU,EAACrE;QAArB,IAAwB,MAA7B;QAAkC,IAAG,CAACF,CAAD,IAAI,CAACE,CAAR,EAAU;QAAO,MAAK;UAACkE,UAAU,EAACjE;QAAZ,IAAe,MAAI,CAAC+D,MAAzB;QAAA,MAAgC9D,CAAC,GAACL,CAAC,CAACI,CAAD,EAAG;UAACwE,0BAA0B,EAAC,MAAI,CAACA,0BAAjC;UAA4DV,sBAAsB,EAAC,MAAI,CAACA;QAAxF,CAAH,CAAD,EAAsHiC,IAAxJ;QAAA,MAA6J7F,CAAC,GAACmC,CAAC,CAAC,EAAC,GAAG,MAAI,CAACwC,QAAL,CAAcsC,MAAd,EAAJ;UAA2BnB,YAAY,EAAC/F;QAAxC,CAAD,CAAhK;QAA6M,IAAGgH,IAAI,CAACC,SAAL,CAAe,MAAI,CAACS,mBAApB,MAA2CV,IAAI,CAACC,SAAL,CAAehH,CAAf,CAA9C,EAAgE;QAAO,MAAME,CAAC,GAAC,MAAI,CAACmD,iBAAL,CAAuBC,QAA/B;QAAwCpD,CAAC,KAAGL,CAAC,CAACkE,UAAF,GAAa1B,CAAC,CAACvC,CAAD,EAAGC,CAAH,CAAd,EAAoBF,CAAC,CAACiI,YAAF,GAAe9H,CAAnC,EAAqCH,CAAC,CAACkI,IAAF,EAArC,QAAoD7H,CAAC,CAAC8H,gBAAF,CAAmBnI,CAAnB,CAApD,EAA0E,MAAI,CAAC4H,mBAAL,GAAyBzH,CAAtG,CAAD;MAAhX;IAA0d;;IAAMiI,aAAa,CAACtI,CAAD,EAAGE,CAAH,EAAK;MAAA;;MAAA;QAAC,MAAMC,CAAC,GAACH,CAAC,IAAEA,CAAC,CAACkF,UAAb;QAAwB,IAAG,EAAEzE,CAAC,CAACN,CAAD,CAAD,IAAMA,CAAC,CAACoI,MAAR,IAAgBpI,CAAC,CAACoI,MAAF,CAAS7C,MAAT,GAAgB,CAAlC,CAAH,EAAwC,OAAO,IAAP;QAAY,IAAItF,CAAJ;QAAM,MAAM,MAAI,CAACyE,cAAL,EAAN;QAA4B,MAAMxE,CAAC,GAAC,MAAI,CAACqD,iBAAL,CAAuBC,QAA/B;QAAA,MAAwCpD,CAAC,GAAC,MAAI,CAACuD,OAAL,IAAc,EAAxD;QAA2D,OAAO1D,CAAC,GAACC,CAAC,SAAOA,CAAC,CAACmI,SAAF,CAAY,EAAC,GAAGxI,CAAJ;UAAMyI,mBAAmB,EAACvI,CAA1B;UAA4B4D,OAAO,EAACvD;QAApC,CAAZ,CAAP,GAA2D,MAAI,CAACgE,UAAL,CAAgBiE,SAAhB,CAA0B,EAAC,GAAGxI,CAAJ;UAAMyI,mBAAmB,EAACvI,CAA1B;UAA4B4D,OAAO,EAACvD;QAApC,CAA1B,CAA9D,EAAgIH,CAAvI;MAA1K;IAAmT;;IAAAsI,UAAU,CAAC1I,CAAD,EAAGE,CAAH,EAAKC,CAAL,EAAO;MAAC,OAAM,uBAAqB,KAAK+D,MAAL,CAAYM,aAAjC,GAAgD,GAAE,KAAKtD,GAAI,SAAQlB,CAAE,IAAGE,CAAE,IAAGC,CAAE,EAA/E,GAAiF,EAAvF;IAA0F;;IAAAwI,qBAAqB,CAAC3I,CAAD,EAAGE,CAAH,EAAKC,CAAC,GAAC,CAAC,CAAR,EAAU;MAAC,IAAG,CAAC,KAAK+H,MAAN,IAAc3H,CAAC,CAACL,CAAD,CAAlB,EAAsB,OAAO,IAAP;MAAY,IAAGC,CAAC,IAAEH,CAAC,CAAC4I,MAAF,CAAS,KAAKtE,gBAAd,CAAN,EAAsC,OAAO,KAAKQ,QAAZ;MAAqB,MAAM1E,CAAC,GAACW,CAAC,CAACf,CAAD,CAAT;MAAa,OAAOwB,CAAC,CAACW,MAAF,CAAS;QAAC0G,IAAI,EAAC,GAAN;QAAUvE,gBAAgB,EAACtE,CAA3B;QAA6B8I,MAAM,EAAC1I,CAAC,GAAC;UAACsC,CAAC,EAACtC,CAAC,CAAC0I,MAAF,CAAS,CAAT,CAAH;UAAetH,CAAC,EAACpB,CAAC,CAAC0I,MAAF,CAAS,CAAT;QAAjB,CAAD,GAA+B;UAACpG,CAAC,EAACxC,CAAC,CAAC6I,IAAL;UAAUvH,CAAC,EAACtB,CAAC,CAAC8I;QAAd;MAApE,CAAT,CAAP;IAA0G;;IAAAC,uBAAuB,CAACjJ,CAAD,EAAG;MAAC,OAAO,KAAKkI,MAAL,IAAa,KAAKgB,qBAAL,IAA4B,KAAKA,qBAAL,CAA2B5E,gBAA3B,CAA4CsE,MAA5C,CAAmD5I,CAAnD,CAA5B,KAAoF,KAAKkJ,qBAAL,GAA2B,KAAKhF,MAAL,CAAYiF,aAAZ,CAA0BnJ,CAA1B,CAA/G,GAA6I,KAAKkJ,qBAA/J,IAAsL,IAA7L;IAAkM;;IAAME,SAAS,CAACpJ,CAAD,EAAGE,CAAH,EAAKE,CAAL,EAAOC,CAAC,GAAC,EAAT,EAAY;MAAA;;MAAA;QAAC,IAAGgJ,CAAC,CAAC,MAAD,CAAD,EAAQhJ,CAAC,CAACiJ,qBAAb,EAAmC;UAAC,MAAM/I,CAAC,GAAC,MAAI,CAACmI,UAAL,CAAgB1I,CAAhB,EAAkBE,CAAlB,EAAoBE,CAApB,CAAR;;UAA+B,OAAOD,CAAC,CAACI,CAAD,EAAG;YAACgJ,YAAY,EAAC,OAAd;YAAsBC,KAAK,EAAC,EAAC,GAAG,MAAI,CAACC,iBAAT;cAA2B,GAAG,MAAI,CAACvF,MAAL,CAAYwF,QAAZ,CAAqBC;YAAnD,CAA5B;YAAsGrE,MAAM,EAACjF,CAAC,CAACiF;UAA/G,CAAH,CAAD,CAA4HsE,IAA5H,CAAkI5J,CAAC,IAAEA,CAAC,CAAC6J,IAAvI,CAAP;QAAqJ;;QAAA,MAAK;UAACzF,UAAU,EAACzD;QAAZ,IAAe,MAApB;;QAAyB,IAAGF,CAAC,CAACE,CAAC,CAAC8E,oBAAH,CAAD,KAA4BpF,CAAC,GAAC,MAAI,CAACmF,2BAAL,CAAiCnF,CAAjC,CAAF,EAAsCE,CAAC,CAACF,CAAC,CAACsE,0BAAH,CAAnE,CAAH,EAAsG;UAAC,MAAMxE,CAAC,GAACE,CAAC,CAACyE,QAAF,IAAYnE,CAAC,CAACoE,WAAF,CAAcD,QAAlC;UAA2C,OAAM;YAACJ,MAAM,EAAC,MAAI,CAACR,MAAL,CAAY4F,yBAAZ,CAAsC9J,CAAtC,EAAwCE,CAAxC,EAA0CE,CAA1C,EAA4CD,CAA5C,CAAR;YAAuD+E,UAAU,EAAC;UAAlE,CAAN;QAA8E;;QAAA,OAAO,MAAM,MAAI,CAAC6E,eAAL,EAAN,QAAmC,MAAI,CAAC9C,oBAAL,EAAnC,EAA+D,2BAAyB,MAAI,CAACjC,QAAL,CAAckC,IAAvC,KAA8C7G,CAAC,GAAC,EAAC,GAAGA,CAAJ;UAAM2J,MAAM,EAAC;YAACC,IAAI,EAAC,CAAN;YAAQC,IAAI,EAAC;UAAb;QAAb,CAAhD,CAA/D,EAA8I,MAAI,CAAChG,MAAL,CAAYkF,SAAZ,CAAsBpJ,CAAtB,EAAwBE,CAAxB,EAA0BE,CAA1B,EAA4BC,CAA5B,CAArJ;MAAld;IAAsoB;;IAAM8J,WAAW,CAACnK,CAAD,EAAGE,CAAH,EAAKC,CAAL,EAAOC,CAAC,GAAC,EAAT,EAAY;MAAA;;MAAA;QAAC,OAAOK,CAAC,CAAC,MAAI,CAAC2D,UAAL,CAAgBqB,oBAAjB,CAAD,KAA0CrF,CAAC,GAAC,MAAI,CAACoF,2BAAL,CAAiCpF,CAAjC,CAAF,EAAsCG,CAAC,CAACH,CAAC,CAACuE,0BAAH,CAAjF,IAAiH;UAACD,MAAM,EAAC1E,CAAR;UAAUkF,UAAU,EAAC;QAArB,CAAjH,IAA6I,MAAM,MAAI,CAAC6E,eAAL,EAAN,QAAmC,MAAI,CAAC9C,oBAAL,EAAnC,EAA+D,MAAI,CAAC/C,MAAL,CAAYiG,WAAZ,CAAwBnK,CAAxB,EAA0BE,CAA1B,EAA4BC,CAA5B,EAA8BC,CAA9B,CAA5M,CAAP;MAAD;IAAsP;;IAAMgK,QAAQ,CAACpK,CAAD,EAAGE,CAAC,GAAC,EAAL,EAAQ;MAAA;;MAAA;QAAC,MAAK;UAACgE,MAAM,EAAC/D,CAAR;UAAUiE,UAAU,EAAC/D;QAArB,IAAwB,MAA7B;;QAAkC,IAAGI,CAAC,CAACJ,CAAC,CAACoF,oBAAH,CAAJ,EAA6B;UAAC,IAAG,EAAEpF,CAAC,CAACgK,4BAAF,IAAgC,CAAC,EAAErI,CAAC,CAAC9B,CAAC,CAACyE,0BAAH,CAAD,IAAiCzE,CAAC,CAACoK,sBAAnC,IAA2DpK,CAAC,CAACyF,UAA/D,CAAnC,MAAiHzF,CAAC,GAAC,MAAI,CAACsF,2BAAL,CAAiCtF,CAAjC,CAAF,EAAsCK,CAAC,CAACL,CAAC,CAACyE,0BAAH,CAAxJ,CAAH,EAA2L,OAAM;YAAC4F,QAAQ,EAACvK,CAAV;YAAYwK,KAAK,EAAC;UAAlB,CAAN;QAA8B;;QAAA,MAAM7J,CAAC,GAAC,MAAI,CAACsD,sBAAL,EAA6BwG,cAArC;QAAoD,IAAG9J,CAAC,IAAE,CAACA,CAAC,CAAC+J,QAAF,CAAW1K,CAAX,CAAP,EAAqB,MAAM,IAAII,CAAJ,CAAM,6BAAN,EAAoC,qFAApC,CAAN;QAAiI,OAAOD,CAAC,CAACiK,QAAF,CAAWpK,CAAX,EAAaE,CAAb,CAAP;MAApe;IAA2f;;IAAAyK,6BAA6B,GAAE;MAAC,KAAKjH,iBAAL,CAAuBE,QAAvB;IAAkC;;IAAAgH,6BAA6B,GAAE;MAAC,KAAKlH,iBAAL,CAAuBE,QAAvB,IAAkC,KAAKF,iBAAL,CAAuBE,QAAvB,IAAiC,CAAjC,IAAoC,KAAKiH,mBAAL,EAAtE;IAAiG;;IAAAC,eAAe,GAAE;MAAC,MAAM9K,CAAC,GAAC,KAAKoE,UAAL,EAAiBqB,oBAAzB;MAA8C,IAAGlF,CAAC,CAACP,CAAD,CAAD,IAAM,oBAAkB,KAAKoE,UAAL,EAAiBa,QAA5C,EAAqD,OAAM,CAAC,CAAP;MAAS,MAAM/E,CAAC,GAAC,KAAKyE,0BAAb;MAAA,MAAwCxE,CAAC,GAACD,CAAC,GAAG,CAAH,CAAD,EAAQiG,YAAlD;MAA+D,OAAOnG,CAAC,CAACgG,SAAF,CAAYgC,IAAZ,CAAkBhI,CAAC,IAAEA,CAAC,CAACkG,IAAF,KAAS/F,CAAT,KAAa,CAACD,CAAC,GAAG,CAAH,CAAD,CAAOmG,aAAR,IAAuBrG,CAAC,CAACoG,UAAF,CAAa4B,IAAb,CAAmBhI,CAAC,IAAE,cAAYA,CAAC,CAACkG,IAApC,CAApC,CAArB,CAAP;IAA8G;;IAAA6E,oBAAoB,CAAC/K,CAAD,EAAG;MAAC,OAAO,IAAIgL,IAAJ,CAAS,MAAIhL,CAAC,GAAC,KAAN,IAAa,IAAb,GAAkB,GAA3B,EAAgCiL,QAAhC,EAAP;IAAkD;;IAAAC,kCAAkC,CAAClL,CAAD,EAAG;MAAC,MAAME,CAAC,GAACF,CAAC,IAAE,KAAKoE,UAAL,EAAiBqB,oBAA5B;MAAiD,OAAOvD,CAAC,CAAC,KAAK+B,sBAAN,EAA6B/D,CAA7B,CAAR;IAAwC;;IAAAiL,sBAAsB,GAAE;MAAC,KAAKC,2BAAL,IAAmC,KAAKzG,0BAAL,KAAkC,KAAKA,0BAAL,GAAgChD,CAAC,CAAC,KAAKuC,MAAL,CAAYE,UAAb,EAAwB;QAACH,sBAAsB,EAAC,KAAKA;MAA7B,CAAxB,CAAnE,CAAnC,EAAqL,KAAKgE,sBAAL,EAArL;IAAmN;;IAAA8B,eAAe,GAAE;MAAC,IAAG,QAAM,KAAKrG,iBAAL,CAAuBG,iBAAhC,EAAkD,OAAO,KAAKH,iBAAL,CAAuBG,iBAA9B;MAAgD,MAAM7D,CAAC,GAAC,IAAIuB,CAAJ,EAAR;MAAc,OAAO,KAAKmC,iBAAL,CAAuBG,iBAAvB,GAAyC7D,CAAC,CAACqL,UAAF,GAAezB,IAAf,CAAqB,MAAI;QAACP,CAAC,CAAC,IAAD,CAAD,EAAQ,KAAK3F,iBAAL,CAAuBC,QAAvB,GAAgC3D,CAAxC,EAA0C,KAAKkE,MAAL,CAAY0D,gBAAZ,GAA6B5H,CAAvE,EAAyE,KAAKgF,QAAL,IAAe,KAAKH,cAAL,EAAxF,EAA8G,eAAa,KAAKX,MAAL,CAAYM,aAAzB,IAAwC,KAAKN,MAAL,CAAYoH,cAAZ,EAAtJ;MAAmL,CAA7M,EAAgNC,KAAhN,CAAuN,MAAI,CAAE,CAA7N,CAAzC,EAAyQ,KAAK7H,iBAAL,CAAuBG,iBAAvS;IAAyT;;IAAAgH,mBAAmB,GAAE;MAAC,KAAKnH,iBAAL,CAAuBC,QAAvB,IAAiC,KAAKD,iBAAL,CAAuBC,QAAvB,CAAgC6H,OAAhC,EAAjC,EAA2E,KAAK9H,iBAAL,CAAuBC,QAAvB,GAAgC,IAA3G,EAAgH,KAAKD,iBAAL,CAAuBG,iBAAvB,GAAyC,IAAzJ,EAA8J,KAAKH,iBAAL,CAAuBE,QAAvB,GAAgC,CAA9L,EAAgM,KAAKkE,mBAAL,GAAyB,IAAzN,EAA8N,KAAK5D,MAAL,KAAc,KAAKA,MAAL,CAAY0D,gBAAZ,GAA6B,IAA3C,CAA9N;IAA+Q;;IAAAwD,2BAA2B,GAAE;MAAC,IAAG,QAAM,KAAKpH,aAAd,EAA4B;QAACqF,CAAC,CAAC,IAAD,CAAD;QAAQ,MAAK;UAACnF,MAAM,EAAClE;QAAR,IAAW,IAAhB;QAAA,MAAqBE,CAAC,GAAC0C,CAAC,CAAC5C,CAAC,CAACoE,UAAH,EAAcpE,CAAC,CAACyL,QAAhB,EAAyB,KAAKpH,UAAL,EAAiBqH,uBAA1C,CAAxB;;QAA2F,KAAK9G,IAAL,CAAU,eAAV,EAA0B1E,CAA1B;MAA6B;IAAC;;IAAA+H,sBAAsB,CAACjI,CAAC,GAAC,IAAH,EAAQ;MAACqJ,CAAC,CAAC,IAAD,CAAD;MAAQ,MAAK;QAACjF,UAAU,EAAClE;MAAZ,IAAe,KAAKgE,MAAzB;MAAgC,CAAC,KAAKJ,OAAN,IAAe5D,CAAC,CAAC6H,SAAF,GAAY,CAA3B,KAA+B,KAAKjE,OAAL,GAAahB,CAAC,CAAC5C,CAAD,CAA7C;MAAkD,MAAMC,CAAC,GAACJ,CAAC,CAACG,CAAD,EAAG;QAACyE,0BAA0B,EAAC,KAAKA,0BAAjC;QAA4DV,sBAAsB,EAAC,KAAKA;MAAxF,CAAH,CAAD,EAAsHiC,IAA9H;;MAAmI,IAAG,CAAC,KAAKlB,QAAN,IAAgB,eAAahF,CAAhC,EAAkC;QAAC,MAAMA,CAAC,GAACgD,CAAC,CAAC9C,CAAD,EAAG;UAAC4D,OAAO,EAAC,KAAKA,OAAd;UAAsBqC,YAAY,EAAChG;QAAnC,CAAH,CAAT;QAAmD,gBAAc,KAAK+D,MAAL,CAAYM,aAA1B,IAAyC,qBAAmBxE,CAAC,CAACkH,IAA9D,KAAqE,CAAChH,CAAC,CAACyL,UAAF,GAAe,CAAf,EAAkB5E,GAAlB,IAAuB,CAAxB,IAA2B,IAA3B,IAAiC,CAAC7G,CAAC,CAACyL,UAAF,GAAe,CAAf,EAAkB3E,GAAlB,IAAuB,CAAxB,IAA2B,CAAC,IAAlI,MAA0IhH,CAAC,CAAC4L,sBAAF,GAAyB,CAAC,CAA1B,EAA4B5L,CAAC,CAAC2L,UAAF,GAAa,IAAzC,EAA8C,WAAS3L,CAAC,CAAC6L,WAAX,KAAyB7L,CAAC,CAAC6L,WAAF,GAAc,SAAvC,CAAxL,GAA2O,KAAK7G,QAAL,GAAchF,CAAzP;MAA2P;;MAAA,MAAMI,CAAC,GAACoC,CAAC,CAAC,EAAC,GAAG,KAAKwC,QAAL,CAAcsC,MAAd,EAAJ;QAA2BnB,YAAY,EAAChG;MAAxC,CAAD,CAAT;MAAA,MAAsDE,CAAC,GAACqC,CAAC,CAACxC,CAAD,EAAGC,CAAH,CAAzD;MAA+D,KAAKoE,UAAL,IAAiB,KAAKA,UAAL,CAAgB4D,YAAhB,GAA6B/H,CAA7B,EAA+B,KAAKmE,UAAL,CAAgBH,UAAhB,GAA2B/D,CAA3E,IAA8E,KAAKkE,UAAL,GAAgB,IAAItB,CAAJ,CAAM;QAACkF,YAAY,EAAC/H,CAAd;QAAgBgE,UAAU,EAAC/D;MAA3B,CAAN,CAA9F;MAAmI,MAAME,CAAC,GAAC,KAAKgE,UAAL,CAAgB6D,IAAhB,EAAR;;MAA+B,IAAG7H,CAAC,CAACuL,OAAL,EAAa;QAAC,IAAG,WAAS9L,CAAZ,EAAc;UAAC,MAAK;YAAC+L,QAAQ,EAAC/L;UAAV,IAAa,KAAKkE,MAAL,CAAYE,UAA9B;UAAA,MAAyClE,CAAC,GAAC,KAAK8E,QAAhD;UAAyD,IAAGvE,CAAC,CAACT,CAAD,CAAJ;YAAQ,IAAG,sBAAoBE,CAAC,CAACgH,IAAzB,EAA8B,KAAKe,sBAAL,CAA4B,UAA5B,EAA9B,KAA0E;cAAC,MAAMjI,CAAC,GAACgD,CAAC,CAAC,KAAKkB,MAAL,CAAYE,UAAb,CAAT;cAAkCgD,IAAI,CAACC,SAAL,CAAerH,CAAf,MAAoBoH,IAAI,CAACC,SAAL,CAAenH,CAAf,CAApB,IAAuC,KAAK+H,sBAAL,CAA4B,UAA5B,CAAvC;YAA+E;UAApM,OAAyM,IAAG,qBAAmB/H,CAAC,CAACgH,IAAxB,EAA6B;YAAC,MAAMlH,CAAC,GAAC,KAAK8D,OAAL,EAAc4B,MAAtB;YAAA,MAA6BvF,CAAC,GAACD,CAAC,CAACyL,UAAF,EAAcjG,MAA7C;YAAoD,CAACxF,CAAC,CAAC0L,sBAAH,IAA2BzL,CAA3B,IAA8BH,CAA9B,IAAiCG,CAAC,KAAGH,CAArC,IAAwC,KAAKiI,sBAAL,CAA4B,UAA5B,CAAxC;UAAgF;QAAC;MAAC,CAAnc,MAAwc5E,CAAC,CAAC2I,IAAF,CAAO,oBAAP,EAA4BzL,CAAC,CAAC0L,KAAF,IAAS,mDAArC,GAA0F,WAASjM,CAAT,IAAY,KAAKiI,sBAAL,CAA4B,UAA5B,CAAtG;IAA8I;;EAAvjT,CAArB;;EAA8kT,SAASoB,CAAT,CAAWrJ,CAAX,EAAa;IAAC,IAAG,CAACA,CAAC,CAACkE,MAAH,IAAW,CAAClE,CAAC,CAACoE,UAAjB,EAA4B,MAAM,IAAIhE,CAAJ,CAAM,cAAN,EAAqB,WAArB,CAAN;EAAwC;;EAAA,OAAOJ,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,qBAAnB,EAAyC,KAAK,CAA9C,CAAD,EAAkDlM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,2BAAnB,EAA+C,KAAK,CAApD,CAAnD,EAA0GlM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,uBAAnB,EAA2C,KAAK,CAAhD,CAA3G,EAA8JlM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,kCAAnB,EAAsD,KAAK,CAA3D,CAA/J,EAA6NlM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,mBAAnB,EAAuC,KAAK,CAA5C,CAA9N,EAA6QlM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,SAAnB,EAA6B,KAAK,CAAlC,CAA9Q,EAAmTlM,CAAC,CAAC,CAACW,CAAC,CAAC;IAACwL,IAAI,EAAC;MAACC,OAAO,EAAC;QAACC,OAAO,EAAC;UAACC,IAAI,EAAC;YAACC,MAAM,EAAC;UAAR;QAAN;MAAT;IAAT;EAAN,CAAD,CAAF,CAAD,EAAiEhJ,CAAC,CAAC2I,SAAnE,EAA6E,WAA7E,EAAyF,KAAK,CAA9F,CAApT,EAAqZlM,CAAC,CAAC,CAACW,CAAC,CAAC;IAACwL,IAAI,EAAC;MAACG,IAAI,EAAC,CAAC;IAAP;EAAN,CAAD,CAAF,CAAD,EAAuB/I,CAAC,CAAC2I,SAAzB,EAAmC,YAAnC,EAAgD,IAAhD,CAAtZ,EAA4clM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,eAAnB,EAAmC,KAAK,CAAxC,CAA7c,EAAwflM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,UAAnB,EAA8B,KAAK,CAAnC,CAAzf,EAA+hBlM,CAAC,CAAC,CAACW,CAAC,CAAC;IAACuG,IAAI,EAAC,CAAC9F,CAAD,CAAN;IAAU+K,IAAI,EAAC;MAACK,KAAK,EAAC,CAAC;IAAR;EAAf,CAAD,CAAF,CAAD,EAAiCjJ,CAAC,CAAC2I,SAAnC,EAA6C,4BAA7C,EAA0E,IAA1E,CAAhiB,EAAgnBlM,CAAC,CAAC,CAACW,CAAC,CAAC;IAACuG,IAAI,EAAC7F,CAAN;IAAQ8K,IAAI,EAAC;MAACK,KAAK,EAAC,CAAC;IAAR;EAAb,CAAD,CAAF,CAAD,EAA+BjJ,CAAC,CAAC2I,SAAjC,EAA2C,wBAA3C,EAAoE,KAAK,CAAzE,CAAjnB,EAA6rBlM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,QAAnB,EAA4B,KAAK,CAAjC,CAA9rB,EAAkuBlM,CAAC,CAAC,CAACW,CAAC,CAAC;IAACuG,IAAI,EAAC5F;EAAN,CAAD,CAAF,CAAD,EAAeiC,CAAC,CAAC2I,SAAjB,EAA2B,gBAA3B,EAA4C,KAAK,CAAjD,CAAnuB,EAAuxBlM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,YAAnB,EAAgC,KAAK,CAArC,CAAxxB,EAAg0BlM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,YAAnB,EAAgC,KAAK,CAArC,CAAj0B,EAAy2BlM,CAAC,CAAC,CAACW,CAAC,CAAC;IAAC8L,QAAQ,EAAC,CAAC,CAAX;IAAavF,IAAI,EAAC9D,CAAlB;IAAoB+I,IAAI,EAAC;MAACG,IAAI,EAAC,CAAC;IAAP;EAAzB,CAAD,CAAF,CAAD,EAA0C/I,CAAC,CAAC2I,SAA5C,EAAsD,kBAAtD,EAAyE,KAAK,CAA9E,CAA12B,EAA27BlM,CAAC,CAAC,CAACW,CAAC,CAAC;IAACwL,IAAI,EAAC;MAACG,IAAI,EAAC,CAAC;IAAP;EAAN,CAAD,CAAF,CAAD,EAAuB/I,CAAC,CAAC2I,SAAzB,EAAmC,UAAnC,EAA8C,IAA9C,CAA57B,EAAg/BlM,CAAC,CAAC,CAACW,CAAC,CAACQ,CAAD,CAAF,CAAD,EAAQoC,CAAC,CAAC2I,SAAV,EAAoB,KAApB,EAA0B,IAA1B,CAAj/B,EAAihClM,CAAC,CAAC,CAACW,CAAC,CAAC;IAAC+L,KAAK,EAACxM;EAAP,CAAD,CAAF,CAAD,EAAgBqD,CAAC,CAAC2I,SAAlB,EAA4B,UAA5B,EAAuC,IAAvC,CAAlhC,EAA+jClM,CAAC,CAAC,CAACW,CAAC,EAAF,CAAD,EAAO4C,CAAC,CAAC2I,SAAT,EAAmB,YAAnB,EAAgC,KAAK,CAArC,CAAhkC,EAAwmC3I,CAAC,GAACvD,CAAC,CAAC,CAACa,CAAC,CAAC,8BAAD,CAAF,CAAD,EAAqC0C,CAArC,CAA3mC,EAAmpCA,CAA1pC;AAA4pC,CAA73V;;AAA83V,SAAOA,CAAC,IAAIoJ,gBAAZ"},"metadata":{},"sourceType":"module"}