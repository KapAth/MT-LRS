{"ast":null,"code":"/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport { _ as t } from \"../../../chunks/tslib.es6.js\";\nimport { isNone as s } from \"../../../core/maybe.js\";\nimport { property as o } from \"../../../core/accessorSupport/decorators/property.js\";\nimport \"../../../core/accessorSupport/ensureType.js\";\nimport \"../../../core/arrayUtils.js\";\nimport { subclass as e } from \"../../../core/accessorSupport/decorators/subclass.js\";\nimport { localOperators as r } from \"../rasterFunctionConstants.js\";\nimport { getPixelValueRange as n } from \"../rasterFormats/pixelRangeUtils.js\";\nimport i from \"./BaseRasterFunction.js\";\nimport u from \"./LocalFunctionArguments.js\";\nimport { operandsCount as a, getOutputDomain as c, local as p } from \"./localUtils.js\";\nlet m = class extends i {\n  constructor() {\n    super(...arguments), this.functionName = \"Local\", this.functionArguments = null, this.rasterArgumentNames = [\"rasters\"];\n  }\n\n  _bindSourceRasters() {\n    const {\n      sourceRasterInfos: t\n    } = this,\n          s = t[0],\n          {\n      bandCount: o\n    } = s,\n          {\n      processAsMultiband: e\n    } = this.functionArguments;\n    if (t.some(t => t.bandCount !== o)) return {\n      success: !1,\n      supportsGPU: !1,\n      error: \"local-function: input rasters do not have same band count\"\n    };\n    const {\n      operation: r,\n      rasters: n\n    } = this.functionArguments,\n          i = a[r];\n    if (!(999 === i || n.length === i || n.length <= 1 && 1 === i)) return {\n      success: !1,\n      supportsGPU: !1,\n      error: `local-function: the length of functionArguments.rasters does not match operation's requirement: ${i}`\n    };\n    this.outputPixelType = this._getOutputPixelType(\"f32\");\n    const u = s.clone();\n    u.pixelType = this.outputPixelType, u.statistics = null, u.histograms = null, u.colormap = null, u.attributeTable = null, u.bandCount = 999 !== i || e ? o : 1;\n    const p = c(r);\n\n    if (p) {\n      u.statistics = [];\n\n      for (let t = 0; t < u.bandCount; t++) u.statistics[t] = {\n        min: p[0],\n        max: p[1],\n        avg: (p[0] + p[1]) / 2,\n        stddev: (p[0] + p[1]) / 10\n      };\n    }\n\n    this.rasterInfo = u;\n    return {\n      success: !0,\n      supportsGPU: 1 === u.bandCount && i <= 3 && (r < 11 || r > 16)\n    };\n  }\n\n  _processPixels(t) {\n    const {\n      pixelBlocks: o\n    } = t;\n    return s(o) || o.some(t => s(t)) ? null : p(o, this.functionArguments.operation, {\n      processAsMultiband: this.functionArguments.processAsMultiband,\n      outputPixelType: this.outputPixelType ?? void 0\n    });\n  }\n\n  _getWebGLParameters() {\n    const {\n      operation: t\n    } = this.functionArguments,\n          s = a[t],\n          o = Object.keys(r).find(s => r[s] === t)?.toLowerCase() ?? \"undefined\",\n          e = this.outputPixelType ?? \"f32\";\n    let [i, u] = n(e);\n    const c = e.startsWith(\"u\") || e.startsWith(\"s\");\n    return c && (i -= 1e-4, u += 1e-4), {\n      imageCount: s,\n      operationName: o,\n      domainRange: [i, u],\n      isOutputRounded: c\n    };\n  }\n\n};\nt([o({\n  json: {\n    write: !0,\n    name: \"rasterFunction\"\n  }\n})], m.prototype, \"functionName\", void 0), t([o({\n  type: u,\n  json: {\n    write: !0,\n    name: \"rasterFunctionArguments\"\n  }\n})], m.prototype, \"functionArguments\", void 0), t([o()], m.prototype, \"rasterArgumentNames\", void 0), m = t([e(\"esri.layers.support.rasterFunctions.LocalFunction\")], m);\nconst l = m;\nexport { l as default };","map":{"version":3,"names":["_","t","isNone","s","property","o","subclass","e","localOperators","r","getPixelValueRange","n","i","u","operandsCount","a","getOutputDomain","c","local","p","m","constructor","arguments","functionName","functionArguments","rasterArgumentNames","_bindSourceRasters","sourceRasterInfos","bandCount","processAsMultiband","some","success","supportsGPU","error","operation","rasters","length","outputPixelType","_getOutputPixelType","clone","pixelType","statistics","histograms","colormap","attributeTable","min","max","avg","stddev","rasterInfo","_processPixels","pixelBlocks","_getWebGLParameters","Object","keys","find","toLowerCase","startsWith","imageCount","operationName","domainRange","isOutputRounded","json","write","name","prototype","type","l","default"],"sources":["C:/Users/akaps/Documents/Visual Studio 2022/Projects/MT_LRS/WebPresentation/node_modules/@arcgis/core/layers/support/rasterFunctions/LocalFunction.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.26/esri/copyright.txt for details.\n*/\nimport{_ as t}from\"../../../chunks/tslib.es6.js\";import{isNone as s}from\"../../../core/maybe.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import{subclass as e}from\"../../../core/accessorSupport/decorators/subclass.js\";import{localOperators as r}from\"../rasterFunctionConstants.js\";import{getPixelValueRange as n}from\"../rasterFormats/pixelRangeUtils.js\";import i from\"./BaseRasterFunction.js\";import u from\"./LocalFunctionArguments.js\";import{operandsCount as a,getOutputDomain as c,local as p}from\"./localUtils.js\";let m=class extends i{constructor(){super(...arguments),this.functionName=\"Local\",this.functionArguments=null,this.rasterArgumentNames=[\"rasters\"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,s=t[0],{bandCount:o}=s,{processAsMultiband:e}=this.functionArguments;if(t.some((t=>t.bandCount!==o)))return{success:!1,supportsGPU:!1,error:\"local-function: input rasters do not have same band count\"};const{operation:r,rasters:n}=this.functionArguments,i=a[r];if(!(999===i||n.length===i||n.length<=1&&1===i))return{success:!1,supportsGPU:!1,error:`local-function: the length of functionArguments.rasters does not match operation's requirement: ${i}`};this.outputPixelType=this._getOutputPixelType(\"f32\");const u=s.clone();u.pixelType=this.outputPixelType,u.statistics=null,u.histograms=null,u.colormap=null,u.attributeTable=null,u.bandCount=999!==i||e?o:1;const p=c(r);if(p){u.statistics=[];for(let t=0;t<u.bandCount;t++)u.statistics[t]={min:p[0],max:p[1],avg:(p[0]+p[1])/2,stddev:(p[0]+p[1])/10}}this.rasterInfo=u;return{success:!0,supportsGPU:1===u.bandCount&&i<=3&&(r<11||r>16)}}_processPixels(t){const{pixelBlocks:o}=t;return s(o)||o.some((t=>s(t)))?null:p(o,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}_getWebGLParameters(){const{operation:t}=this.functionArguments,s=a[t],o=Object.keys(r).find((s=>r[s]===t))?.toLowerCase()??\"undefined\",e=this.outputPixelType??\"f32\";let[i,u]=n(e);const c=e.startsWith(\"u\")||e.startsWith(\"s\");return c&&(i-=1e-4,u+=1e-4),{imageCount:s,operationName:o,domainRange:[i,u],isOutputRounded:c}}};t([o({json:{write:!0,name:\"rasterFunction\"}})],m.prototype,\"functionName\",void 0),t([o({type:u,json:{write:!0,name:\"rasterFunctionArguments\"}})],m.prototype,\"functionArguments\",void 0),t([o()],m.prototype,\"rasterArgumentNames\",void 0),m=t([e(\"esri.layers.support.rasterFunctions.LocalFunction\")],m);const l=m;export{l as default};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}